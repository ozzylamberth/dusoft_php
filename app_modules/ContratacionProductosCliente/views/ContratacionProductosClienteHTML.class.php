<?php/** * @package IPSOFT-SIIS * @version $Id: ContratacionProductosClienteHTML.class.php,v 1.14 2010/01/26 22:40:56 sandra Exp $Revision: 1.14 $ * @copyright (C) 2009 IPSOFT - SA (www.ipsoft-sa.com) * @author Mauricio Adrian Medina Santacruz */IncludeClass("ClaseHTML");IncludeClass("ClaseUtil");IncludeClass("CalendarioHtml");class ContratacionProductosClienteHTML {    /**     * Constructor de la clase     */    function ContratacionProductosClienteHTML() {    }    /**     * Funcion forma que permite realizar  la busqueda de los proveedores     * @param array $action vector que contiene los link de la aplicacion     * @return string $html retorna la cadena con el codigo html de la pagina     */    function Formabusquedaproveedores($action, $tipodocumento) {        $html .= ThemeAbrirTabla('SELECCION - TERCERO');        //$fecha = '2010-12-01';//AAAA-MM-DD        //$fecha_otra=mktime(-60, 0, 0, '12'  , '01', '2010');        //print_r(date('Y-m-d',$fecha_otra));        $html .= "<script>";        $html .= "function Paginador(tipo_id_tercero,tercero_id,nombre_tercero,offset)";        $html .= "{";        $html .= "xajax_ListadoTerceros(tipo_id_tercero,tercero_id,nombre_tercero,offset);";        $html .= "}";        $html .= "</script>";        $html .= "		<form name=\"formabuscar\" action=\"" . $action['volver'] . "\" method=\"post\">";        $html .= "<table   width=\"40%\" align=\"center\" border=\"0\"  >";        $html .= "	</tr>\n";        $html .= "   <tr> \n";        $html .= "		<td class=\"modulo_table_list_title\" width=\"40%\">TIPO DOCUMENTO: </td>\n";        $html .= "		<td  class=\"modulo_list_claro\" colspan=\"4\">\n";        $html .= "			<select id=\"tipo_id_tercero\" class=\"select\">\n";        $html .= "             	<option value = ''>--  SELECCIONE --</option>\n";        $csk = "";        foreach ($tipodocumento as $indice => $valor) {            if ($valor['tipo_id_tercero'] == $request['tipo_id_tercero'])                $sel = "selected";            else                $sel = "";            $html .= " 			<option value=\"" . $valor['tipo_id_tercero'] . "\" " . $sel . ">" . $valor['descripcion'] . "</option>\n";        }        $html .= "            </select>\n";        $html .= "	   </td>\n";        $html .= "	</tr>\n";        $html .= "	<tr>\n";        $html .= "		<td  width=\"40%\" class=\"modulo_table_list_title\">DOCUMENTO:</td>\n";        $html .= "	    <td class=\"modulo_list_claro\" colspan=\"4\">\n";        $html .= "  	   <input type=\"text\" class=\"input-text\" id=\"tercero_id\" maxlength=\"32\"></td>\n";        $html .= "	</tr>\n";        $html .= "		<tr>\n";        $html .= "			<td class=\"modulo_table_list_title\">NOMBRE:</td>\n";        $html .= "			<td  colspan=\"4\" class=\"modulo_list_claro\" ><input type=\"text\" class=\"input-text\" id=\"nombre_tercero\" maxlength=\"32\"></td>\n";        $html .= "	</tr>\n";        $html .= "	<tr>\n";        $html .= "	   	<td align='center'>\n";        $html .= "			<input onclick=\"xajax_ListadoTerceros(document.getElementById('tipo_id_tercero').value,document.getElementById('tercero_id').value,document.getElementById('nombre_tercero').value);\" class=\"input-submit\" type=\"button\" value=\"Buscar\">\n";        $html .= "		</td>\n";        $html .= "		<td align='center' colspan=\"1\">\n";        $html .= "			<input class=\"input-submit\" type=\"reset\" value=\"Limpiar Campos\">\n";        $html .= "	  	</td>\n";        $html .= "</form>\n";        $html .= "<form name=\"volver\" action=\"" . $action['volver'] . "\" method=\"post\">\n";        $html .= "		  <td align='center' >\n";        $html .= "		      <input class=\"input-submit\" type=\"submit\" value=\"Volver\">\n";        $html .= "		  </td>\n";        $html .= " </form>\n";        $html .= "	 </tr>\n";        $html .= "</table><br>\n";        $html .= "<div id=\"ListadoTerceros\"></div>";        $html .= $this->CrearVentana();        $html .= ThemeCerrarTabla();        return $html;    }    function FormaMenu($action, $datos) {        $html .= ThemeAbrirTabla('MENU - CONTRATACION PRODUCTOS CLIENTE');        //print_r($_REQUEST);        $accion = $action['volver'];        //$html  = ThemeAbrirTabla('PARAMETROS INICIALES - INVENTARIOS');        $html .= "  <table border=\"0\" width=\"70%\" align=\"center\">";        $html .= "  <tr><td>";        $html .= "      <table border=\"0\" width=\"70%\" align=\"center\" class=\"modulo_table_list\">";        $html .= "      <tr class=\"modulo_table_list_title\">";        $html .= "      <td align=\"center\" colspan=\"2\">";        $html .= "      MENÃš";        $html .= "      </td>";        $html .= "      </tr>";        if ($datos['ssiid'] == '1') {            $html .= "      <tr class=\"modulo_list_claro\">";            $html .= "      <td class=\"label\" align=\"center\" colspan=\"2\">";            $html .= "      <a href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'Contratos') . "\">CONTRATOS CLIENTE</a>";            $html .= "      </td>";            $html .= "      </tr>";			$html .= "      <tr class=\"modulo_list_claro\">";            $html .= "      <td class=\"label\" align=\"center\" colspan=\"2\">";            $html .= "      <a href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'Crear_Producto') . "\">AGREGAR PRECIO VENTA A CONTRATOS</a>";            $html .= "      </td>";            $html .= "      </tr>";			            $html .= "      <tr class=\"modulo_list_claro\">";            $html .= "      <td class=\"label\" align=\"center\" colspan=\"2\">";            $html .= "      <a href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'CrearVendedores') . "\">CREAR VENDEDORES</a>";            $html .= "      </td>";            $html .= "      </tr>";            $html .= "      <tr class=\"modulo_list_claro\">";            $html .= "      <td class=\"label\" align=\"center\" colspan=\"2\">";            $html .= "      <a href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'VigenciaCotizacion') . "\">PARAMETRIZAR - VIGENCIA COTIZACION</a>";            $html .= "      </td>";            $html .= "      </tr>";        }        $html .= "      <tr class=\"modulo_list_claro\">";        $html .= "      <td class=\"label\" align=\"center\" colspan=\"2\">";        $html .= "      <a href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'Cotizaciones') . "\">COTIZACIONES AL CLIENTE</a>";        $html .= "      </td>";        $html .= "      </tr>";        if ($datos['consulta'] == '0') {            $html .= "      <tr class=\"modulo_list_claro\">";            $html .= "      <td class=\"label\" align=\"center\" colspan=\"2\">";            $html .= "      <a href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'Pedidos') . "\">PEDIDOS DEL CLIENTE</a>";            $html .= "      </td>";            $html .= "      </tr>";        } else {            $html .= "      <tr class=\"modulo_list_claro\">";            $html .= "      <td class=\"label\" align=\"center\" colspan=\"2\">";            $html .= "      <a href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'ConsulPedidos') . "\">CONSULTA PEDIDOS</a>";            $html .= "      </td>";            $html .= "      </tr>";        }        $rpt = new GetReports();        $html .= "      <tr class=\"modulo_list_claro\">";        $html .= "      <td class=\"label_error\" align=\"center\">";        $html .= "      REPORTE- PRODUCTOS PENDIENTES POR DESPACHAR";        $html .= "		</td>";        $html .= "      <td class=\"label_error\" align=\"center\">";        $html .= $rpt->GetJavaReport('app', 'ContratacionProductosCliente', 'Reporte_ProductosPendientes', $datos, array('rpt_name' => '', 'rpt_dir' => 'cache', 'rpt_rewrite' => TRUE));        $fnc = $rpt->GetJavaFunction();        $html .= "<center>\n";        $html .= "	<a title=\"IMPRIMIR\" class=\"label_error\" href=\"javascript:" . $fnc . "\">\n";        $html .= "	  <image title=\"IMPRIMIR COTIZACION\" src=\"" . GetThemePath() . "/images/imprimir.png\" border=\"0\">\n";        $html .= "  </a>\n";        $html .= "</center>\n";        $html .= "      </td>";        $html .= "      </tr>";        $html .= "      </table>";        $html .= "  </td></tr>";        $html .= ' 	<form name="forma" action="' . $action['volver'] . '" method="post">';        $html .= "  <tr>";        $html .= "  <td align=\"center\"><br>";        $html .= '  <input class="input-submit" type="submit" name="volver" value="Volver">';        $html .= "  </td>";        $html .= "  </form>";        $html .= "  </tr>";        $html .= "  </table>";        $html .= ThemeCerrarTabla();        return $html;    }    /**     * Funcion donde se crea la Forma del Contrato a llenar       * @param array $datos vector que contiene la informacion de Los Proveedores     * @param array $action vector que contiene los link de la aplicacion     * @param array $datos_empresa vector que contiene la informacion de Empresa que contrata al proveedor     * @param string $fecha contiene la informacion de la fecha actual.     * @return string $html retorna la cadena con el codigo html de la pagina     */    function Listado_Contratos($action, $datos, $contratos, $conteo, $pagina) {        $html = ThemeAbrirTabla(' CONTRATOS - CLIENTE');        //Que solo aparezca Cuando NO hay un contrato activo y/o existente para ese tercero selecionado        $ctl = AutoCarga::factory("ClaseUtil");        $html .= $ctl->IsDate("-");        $html .= $ctl->AcceptDate("-");        $html .= $ctl->AcceptNum("-");        $html .= $ctl->LimpiarCampos();        $html .= $ctl->RollOverFilas();        $html .="<div align=\"center\" class=\"label_error\" id='error'></div> ";        $html .="<script >\n";        $html .= "  function max(e){  ";        $html .= "  tecla = (document.all) ? e.keyCode : e.which; ";        $html .= "  if (tecla==8) return true;";        $html .= "  if (tecla==13) return false;";        $html .= " }";        $html .= "</script>\n";        $html .= "<form name=\"Buscador\" id=\"Buscador\" action=\"" . $action['buscador'] . "\" method=\"post\">";        $html .= "<table  width=\"80%\" align=\"center\" border=\"0\" class=\"modulo_table_list\">\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"formulacion_table_list\">GENERICO</td>\n";        $html .= "      <td  class=\"formulacion_table_list\" ><input type=\"checkbox\" class=\"input-checkbox\" name=\"buscador[contrato_generico]\" value=\"1\" id=\"buscador[contrato_generico]\" class=\"input-text\" style=\"width:100%\"></td>\n";        $html .= "      <td  class=\"formulacion_table_list\">NOMBRE UNIDAD NEGOCIO</td>\n";        $html .= "      <td  class=\"formulacion_table_list\"><input name=\"buscador[descripcion]\" id=\"buscador[descripcion]\" class=\"input-text\" style=\"width:100%\"></td>\n";        $html .= "      <td  class=\"formulacion_table_list\">NOMBRE TERCERO</td>\n";        $html .= "      <td  class=\"formulacion_table_list\"><input name=\"buscador[nombre_tercero]\" id=\"buscador[nombre_tercero]\" class=\"input-text\" style=\"width:100%\"></td>\n";        $html .= "      <td  class=\"formulacion_table_list\"># CONTRATO</td>\n";        $html .= "      <td  class=\"formulacion_table_list\"><input name=\"buscador[contrato_cliente_id]\" id=\"buscador[contrato_cliente_id]\" class=\"input-text\" style=\"width:100%\"></td>\n";        $html .= "      <td  class=\"formulacion_table_list\"><input type=\"submit\" value=\"BUSCAR CONTRATO\" class=\"input-submit\"></td>\n";        $html .= "	</tr>";        $html .= "</table>";        $html .= "</form>";        $html .= "<table class=\"modulo_table_list\" rules=\"all\" align=\"center\">";        $html .= "	<tr class=\"modulo_list_claro\">";        $html .= "    <td align=\"center\" class=\"normal_10AN\">\n";        $html .= "		CREAR NUEVO CONTRATO";        $html .= "    </td>\n";        $html .= "    <td align=\"center\">\n";        $html .= "		<center class=\"label_error\"><a href=\"" . $action['Crear_Contrato'] . "\"><img src=\"" . GetThemePath() . "/images/pplan.png\" border='0'></a></center>";        $html .= "    </td>\n";        $html .= "	</tr>";        $html .= "</table>";        $html .= "<br>";        $pgn = AutoCarga::factory("ClaseHTML");        $html .= "		" . $pgn->ObtenerPaginado($conteo, $pagina, $action['paginador']);        $html .= "                  <table width=\"100%\" align=\"center\" class=\"modulo_table_list\">\n";        $html .= "                    <tr class=\"modulo_table_list_title\">\n";        $html .= "                      <td align=\"center\" width=\"2%\">\n";        $html .= "                        <a title='NUMERO DEL CONTRATO'>#CONTRATO </a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='CLIENTE'>CLIENTE/UNIDAD NEGOCIO/GENERICO</a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='FECHA INICIO'>FECHA I";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='FECHA FINAL'>FECHA F";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='VALOR DEL CONTRATO'>VALOR<a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='VENDEDOR'>VENDEDOR<a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='DESCRIPCION'>DESCRIPCION - CONTRATO<a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" width=\"3%\">\n";        $html .= "                        <a title='MODIFICAR'>OP<a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" width=\"3%\">\n";        $html .= "                        <a title='PRODUCTOS'>PROD<a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" width=\"3%\">\n";        $html .= "                        <a title='ESTADO DEL CONTRATO'>EST.<a>";        $html .= "                      </td>\n";        $html .= "                    </tr>\n";        foreach ($contratos as $key => $valor) {            $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";            $html .= "						<td align=\"center\">" . $valor['contrato_cliente_id'] . "</td>";            $html .= "						<td>" . $valor['contrato'] . "</td>";            $html .= "						<td>" . $valor['fecha_inicio'] . "</b></td>";            $html .= "						<td>" . $valor['fecha_final'] . "</b></td>";            $html .= "						<td>$" . FormatoValor($valor['valor_contrato'], 2) . "</td>";            $html .= "						<td>" . $valor['nombre'] . "</td>";            $html .= "						<td>" . $valor['descripcion_contrato'] . "</td>";            if ($valor['estado'] == '1') {                $html .= "						<td>";                $html .= "						<center><a href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'Crear_Contrato', array("contrato_cliente_id" => $valor['contrato_cliente_id'], "tipo_id_tercero" => $valor['tipo_id_tercero'], "tercero_id" => $valor['tercero_id'], "codigo_unidad_negocio" => $valor['codigo_unidad_negocio'], "tipo_contrato" => $valor['tipo_contrato'])) . "\" class=\"label_error\"  title=\"MODIFICAR CONTRATO\"><img src=\"" . GetThemePath() . "/images/modificar.png\" border='0' ></a></center>\n";                $html .= "						</td>";                $html .= "						<td>";                $html .= "						<center><a href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'Productos_Contrato', array("contrato_cliente_id" => $valor['contrato_cliente_id'])) . "\" class=\"label_error\"  title=\"PRODUCTOS PACTADOS CONTRATO\"><img src=\"" . GetThemePath() . "/images/producto_precio.png\" border='0' ></a></center>\n";                $html .= "						</td>";                $html .= "						<td>";                $html .= "						<center><a onClick=\"return confirm('INACTIVAR EL CONTRATO #" . $valor['contrato_cliente_id'] . "?');\" href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'Contratos', array("contrato_cliente_id" => $valor['contrato_cliente_id'], "cambiar_estado" => "1")) . "\" class=\"label_error\"  title=\"CONTRATO ACTIVO, CAMBIAR A INACTIVO\"><img src=\"" . GetThemePath() . "/images/pactivo.png\" border='0'></a></center>\n";                $html .= "						</td>";            } else {                $html .= "						<td>";                $html .= "							<center><img title=\"CONTRATO INACTIVO\" src=\"" . GetThemePath() . "/images/pinactivo.png\" border='0' ></center>\n";                $html .= "						</td>";                $html .= "						<td>";                $html .= "							<center></center>\n";                $html .= "						</td>";                $html .= "						<td>";                $html .= "							<center><img title=\"CONTRATO INACTIVO\" src=\"" . GetThemePath() . "/images/pinactivo.png\" border='0' ></center>\n";                $html .= "						</td>";            }            $html .= "                   </tr>\n";        }        $html .= "				</table>";        $html .= "<br>";        $html .= "<table align=\"center\" width=\"50%\">\n";        $html .= "  <tr>\n";        $html .= "    <td align=\"center\">\n";        $html .= "      <a href=\"" . $action['volver'] . "\"  class=\"label_error\">\n";        $html .= "        VOLVER\n";        $html .= "      </a>\n";        $html .= "    </td>\n";        $html .= "  </tr>\n";        $html .= "</table>\n";        $html .= ThemeCerrarTabla();        return $html;    }    /*     * Funcion donde se crea la Forma del Contrato a llenar       * @param array $datos vector que contiene la informacion de Los Proveedores     * @param array $action vector que contiene los link de la aplicacion     * @param array $datos_empresa vector que contiene la informacion de Empresa que contrata al proveedor     * @param string $fecha contiene la informacion de la fecha actual.     * @return string $html retorna la cadena con el codigo html de la pagina     */    function Forma_Contrato($datos, $action, $unidades_negocio, $Vendedores, $Contrato, $ProductosContrato, $conteo, $pagina) {        $html = ThemeAbrirTabla('CONTRATO - CLIENTE');        /*          Funciones JavaScript         */        $html .= "<script>";        $html .= "function Paginador(Formulario,offset)";        $html .= "{";        $html .= "xajax_Listado_TerceroCliente(Formulario,offset);";        $html .= "}";        $html .= "</script>";				$html .= "<script>";		$html .= "function Validar_Eliminar(Formulario)";        $html .= "{";        $html .= " var entrar = confirm('Desea Eliminar todos los productos del contrato?');";        $html .= " if(entrar)";        $html .= "		Formulario.submit();";        $html .= "	else";        $html .= "		return false;";        $html .= "}";        $html .= "</script>";	        $html .= "<script>";        $html .= "function Seleccionar_Tercero(tipo_id_tercero,tercero_id,nombre_tercero,direccion,telefono,email)";        $html .= "{";        $html .= "document.getElementById('nombre_tercero').innerHTML = nombre_tercero;";        $html .= "document.getElementById('direccion').innerHTML = direccion;";        $html .= "document.getElementById('telefono').innerHTML = telefono;";        $html .= "document.getElementById('email').innerHTML = email;";        $html .= "document.getElementById('tipo_id_tercero').value = tipo_id_tercero;";        $html .= "document.getElementById('tercero_id').value = tercero_id;";        $html .= "}";        $html .= "</script>";        $html .= "<script>";        $html .= "function Validar_Campos(Formulario)";        $html .= "{";        $html .= "var mensaje=\"\";";        $html .= "	if(Formulario.tipo_contrato[0].checked==true)";        $html .= "	{";        $html .= "		if(Formulario.tipo_id_tercero.value.replace(/^\s+/g,'').replace(/\s+$/g,'')==\"\")";        $html .="			mensaje += 'El Tipo de Identificacion del Cliente, No Puede Estar Vacï¿½o<br>';	";        $html .= "		if(Formulario.tercero_id.value.replace(/^\s+/g,'').replace(/\s+$/g,'')==\"\")";        $html .="			mensaje += 'El Numero de Idenficacion del Cliente, No Puede Estar Vacï¿½o<br>';	";        $html .= "		if(Formulario.valor_contrato.value.replace(/^\s+/g,'').replace(/\s+$/g,'') ==\"\")";        $html .="			mensaje += 'El Valor del Contrato, No Puede Estar Vacï¿½o<br>';	";        $html .= "  	if(isNaN(Formulario.valor_contrato.value))";        $html .= "      	mensaje += 'El Valor del Contrato, No Es Valido<br>';";        $html .= "		if(Formulario.valor_contrato.value <=0)";        $html .="			mensaje += 'El Valor del Contrato, Debe Ser Mayor a Cero<br>';	";        $html .= "	}";        $html .= "	if(Formulario.tipo_contrato[1].checked==true)";        $html .= "	{";        $html .= "		if(Formulario.codigo_unidad_negocio.value.replace(/^\s+/g,'').replace(/\s+$/g,'')==\"\")";        $html .="			mensaje += 'El Tipo de Contrato, Exige Una Unidad de Negocio Seleccionada<br>';	";        $html .= "	}";        $html .= "	if(Formulario.fecha_inicio.value.replace(/^\s+/g,'').replace(/\s+$/g,'') ==\"\")";        $html .="		mensaje += 'La Fecha Inicio del Contrato, No Puede Estar Vacï¿½a<br>';	";        $html .= "	if(Formulario.fecha_final.value.replace(/^\s+/g,'').replace(/\s+$/g,'') ==\"\")";        $html .="		mensaje += 'La Fecha Final del Contrato, No Puede Estar Vacï¿½a<br>';	";        $html .= "	if(Formulario.fecha_final.value < Formulario.fecha_inicio.value)";        $html .="		mensaje += 'La Fecha Final del Contrato, No Puede Ser Menor a La Inicial<br>';	";        $html .= "	if(Formulario.descripcion.value.replace(/^\s+/g,'').replace(/\s+$/g,'') ==\"\")";        $html .="		mensaje += 'La Descripcion del Contrato, No Puede Estar Vacï¿½a<br>';	";        $html .= "	if(Formulario.vendedor_id.value.replace(/^\s+/g,'').replace(/\s+$/g,'') ==\"\")";        $html .="		mensaje += 'Se debe Seleccionar un Vendedor para El Contrato<br>';	";        $html .= "		if(Formulario.valor_contrato.value.replace(/^\s+/g,'').replace(/\s+$/g,'') ==\"\")";        $html .="			mensaje += 'El Valor del Contrato, No Puede Estar Vacï¿½o<br>';	";        $html .= "  	if(isNaN(Formulario.valor_contrato.value))";        $html .= "      	mensaje += 'El Valor del Contrato, No Es Valido<br>';";        $html .= "		if(Formulario.porcentaje_genericos.value.replace(/^\s+/g,'').replace(/\s+$/g,'') ==\"\")";        $html .="			mensaje += 'El Porcentaje De Venta de Productos Genericos, No Puede Estar Vacï¿½o<br>';	";        $html .= "  	if(isNaN(Formulario.porcentaje_genericos.value))";        $html .= "      	mensaje += 'El Porcentaje De Venta de Productos Genericos, No Es Valido<br>';";        $html .= "		if(Formulario.porcentaje_marcas.value.replace(/^\s+/g,'').replace(/\s+$/g,'') ==\"\")";        $html .="			mensaje += 'El Porcentaje De Venta de Productos de Marca, No Puede Estar Vacï¿½o<br>';	";        $html .= "  	if(isNaN(Formulario.porcentaje_marcas.value))";        $html .= "      	mensaje += 'El Porcentaje De Venta de Productos de Marca, No Es Valido<br>';";        $html .= "		if(Formulario.porcentajes_insumos.value.replace(/^\s+/g,'').replace(/\s+$/g,'') ==\"\")";        $html .="			mensaje += 'El Porcentaje De Venta de Insumos, No Puede Estar Vacï¿½o<br>';	";        $html .= "  	if(isNaN(Formulario.porcentajes_insumos.value))";        $html .= "      	mensaje += 'El Porcentaje De Venta de Insumos, No Es Valido<br>';";        $html .="	document.getElementById('error').innerHTML = mensaje; ";        $html .="	if(mensaje.replace(/^\s+/g,'').replace(/\s+$/g,'')==\"\")";        $html .="	Formulario.submit();";        $html .="	else";        $html .="	return false;	";        $html .= "}";        $html .= "</script>";        /*          Fin Funciones JavaScript         */        $select_uni .= "<input type=\"hidden\" id=\"codigo_unidad_negocio_old\" name=\"codigo_unidad_negocio_old\" value=\"" . $Contrato['codigo_unidad_negocio'] . "\">";        $select_uni .= "<select id=\"codigo_unidad_negocio\" name=\"codigo_unidad_negocio\" class=\"select\" style=\"width:30%\">";        $select_uni .= "<option value=\"\">-- NINGUNO --</option>";        foreach ($unidades_negocio as $key => $valor) {            if ($valor['codigo_unidad_negocio'] == $Contrato['codigo_unidad_negocio'])                $selected = " selected ";            else                $selected = " ";            $select_uni .= "<option " . $selected . " value=\"" . $valor['codigo_unidad_negocio'] . "\">" . $valor['codigo_unidad_negocio'] . " - " . $valor['descripcion'] . "</option>";        }        $select_uni .= "</select>";        $selected = " ";        $select_vend .= "<select id=\"vendedor_id\" name=\"vendedor_id\" class=\"select\" style=\"width:30%\">";        $select_vend .= "<option value=\"\">-- NINGUNO --</option>";        foreach ($Vendedores as $k => $v) {            if ((trim($v['tipo_id_vendedor']) . "@" . trim($v['vendedor_id'])) == (trim($Contrato['tipo_id_vendedor']) . "@" . trim($Contrato['vendedor_id'])))                $selected = " selected ";            else                $selected = " ";            $select_vend .= "<option " . $selected . " value=\"" . trim($v['tipo_id_vendedor']) . "@" . trim($v['vendedor_id']) . "\">" . $v['nombre'] . "</option>";        }        $select_vend .= "</select>";        //Que solo aparezca Cuando NO hay un contrato activo y/o existente para ese tercero selecionado        /* if($num<1)          { */        $ctl = AutoCarga::factory("ClaseUtil");        $html .= $ctl->IsDate("-");        $html .= $ctl->AcceptDate("-");        $html .= $ctl->AcceptNum("-");        $html .= $ctl->LimpiarCampos();        $html .= $ctl->RollOverFilas();        $html .= "<center><div class=\"label_error\" id=\"error\"></div></center>";        $html .= "<form name=\"Formulario\" id=\"Formulario\" action=\"" . $action['guardar'] . "\"  method=\"post\" onSubmit=\"Validar_Campos(document.Formulario); return false;\">\n";        $html .= "<table  width=\"85%\" align=\"center\" border=\"0\" class=\"modulo_table_list\" >\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"formulacion_table_list\" colspan=\"5\" > <b>EMPRESA : " . $datos['razon_social'] . "</b> </td>\n";        $html .= "  </tr>\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"formulacion_table_list\" colspan=\"5\" > <b> TIPO DE CONTRATO </b>   </td>\n";        $html .= "  </tr>\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"modulo_list_claro\" > <input class=\"input-radio\" type=\"radio\" name=\"tipo_contrato\" id=\"tipo_contrato\" value=\"1\" checked><b>CLIENTE ESPECIFICO</b>   </td>\n";        $html .= "      <td  class=\"modulo_list_claro\" > <input class=\"input-radio\" type=\"radio\" name=\"tipo_contrato\" id=\"tipo_contrato\" value=\"2\"><b>UNIDAD DE NEGOCIO</b>   </td>\n";        $html .= "      <td colspan='2'  class=\"modulo_list_claro\" > <input class=\"input-radio\" type=\"radio\" name=\"tipo_contrato\" id=\"tipo_contrato\" value=\"3\"><b>CONTRATO GENERICO</b>   </td>\n";        $html .= "  </tr>\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"formulacion_table_list\" colspan=\"5\" > <b> INFORMACIï¿½N DEL CLIENTE: </b> <input class=\"input-submit\" type=\"button\" value=\"BUSCAR CLIENTE\" onclick=\"xajax_BuscarTerceroCliente();\">  </td>\n";        $html .= "  </tr>\n";        $html .= "  <tr class=\"modulo_table_list_title\" >\n";        $html .= "       <td class=\"modulo_list_claro\"  align=\"center\" colspan=\"5\">\n";        /*          SubTabla para Info de Terceros         */        $html .= "			<table class=\"modulo_table_list\"	width=\"100%\">";        $html .= "				<tr class=\"modulo_table_list_title\">";        $html .= "       				<td align=\"left\">\n";        $html .= "							TIPO ID: ";        $html .= "       				</td>\n";        $html .= "       				<td class=\"modulo_list_claro\" align=\"left\">\n";        $html .= "							<input type=\"text\" class=\"input-text\" name=\"tipo_id_tercero\" id=\"tipo_id_tercero\" style=\"width:50%\" value=\"" . $Contrato['tipo_id_tercero'] . "\"> ";        $html .= "							<input type=\"hidden\" name=\"tipo_id_tercero_old\" id=\"tipo_id_tercero_old\" value=\"" . $Contrato['tipo_id_tercero'] . "\"> ";        $html .= "       				</td>\n";        $html .= "       				<td   align=\"left\">\n";        $html .= "							IDENTIFICACION:  ";        $html .= "       				</td>\n";        $html .= "       				<td class=\"modulo_list_claro\"  align=\"left\">\n";        $html .= "							<input type=\"text\" class=\"input-text\" name=\"tercero_id\" id=\"tercero_id\" style=\"width:100%\" value=\"" . $Contrato['tercero_id'] . "\">  ";        $html .= "							<input type=\"hidden\" name=\"tercero_id_old\" id=\"tercero_id_old\" value=\"" . $Contrato['tercero_id'] . "\">  ";        $html .= "       				</td>\n";        $html .= "       				<td align=\"left\">NOMBRE:</td>\n";        $html .= "       				<td class=\"modulo_list_claro\" align=\"left\" id=\"nombre_tercero\">\n";        $html .= "						" . $Contrato['nombre_tercero'];        $html .= "       				</td>\n";        $html .= "     			</tr>\n";        $html .= "     			<tr class=\"modulo_table_list_title\" >\n";        $html .= "       				<td align=\"left\" > DIRECCIï¿½N: </td>\n";        $html .= "       				<td class=\"modulo_list_claro\"  id=\"direccion\" align=\"left\"> \n";        $html .= "						" . $Contrato['direccion'];        $html .= "       				</td>\n";        $html .= "       				<td align=\"left\"> TELEFONOS: </td>\n";        $html .= "       				<td class=\"modulo_list_claro\" id=\"telefono\" align=\"left\"> \n";        $html .= "						" . $Contrato['telefono'] . "";        $html .= "       				</td>\n";        $html .= "       				<td align=\"left\" > EMAIL: </td>\n";        $html .= "       				<td class=\"modulo_list_claro\" id=\"email\" align=\"left\">\n";        $html .= "						" . $Contrato['email'];        $html .= "       				</td>\n";        $html .= "     			</tr>\n";        $html .= "			</table>";        $html .= "		</td>";        $html .= "  </tr>\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"formulacion_table_list\" > <b> UNIDAD DE NEGOCIO: </b>   </td>\n";        $html .= "      <td  class=\"modulo_list_claro\" colspan=\"5\" align=\"left\" > " . $select_uni . "   </td>\n";        $html .= "  </tr>\n";        $html .= "  <tr class=\"modulo_table_list_title\" >\n";        $html .= "       <td class=\"modulo_list_claro\"  align=\"center\" colspan=\"5\">\n";        /*          SubTabla para fechas         */        $html .= "			<table class=\"modulo_table_list\"	width=\"100%\">";        $html .= "				<tr class=\"modulo_table_list_title\">";        $html .= "					<td align=\"left\" > * FECHA INICIO:</td>\n";        $html .= "					<td class=\"modulo_list_claro\" align=\"left\">\n";        $html .= "		  				<input style=\"width:100%\" type=\"text\" class=\"input-text\" name=\"fecha_inicio\"  id=\"fecha_inicio\" size=\"20\" maxlength=\"10\" onkeypress=\"return acceptDate(event)\" READONLY value=\"" . $Contrato['fecha_inicio'] . "\"  >\n";        $html .= "					</td>\n";        $html .= "    				<td class=\"modulo_list_claro\" >\n";        $html .= "						" . ReturnOpenCalendario('Formulario', 'fecha_inicio', '-') . "\n";        $html .= "					</td>\n";        $html .= "					<td align=\"left\" > * FECHA VENCIMIENTO:</td>\n";        $html .= "					<td class=\"modulo_list_claro\" align=\"left\">\n";        $html .= "		    			<input style=\"width:100%\" type=\"text\" class=\"input-text\" name=\"fecha_final\" id=\"fecha_final\" maxlength=\"10\" onkeypress=\"return acceptDate(event)\" READONLY value=\"" . $Contrato['fecha_final'] . "\" \n";        $html .= "					</td>\n";        $html .= "    				<td class=\"modulo_list_claro\" >\n";        $html .= "						" . ReturnOpenCalendario('Formulario', 'fecha_final', '-') . "\n";        $html .= "					</td>\n";        $html .= "  			</tr >\n";        $html .= "			</table>";        $html .= "		</td>";        $html .= "  </tr>\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "       <td class=\"modulo_list_claro\"  align=\"center\" colspan=\"5\">\n";        /*          SubTabla para fechas         */        $html .= "			<table class=\"modulo_table_list\"	width=\"100%\">";        $html .= "				<tr class=\"modulo_table_list_title\">";        $html .= "      			<td  class=\"formulacion_table_list\" > <b> DESCRIPCION DEL CONTRATO: </b>   </td>\n";        $html .= "      			<td  class=\"modulo_list_claro\" colspan=\"4\" align=\"left\" >";        $html .= "		    			<input value=\"" . $Contrato['descripcion_contrato'] . "\" style=\"width:100%\" type=\"text\" class=\"input-text\" name=\"descripcion\" id=\"descripcion\" maxlength=\"30\" > \n";        $html .= "					</td>\n";        $html .= "      			<td  class=\"formulacion_table_list\" > <b> VALOR DEL CONTRATO: </b>   $</td>\n";        $html .= "      			<td  class=\"modulo_list_claro\" colspan=\"4\" align=\"left\" >";        $html .= "		    			<input value=\"" . $Contrato['valor_contrato'] . "\" onkeypress=\"return acceptNum(event)\" style=\"width:100%\" type=\"text\" class=\"input-text\" name=\"valor_contrato\" id=\"valor_contrato\" maxlength=\"20\"> \n";        $html .= "					</td>\n";        $html .= "  			</tr>\n";        $html .= "			</table>";        $html .= "		</td>";        $html .= "  </tr>\n";        $html .= "  </tr>\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"formulacion_table_list\" > <b> VENDEDOR: </b>   </td>\n";        $html .= "      <td  class=\"modulo_list_claro\" colspan=\"4\" align=\"left\" > " . $select_vend . "   </td>\n";        $html .= "  </tr>\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"formulacion_table_list\" colspan=\"5\" > <b> PORCENTAJES DE VENTA </b>   </td>\n";        $html .= "  </tr>\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"modulo_list_claro\" > <input type=\"text\" class=\"input-text\" id=\"porcentaje_genericos\" name=\"porcentaje_genericos\" size=\"5\" maxlength=\"4\" onkeypress=\"return acceptNum(event)\" value=\"" . $Contrato['porcentaje_genericos'] . "\"  >%  <b>PORCENTAJE GENERICOS</b>   </td>\n";        $html .= "      <td  class=\"modulo_list_claro\" > <input type=\"text\" class=\"input-text\" id=\"porcentaje_marcas\" name=\"porcentaje_marcas\" size=\"5\" maxlength=\"4\" onkeypress=\"return acceptNum(event)\" value=\"" . $Contrato['porcentaje_marcas'] . "\"  >%  <b>PORCENTAJE MARCA</b>   </td>\n";        $html .= "      <td colspan='2'  class=\"modulo_list_claro\" > <input type=\"text\" class=\"input-text\" id=\"porcentajes_insumos\" name=\"porcentajes_insumos\" size=\"5\" maxlength=\"4\" onkeypress=\"return acceptNum(event)\" value=\"" . $Contrato['porcentajes_insumos'] . "\"  >%  <b>PORCENTAJE INSUMOS</b>   </td>\n";        $html .= "  </tr>\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"formulacion_table_list\" > <b> CONDICIONES DEL CLIENTE: </b>   </td>\n";        $html .= "      <td  class=\"modulo_list_claro\" colspan=\"4\" align=\"left\" >";        $html .= "		    			<TEXTAREA style=\"width:100%\" class=\"textarea\" name=\"condiciones_cliente\" id=\"condiciones_cliente\">" . $Contrato['condiciones_cliente'] . "</TEXTAREA> \n";        $html .= "		</td>\n";        $html .= "  </tr>\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"formulacion_table_list\" > <b> OBSERVACIONES: </b>   </td>\n";        $html .= "      <td  class=\"modulo_list_claro\" colspan=\"4\" align=\"left\" >";        $html .= "		    			<TEXTAREA style=\"width:100%\" class=\"textarea\" name=\"observaciones\" id=\"observaciones\">" . $Contrato['observaciones'] . "</TEXTAREA> \n";        $html .= "		</td>\n";        $html .= "  </tr>\n";        $html .= "  <tr>\n";        $checked = " ";        if ($Contrato['facturar_iva'] == '1') {            $checked = " checked ";        }        if (empty($Contrato)) {            $checked = " checked ";        }        //$html .= "      <td> FACTURAR I.V.A <input type=\"checkbox\" name='facturar_iva' id='facturar_iva' class=\"input-checkbox\" {$checked}> </td>";        $html .= "      <td> FACTURAR I.V.A                              <select name='facturar_iva' id='facturar_iva' >";        $seleccionar = " ";        if ($Contrato['facturar_iva'] == '1' || empty($Contrato)) {            $seleccionar = " selected ";        }        $html .= "              <option value='1' {$seleccionar} >SI</option>";        $seleccionar = " ";        if ($Contrato['facturar_iva'] == '0') {            $seleccionar = " selected  ";        }        $html .= "              <option value='0' {$seleccionar} >NO</option>";        $html .= "      </select> </td>";        $html .= "<td>";        $html .= "<input class=\"input-radio\" type=\"checkbox\" name=\"sincronizar\" id=\"sincronizar\" value='1'><b>SINCRONIZAR</b>";        $html .= "</td>";				if ($Contrato["sw_autorizacion"] == '1'){			$html .= "<td>";			$html .= "<input class=\"input-radio\" style=\"opacity:0;\" type=\"checkbox\" name=\"sw_autorizacion\" id=\"sw_autorizacion\" checked disabled><b style=\"opacity:0;\">AUTORIZAR CARTERA</b>";			$html .= "</td>";		} else if ($Contrato["sw_autorizacion"] == '0') {            $html .= "<td>";            $html .= "<input class=\"input-radio\" style=\"opacity:0;\" type=\"checkbox\" name=\"sw_autorizacion\" id=\"sw_autorizacion\" disabled ><b style=\"opacity:0;\">AUTORIZAR CARTERA</b>";            $html .= "</td>";        } else {			$html .= "<td>";            $html .= "<input class=\"input-radio\" style=\"opacity:0;\" type=\"checkbox\" name=\"sw_autorizacion\" id=\"sw_autorizacion\" checked disabled><b style=\"opacity:0;\">AUTORIZAR CARTERA</b>";			$html .= "</td>";		}			/*if($Contrato["sw_facturacion_agrupada"] == '1'){			$html .= "<td>";			$html .= "<input class=\"input-radio\" type=\"checkbox\" name=\"sw_facturacion_agrupada\" id=\"sw_facturacion_agrupada\" checked ><b>FACTURACION AGRUPADA</b>";			$html .= "</td>";		} else {			$html .= "<td>";			$html .= "<input class=\"input-radio\" type=\"checkbox\" name=\"sw_facturacion_agrupada\" id=\"sw_facturacion_agrupada\" ><b>FACTURACION AGRUPADA</b>";			$html .= "</td>";		}*/				        $html .= "  </tr>\n";        $html .= "</table>";        $html .= "<br>";        $html .= "<table align=\"center\" width=\"50%\">\n";        $html .= "						<tr>\n";        $html .= "							<td align='center'>\n";        /*         * Campo Que permite idenfiticar si:         * 1- Si Es para Insercion         * 0- Si Es para Modificacion         */        $html .= "        					<input type=\"hidden\" name=\"empresa_id\"  id=\"empresa_id\" value=\"" . $datos['empresa'] . "\">\n";        if (empty($Contrato))            $html .= "        					<input type=\"hidden\" name=\"consulta\"  id=\"consulta\" value=\"1\">\n";        else            $html .= "        					<input type=\"hidden\" name=\"consulta\"  id=\"consulta\" value=\"0\">\n";        $html .= "        					<input class=\"input-submit\" type=\"submit\" class=\"input-text\" name=\"btnCrear\" value=\"CREAR CONTRATO\" onclick=\" ValidarDtos(document.Formulario)\">\n";        $html .= "							</td>\n";        $html .= "							<td align='center' colspan=\"1\">\n";        $html .= "								<input class=\"input-submit\" type=\"button\" name=\"limpiar\" onclick=\"LimpiarCampos(document.Formulario)\" value=\"LIMPIAR CAMPOS\">\n";        $html .= "							</td>\n";        $html .= "  </tr >\n";        $html .= "</form>";        $html .= "</table>";        $html .= " <br>";        $html .= "<form name=\"Buscador\" id=\"Buscador\" action=\"" . $action['buscar'] . "\"  method=\"post\" >\n";        $html .= "<table  width=\"85%\" align=\"center\" border=\"0\" class=\"modulo_table_list\" >\n";        $html .= "  <tr align=\"center\" class=\"formulacion_table_list\">\n";        $html .= "		<td colspan=\"9\" >";        $html .= "		BUSCADOR DE PRODUCTOS..";        $html .= "		</td>";        $html .= "	</tr>";        $html .= "  <tr align=\"center\" class=\"modulo_table_list_title\">\n";        $html .= "		<td >";        $html .= "			CLASE";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			<input type=\"input-text\" name=\"buscador[laboratorio]\" id=\"buscador[laboratorio]\" class=\"input-text\" style=\"width:100%\">";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			SUBCLASE";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			<input type=\"input-text\" name=\"buscador[principio_activo]\" id=\"buscador[principio_activo]\" class=\"input-text\" style=\"width:100%\">";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			CODIGO PRODUCTO...";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			<input type=\"input-text\" name=\"buscador[codigo_producto]\" id=\"buscador[codigo_producto]\" class=\"input-text\" style=\"width:100%\">";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			DESCRIPCION";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			<input type=\"input-text\" name=\"buscador[descripcion]\" id=\"buscador[descripcion]\" class=\"input-text\" style=\"width:100%\">";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			<input type=\"hidden\" name=\"contrato_cliente_id\" id=\"contrato_cliente_id\" value=\"" . $_REQUEST['contrato_cliente_id'] . "\">";        $html .= "			<input type=\"submit\" class=\"input-submit\" style=\"width:100%\" value=\"BUSCAR PRODUCTO..\">";        $html .= "		</td>";        $html .= "	</tr>";        $html .= "</table>";        $html .= "</form>";        $html .= " <br>"; //ProductosContrato				$html .= "<form name=\"eliminarTodo\" id=\"eliminarTodo\" action=\"" . $action['eliminar'] . "\"  method=\"post\" onSubmit=\"Validar_Eliminar(document.eliminarTodo); return false;\">\n";		        $html .= "<table align=\"center\" width=\"50%\">\n";        $html .= "	<tr>\n";		$html .= "		<td align=\"center\">";		$html .= "			<input type=\"submit\" class=\"input-submit\" value=\"ELIMINAR PRODUCTOS DEL CONTRATO\">";		$html .= "		</td>";		$html .= "	</tr>";        $html .= "</table>";		$html .= "</form>";		$html .= " <br>";        /* Listado de Productos del Contrato */        $pgn = AutoCarga::factory("ClaseHTML");        $html .= "		" . $pgn->ObtenerPaginado($conteo, $pagina, $action['paginador']);        $html .= "		<div id=\"error\" class=\"label_error\"></div>";        $html .= "                  <table width=\"100%\" align=\"center\" class=\"modulo_table_list\">\n";        $html .= "                    <tr class=\"modulo_table_list_title\">\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='CODIGO DEL PRODUCTO'>COD. PRODUCTO </a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='NOMBRE DEL PRODUCTO'>DESCRIPCION</a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='PRECIO PACTADO DE VENTA'>PRECIO VENTA";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" width=\"2%\">\n";        $html .= "                        <a title='ELIMINAR'>DEL<a>";        $html .= "                      </td>\n";        $html .= "                    </tr>\n";        $i = 0;        foreach ($ProductosContrato as $key => $valor) {            $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";            $html .= "						<td align=\"center\">" . $valor['codigo_producto'] . "</td>";            $html .= "						<td>" . $valor['descripcion'] . "</td>";            $html .= "						<td>$" . FormatoValor($valor['precio_pactado'], 2) . "</b></td>";            $html .= "						<td align=\"center\">";            $html .= "						<center><a href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'Crear_Contrato', array("buscador" => $request['buscador'], "eliminar" => "1", "codigo_producto" => $valor['codigo_producto'], "contrato_cliente_id" => $_REQUEST['contrato_cliente_id'], "tipo_id_tercero" => $_REQUEST['tipo_id_tercero'], "tercero_id" => $_REQUEST['tercero_id'], "codigo_unidad_negocio" => $_REQUEST['codigo_unidad_negocio'], "tipo_contrato" => $_REQUEST['tipo_contrato'])) . "\" class=\"label_error\"  title=\"MODIFICAR CONTRATO\"><img src=\"" . GetThemePath() . "/images/delete2.gif\" border='0' ></a></center>\n";            $html .= "						</td>";            $html .= "                   </tr>\n";            $i++;        }        $html .= "				</table>";        /* Fin Listado de Productos del Contrato */        $html .= "<table align=\"center\" width=\"50%\">\n";        $html .= "  <tr>\n";        $html .= "    <td align=\"center\">\n";        $html .= "      <a href=\"" . $action['volver'] . "\"  class=\"label_error\">\n";        $html .= "        Volver\n";        $html .= "      </a>\n";        $html .= "    </td>\n";        $html .= "  </tr>\n";        $html .= "</table>\n";        $html .= ThemeCerrarTabla();        $html .= $this->CrearVentana('800', 'BUSCAR TERCEROS CLIENTES');        /*          Precarga de algunos datos Del Cliente que requieren Xajax y Javascript         */        if (!empty($Contrato)) {            $html .= " <script>";            $html .= "	for (i=0;i<document.Formulario.tipo_contrato.length;i++){		if (document.Formulario.tipo_contrato[i].value=='" . $Contrato['tipo_contrato'] . "') ";            $html .= "		{";            $html .= "		document.Formulario.tipo_contrato[i].checked=true;";            $html .= "		}		else		{		document.Formulario.tipo_contrato[i].disabled=true;		}		}";            $html .= "		";            $html .= " </script>";        }        return $html;    }    /*     * Funcion donde se crea la Forma del Contrato a llenar       * @param array $datos vector que contiene la informacion de Los Proveedores     * @param array $action vector que contiene los link de la aplicacion     * @param array $datos_empresa vector que contiene la informacion de Empresa que contrata al proveedor     * @param string $fecha contiene la informacion de la fecha actual.     * @return string $html retorna la cadena con el codigo html de la pagina     */    function Productos_Contrato($datos, $action, $Contrato, $productos_inventario, $conteo, $pagina, $error = "", $success = "", $doc = "") {        $html = ThemeAbrirTabla('PRODUCTOS: CONTRATO - CLIENTE');        /*          Funciones JavaScript         */        $html .= "<script>";        $html .= "function Paginador(Formulario,offset)";        $html .= "{";        $html .= "xajax_Listado_TerceroCliente(Formulario,offset);";        $html .= "}";        $html .= "</script>";        $html .= "<script>";        $html .= "	function ValidarCantidad_Checkbox(campo_precio_pactado,costo_ultima_compra,checkbox_id)\n";        $html .= "	{\n";        $html .= "	if(parseFloat(document.getElementById(campo_precio_pactado).value)<parseFloat(costo_ultima_compra))";        $html .= "			document.getElementById(checkbox_id).checked=0;\n";        $html .= "		else{\n";        $html .= "			document.getElementById(checkbox_id).checked=1;\n";        $html .= "			}\n";        $html .= "	}\n";        $html .= "	function ValidarCantidad(campo,valor,cant_sol,capa)\n";        $html .= "	{\n";        $html .= "		document.getElementById(campo).style.background='';\n";        $html .= "		document.getElementById('error').innerHTML='';\n";        $html .= "			document.getElementById(capa).checked=0;\n"; /* || parseFloat(valor) < parseFloat(cant_sol) */        $html .= "		if(isNaN(valor) || parseFloat(valor)<=0 || valor=='')\n";        $html .= "		{\n";        $html .= "			document.getElementById(campo).value='';\n";        $html .= "			document.getElementById(campo).style.background='#ff9595';\n";        $html .= "			document.getElementById('error').innerHTML='<center>CANTIDAD NO VALIDA</center>';\n";        $html .= "			document.getElementById(capa).disabled=\"true\";\n";        $html .= "		}\n";        $html .= "		else{\n";        $html .= "			document.getElementById(capa).style.display=\"\";\n";        $html .= "			document.getElementById(capa).disabled=\"\";\n";        $html .= "		}\n";        $html .= "	}\n";        /* if (entrar)           { */        $html .= "function Validar_Campos(Formulario)";        $html .= "{";        $html .= " var entrar = confirm('Continuar?');";        $html .= " if(entrar)";        $html .= "		Formulario.submit();";        $html .= "	else";        $html .= "		return false;";        $html .= "}";        $html .= "</script>";        /*          Fin Funciones JavaScript         */        $ctl = AutoCarga::factory("ClaseUtil");        $html .= $ctl->IsDate("-");        $html .= $ctl->AcceptDate("-");        $html .= $ctl->AcceptNum("-");        $html .= $ctl->LimpiarCampos();        $html .= $ctl->RollOverFilas();        $html .= "<center><div class=\"label_error\" id=\"error\"></div></center>";        $html .= "<table  width=\"85%\" align=\"center\" border=\"0\" class=\"modulo_table_list\" >\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"formulacion_table_list\" colspan=\"3\" > <b>EMPRESA : " . $datos['razon_social'] . "  CONTRATO :#" . $Contrato['contrato_cliente_id'] . "</b> </td>\n";        $html .= "  </tr>\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"formulacion_table_list\" colspan=\"3\" > <b> INFORMACIï¿½N DEL CLIENTE: </b></td>\n";        $html .= "  </tr>\n";        $html .= "  <tr class=\"modulo_table_list_title\" >\n";        $html .= "       <td class=\"modulo_list_claro\"  align=\"center\" colspan=\"3\">\n";        $html .= "		" . $Contrato['contrato'];        $html .= "		</td>";        $html .= "	</tr>";        $html .= "  <tr align=\"center\" >\n";        $html .= "       <td class=\"modulo_list_claro\"  align=\"center\" colspan=\"3\">\n";        /*          SubTabla para fechas         */        $html .= "			<table class=\"modulo_table_list\"	width=\"100%\">";        $html .= "				<tr class=\"modulo_table_list_title\">";        $html .= "      			<td  class=\"formulacion_table_list\" > <b> DESCRIPCION DEL CONTRATO: </b>   </td>\n";        $html .= "      			<td  class=\"modulo_list_claro\" colspan=\"2\" align=\"left\" >";        $html .= "		    			<input value=\"" . $Contrato['descripcion_contrato'] . "\" style=\"width:100%\" type=\"text\" class=\"input-text\" name=\"descripcion\" readonly id=\"descripcion\" maxlength=\"30\" > \n";        $html .= "					</td>\n";        $html .= "      			<td  class=\"formulacion_table_list\" > <b> VALOR DEL CONTRATO: </b>   $</td>\n";        $html .= "      			<td  class=\"modulo_list_claro\" colspan=\"2\" align=\"left\" >";        $html .= "		    			<input value=\"" . $Contrato['valor_contrato'] . "\" onkeypress=\"return acceptNum(event)\" style=\"width:100%\" type=\"text\" readonly class=\"input-text\" name=\"valor_contrato\" id=\"valor_contrato\" maxlength=\"20\"> \n";        $html .= "					</td>\n";        $html .= "  			</tr>\n";        $html .= "			</table>";        $html .= "		</td>";        $html .= "  </tr>\n";        $html .= "  </tr>\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"formulacion_table_list\" > <b> VENDEDOR: </b>   </td>\n";        $html .= "      <td  class=\"modulo_list_claro\" colspan=\"2\" align=\"left\" > " . $Contrato['tipo_id_vendedor'] . "-" . $Contrato['vendedor_id'] . ": " . $Contrato['nombre'] . "   </td>\n";        $html .= "  </tr>\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"formulacion_table_list\" colspan=\"3\" > <b> PORCENTAJES DE VENTA </b>   </td>\n";        $html .= "  </tr>\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"modulo_list_claro\" > <input type=\"text\" readonly class=\"input-text\" id=\"porcentaje_genericos\" name=\"porcentaje_genericos\" size=\"5\" maxlength=\"4\" onkeypress=\"return acceptNum(event)\" value=\"" . $Contrato['porcentaje_genericos'] . "\"  >%  <b>PORCENTAJE GENERICOS</b>   </td>\n";        $html .= "      <td  class=\"modulo_list_claro\" > <input type=\"text\" readonly class=\"input-text\" id=\"porcentaje_marcas\" name=\"porcentaje_marcas\" size=\"5\" maxlength=\"4\" onkeypress=\"return acceptNum(event)\" value=\"" . $Contrato['porcentaje_marcas'] . "\"  >%  <b>PORCENTAJE MARCA</b>   </td>\n";        $html .= "      <td  class=\"modulo_list_claro\" > <input type=\"text\" readonly class=\"input-text\" id=\"porcentajes_insumos\" name=\"porcentajes_insumos\" size=\"5\" maxlength=\"4\" onkeypress=\"return acceptNum(event)\" value=\"" . $Contrato['porcentajes_insumos'] . "\"  >%  <b>PORCENTAJE INSUMOS</b>   </td>\n";        $html .= "  </tr>\n";        $html .= "</table>";        $html .= "<br>";        $html .= "<form name=\"Formulario\" id=\"Formulario\" action=\"" . $action['buscar'] . "\"  method=\"post\" >\n";        $html .= "<table  width=\"85%\" align=\"center\" border=\"0\" class=\"modulo_table_list\" >\n";        $html .= "  <tr align=\"center\" class=\"formulacion_table_list\">\n";        $html .= "		<td colspan=\"9\" >";        $html .= "		BUSCADOR DE PRODUCTOS.";        $html .= "		</td>";        $html .= "	</tr>";        $html .= "  <tr align=\"center\" class=\"modulo_table_list_title\">\n";        $html .= "		<td >";        $html .= "			CLASE";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			<input type=\"input-text\" name=\"buscador[laboratorio]\" id=\"buscador[laboratorio]\" class=\"input-text\" style=\"width:100%\">";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			SUBCLASE";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			<input type=\"input-text\" name=\"buscador[principio_activo]\" id=\"buscador[principio_activo]\" class=\"input-text\" style=\"width:100%\">";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			CODIGO PRODUCTO";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			<input type=\"input-text\" name=\"buscador[codigo_producto]\" id=\"buscador[codigo_producto]\" class=\"input-text\" style=\"width:100%\">";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			DESCRIPCION";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			<input type=\"input-text\" name=\"buscador[descripcion]\" id=\"buscador[descripcion]\" class=\"input-text\" style=\"width:100%\">";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			<input type=\"hidden\" name=\"contrato_cliente_id\" id=\"contrato_cliente_id\" value=\"" . $_REQUEST['contrato_cliente_id'] . "\">";        $html .= "			<input type=\"submit\" class=\"input-submit\" style=\"width:100%\" value=\"BUSCAR PRODUCTO.\">";        $html .= "		</td>";        $html .= "	</tr>";        $html .= "</table>";        $html .= "</form>";        $html .= " <br>";		$subirArchivo = ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'Productos_Contrato', array("contrato_cliente_id" => $Contrato['contrato_cliente_id']));				$html.= "<form name=\"subir\" enctype=\"multipart/form-data\" action=\"{$subirArchivo}\" method = \"post\" >\n";		$html.="<table width=\"40%\" align=\"center\" border='0' >";				 if ($error != "") {            $html .= "<tr align='center'>                        <td colspan='2'><center style='color:red;'>{$error}</center></td>                     </tr>";        }				 if ($success != "") {            $html .= "<tr align='center'>                        <td colspan='2'><center style='color:blue;'>{$success}</center></td>                     </tr>";        }				        if ($doc != "") {            $html .= "<tr>                        <td colspan='2'><a href='{$doc}' target='_blank' >Descargar plano de productos con error</a></td>                     </tr>";        }				$html.="<tr>";		$html.="<td class=\"formulacion_table_list\" align=\"center\" colspan='10'>ESTRUCTURA ARCHIVO PLANO (separado por ';')</td>";		$html.="</tr>";		$html.="<tr class=\"modulo_list_claro\">";		$html.="<td align=\"center\" colspan='1'>Codigo producto</td>";		$html.="<td align=\"center\" colspan='1'>Costo Venta </td>";		$html.="</tr>";  		$html.="<tr>";		$html.= "<td width=\"40%\" style=\"text-align:center;text-indent:8pt\" class=\"formulacion_table_list\" >ADJUNTAR ARCHIVO: </td>\n";		$html.= "<td width=\"50%\" align=\"left\">\n";		$html.= "<input type=\"file\" size=\"45\"  name=\"archivo_plano\" id=\"archivo_plano\">\n";		$html.= "</td>\n";		$html.= "</tr>\n";		$html.= "<tr class=\"modulo_list_claro\">\n";		$html.= "<td colspan='2'>&nbsp;</td>\n";		$html.= "</tr>\n";		$html.= "<tr>\n";		$html.= "      <td colspan='2' align=\"center\" width=\"50%\">\n";		$html.= "        <input class=\"input-submit\" type=\"submit\" name=\"enviar\" value=\"CARGAR\">\n";		$html.= "      </td>\n";		$html.= "</tr>\n";		$html.="</table>";      		$html.= "</form>\n"; 		$html .= " <br>";				        $pgn = AutoCarga::factory("ClaseHTML");        $html .= "		" . $pgn->ObtenerPaginado($conteo, $pagina, $action['paginador']);        $html .= "		<div id=\"error\" class=\"label_error\"></div>";        $html .= "		<form name=\"FormularioProductos\" id=\"FormularioProductos\" action=\"" . $action['guardar'] . "\"  method=\"post\" onSubmit=\"Validar_Campos(document.FormularioProductos); return false;\">\n";        $html .= "                  <table width=\"100%\" align=\"center\" class=\"modulo_table_list\">\n";        $html .= "                    <tr class=\"modulo_table_list_title\">\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='CODIGO DEL PRODUCTO'>COD. PRODUCTO </a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='NOMBRE DEL PRODUCTO'>DESCRIPCION</a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='COSTO COMPRA'>COSTO COMPRA";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='COSTO VENTA'>COSTO VENTA";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" width=\"2%\">\n";        $html .= "                        <a title='SELECCIONAR'>SEL<a>";        $html .= "                      </td>\n";        $html .= "                    </tr>\n";        $i = 0;        foreach ($productos_inventario as $key => $valor) {            $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";            $html .= "						<td align=\"center\">" . $valor['codigo_producto'] . "</td>";            $html .= "						<td>" . $valor['descripcion'] . "</td>";            $html .= "						<td>$" . FormatoValor($valor['costo_ultima_compra'], 2) . "</b></td>";            $html .= "						<td>";            $html .= "						<input type=\"input-text\" name=\"precio_pactado" . $i . "\" id=\"precio_pactado" . $i . "\" class=\"input-text\" style=\"width:100%\" onkeyup=\"ValidarCantidad('precio_pactado" . $i . "',this.value,'" . $valor['costo_ultima_compra'] . "','$i');\">";            /* $html .= "						<input type=\"hidden\" name=\"codigo_producto[".$i."]\" id=\"codigo_producto[".$i."]\" class=\"input-text\" style=\"width:100%\" value=\"".$valor['codigo_producto']."\">"; */            $html .= "						";            $html .= "						</td>";            $html .= "						<td align=\"center\"><input disabled type=\"checkbox\" name=\"" . $i . "\" id=\"" . $i . "\" value=\"" . $valor['codigo_producto'] . "\" class=\"input-checkbox\" > </td>"; /* onclick=\"ValidarCantidad_Checkbox('precio_pactado".$i."','".$valor['costo_ultima_compra']."','".$i."');\" */            $html .= "                   </tr>\n";            $i++;        }        $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";        $html .= "						<td><input type=\"hidden\" value=\"" . $_REQUEST['contrato_cliente_id'] . "\" name=\"contrato_cliente_id\" id=\"contrato_cliente_id\"></td>";        $html .= "						<td><input type=\"hidden\" name=\"cantidad_registros\" id=\"cantidad_registros\" value=\"" . $i . "\"></td>";        $html .= "						<td></td>";        $html .= "						<td align=\"center\"><input type=\"submit\" class=\"input-submit\" style=\"width:100%\" value=\"AGREGAR AL CONTRATO\"> </td>";        $html .= "						<td></td>";        $html .= "                   </tr>\n";        $html .= "				</table>";        $html .= "		</form>";        $html .= "<table align=\"center\" width=\"50%\">\n";        $html .= "  <tr>\n";        $html .= "    <td align=\"center\">\n";        $html .= "      <a href=\"" . $action['volver'] . "\"  class=\"label_error\">\n";        $html .= "        Volver\n";        $html .= "      </a>\n";        $html .= "    </td>\n";        $html .= "  </tr>\n";        $html .= "</table>\n";        $html .= ThemeCerrarTabla();        $html .= $this->CrearVentana('800', 'BUSCAR TERCEROS CLIENTES');        /*          Precarga de algunos datos Del Cliente que requieren Xajax y Javascript         */        return $html;    }    /**     * Funcion donde se crea la Forma del Contrato a llenar       * @param array $datos vector que contiene la informacion de Los Proveedores     * @param array $action vector que contiene los link de la aplicacion     * @param array $datos_empresa vector que contiene la informacion de Empresa que contrata al proveedor     * @param string $fecha contiene la informacion de la fecha actual.     * @return string $html retorna la cadena con el codigo html de la pagina     */    function Listado_Cotizaciones($action, $datos, $Cotizaciones, $conteo, $pagina) {        $html = ThemeAbrirTabla(' COTIZACIONES - CLIENTE ');        //Que solo aparezca Cuando NO hay un contrato activo y/o existente para ese tercero selecionado        $ctl = AutoCarga::factory("ClaseUtil");        $html .= $ctl->IsDate("-");        $html .= $ctl->AcceptDate("-");        $html .= $ctl->AcceptNum("-");        $html .= $ctl->LimpiarCampos();        $html .= $ctl->RollOverFilas();        $html .="<div align=\"center\" class=\"label_error\" id='error'></div> ";        $html .="<script >\n";        $html .= "  function max(e){  ";        $html .= "  tecla = (document.all) ? e.keyCode : e.which; ";        $html .= "  if (tecla==8) return true;";        $html .= "  if (tecla==13) return false;";        $html .= " }";        $html .= "</script>\n";        $html .= "<table class=\"modulo_table_list\" rules=\"all\" align=\"center\">";        $html .= "	<tr class=\"modulo_list_claro\">";        $html .= "    <td align=\"center\" class=\"normal_10AN\">\n";        $html .= "		CREAR NUEVA COTIZACION ";        $html .= "    </td>\n";        $html .= "    <td align=\"center\">\n";        $html .= "		<center class=\"label_error\"><a href=\"" . $action['Crear_Cotizacion'] . "\"><img src=\"" . GetThemePath() . "/images/pplan.png\" border='0'></a></center>";        $html .= "    </td>\n";        $html .= "	</tr>";        $html .= "</table>";        $html .= "<br>";        $html .= "<form name=\"Buscador\" id=\"Buscador\" action=\"" . $action['buscador'] . "\" method=\"post\">";        $html .= "<table  width=\"70%\" align=\"center\" border=\"0\" class=\"modulo_table_list\">\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"formulacion_table_list\">NOMBRE TERCERO</td>\n";        $html .= "      <td  class=\"formulacion_table_list\"><input name=\"buscador[nombre_tercero]\" id=\"buscador[nombre_tercero]\" class=\"input-text\" style=\"width:100%\"></td>\n";        $html .= "      <td  class=\"formulacion_table_list\"># COTIZACION</td>\n";        $html .= "      <td  class=\"formulacion_table_list\"><input name=\"buscador[pedido_cliente_id_tmp]\" id=\"buscador[pedido_cliente_id_tmp]\" class=\"input-text\" style=\"width:100%\"></td>\n";        $html .= "      <td  class=\"formulacion_table_list\"><input type=\"submit\" value=\"BUSCAR COTIZACION\" class=\"input-submit\"></td>\n";        $html .= "	</tr>";        $html .= "</table>";        $html .= "</form>";        $pgn = AutoCarga::factory("ClaseHTML");        $html .= "		" . $pgn->ObtenerPaginado($conteo, $pagina, $action['paginador']);        $html .= "                  <table width=\"100%\" align=\"center\" class=\"modulo_table_list\">\n";        $html .= "                    <tr class=\"modulo_table_list_title\">\n";        $html .= "                      <td align=\"center\" width=\"2%\">\n";        $html .= "                        <a title='NUMERO DE COTIZACION'>#COTIZACION </a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='CLIENTE'>CLIENTE</a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='LOCALIZACION DEL CLIENTE'>UBICACION</a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='TELEFONO'>TELEFONO</a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='FECHA CREACION'>FECHA REGISTRO";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='FECHA FINAL'>VENDEDOR";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='MODIFICAR'>MOD<a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='ESTADO'>OP<a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='CREAR PEDIDO'>CP<a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='IMPRIMIR'>IMP<a>";        $html .= "                      </td>\n";        $html .= "                    </tr>\n";        $rpt = new GetReports();        foreach ($Cotizaciones as $key => $valor) {            $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";            $html .= "						<td>" . $valor['pedido_cliente_id_tmp'] . "</td>";            $html .= "						<td>" . $valor['tipo_id_tercero'] . " " . $valor['tercero_id'] . "-" . $valor['nombre_tercero'] . "</b></td>";            $html .= "						<td>" . $valor['direccion'] . "-" . $valor['ubicacion'] . "</td>";            $html .= "						<td>" . $valor['telefono'] . "</td>";            $html .= "						<td>" . $valor['fecha_registro'] . "</td>";            $html .= "						<td>" . $valor['tipo_id_vendedor'] . "-" . $valor['vendedor_id'] . ": " . $valor['nombre'] . "</td>";            if ($valor['estado'] == '1') {                $html .= "						<td>";                $html .= "						<center><a  href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'Modificar_Cotizacion', array("pedido_cliente_id_tmp" => $valor['pedido_cliente_id_tmp'], "tipo_id_tercero" => $valor['tipo_id_tercero'], "tercero_id" => $valor['tercero_id'])) . "\" class=\"label_error\"  title=\"MODIFICAR COTIZACION\"><img src=\"" . GetThemePath() . "/images/modificar.png\" border='0'></a></center>\n";                $html .= "						</td>";                $html .= "						<td>";                $html .= "						<center><a onClick=\"return confirm('INACTIVAR LA COTIZACION #" . $valor['pedido_cliente_id_tmp'] . "');\" href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'Cotizaciones', array("pedido_cliente_id_tmp" => $valor['pedido_cliente_id_tmp'], "inactivar" => "1")) . "\" class=\"label_error\"  title=\"COTIZACION ACTIVA: CAMBIAR A INACTIVO\"><img src=\"" . GetThemePath() . "/images/pactivo.png\" border='0' ></a></center>\n";                $html .= "						</td>";                $html .= "						<td>";                $html .= "						<center><a onClick=\"return confirm('CONFIRMA LA CREACION DEL PEDIDO A PARTIR DE LA COTIZACION #" . $valor['pedido_cliente_id_tmp'] . "');\" href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'Crear_PedidosCliente', array("pedido_cliente_id_tmp" => $valor['pedido_cliente_id_tmp'])) . "\" class=\"label_error\"  title=\"CREAR PEDIDO AL CLIENTE\"><img src=\"" . GetThemePath() . "/images/pguardar.png\" border='0' ></a></center>\n";                $html .= "						</td>";            } else {                $html .= "						<td>";                $html .= "							<center><img title=\"CONTRATO INACTIVO\" src=\"" . GetThemePath() . "/images/pinactivo.png\" border='0' ></center>\n";                $html .= "						</td>";                $html .= "						<td>";                $html .= "						<center></center>\n";                $html .= "						</td>";                $html .= "						<td>";                $html .= "						<center></center>\n";                $html .= "						</td>";            }            $html .= "						<td>";            $html .= $rpt->GetJavaReport('app', 'ContratacionProductosCliente', 'reporte_cotizacion_cliente', $valor, array('rpt_name' => '', 'rpt_dir' => 'cache', 'rpt_rewrite' => TRUE));            $fnc = $rpt->GetJavaFunction();            $html .= "<center>\n";            $html .= "	<a title=\"IMPRIMIR\" class=\"label_error\" href=\"javascript:" . $fnc . "\">\n";            $html .= "	  <image title=\"IMPRIMIR COTIZACION\" src=\"" . GetThemePath() . "/images/imprimir.png\" border=\"0\">\n";            $html .= "  </a>\n";            $html .= "</center>\n";            $html .= "						</td>";            $html .= "                   </tr>\n";        }        $html .= "				</table>";        $html .= "<br>";        $html .= "<table align=\"center\" width=\"50%\">\n";        $html .= "  <tr>\n";        $html .= "    <td align=\"center\">\n";        $html .= "      <a href=\"" . $action['volver'] . "\"  class=\"label_error\">\n";        $html .= "        VOLVER\n";        $html .= "      </a>\n";        $html .= "    </td>\n";        $html .= "  </tr>\n";        $html .= "</table>\n";        $html .= ThemeCerrarTabla();        return $html;    }    /**     * Funcion donde se crea la Forma del Contrato a llenar       * @param array $datos vector que contiene la informacion de Los Proveedores     * @param array $action vector que contiene los link de la aplicacion     * @param array $datos_empresa vector que contiene la informacion de Empresa que contrata al proveedor     * @param string $fecha contiene la informacion de la fecha actual.     * @return string $html retorna la cadena con el codigo html de la pagina     */    function Listado_TercerosCotizaciones($action, $datos, $Terceros_Clientes, $tipos_ids_terceros, $conteo, $pagina) {        $html = ThemeAbrirTabla(' LISTADO - CLIENTE ');        //Que solo aparezca Cuando NO hay un contrato activo y/o existente para ese tercero selecionado        $ctl = AutoCarga::factory("ClaseUtil");        $html .= $ctl->IsDate("-");        $html .= $ctl->AcceptDate("-");        $html .= $ctl->AcceptNum("-");        $html .= $ctl->LimpiarCampos();        $html .= $ctl->RollOverFilas();        $html .="<div align=\"center\" class=\"label_error\" id='error'></div> ";        $html .="<script>\n";        $html .= "  function max(e){  ";        $html .= "  tecla = (document.all) ? e.keyCode : e.which; ";        $html .= "  if (tecla==8) return true;";        $html .= "  if (tecla==13) return false;";        $html .= " }";        $html .= "</script>\n";        $select .= "<select id=\"buscador[tipo_id_tercero]\" name=\"buscador[tipo_id_tercero]\" class=\"select\">";        $select .= "<option value=\"\">-- TODOS --</option>";        foreach ($tipos_ids_terceros as $k => $valor) {            $select .= "<option value=\"" . $valor['tipo_id_tercero'] . "\">" . $valor['tipo_id_tercero'] . "</option>";        }        $select .= "</select>";        $html .= "<form name=\"Buscador\" id=\"Buscador\" action=\"" . $action['buscador'] . "\" method=\"post\">";        $html .= "<table  width=\"50%\" align=\"center\" border=\"0\" class=\"modulo_table_list\">\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"formulacion_table_list\">TIPO IDENTIFICACION</td>\n";        $html .= "      <td  class=\"formulacion_table_list\">" . $select . "</td>\n";        $html .= "      <td  class=\"formulacion_table_list\"># IDENTIFICACION</td>\n";        $html .= "      <td  class=\"formulacion_table_list\"><input name=\"buscador[tercero_id]\" id=\"buscador[tercero_id]\" class=\"input-text\" style=\"width:100%\"></td>\n";        $html .= "      <td  class=\"formulacion_table_list\">NOMBRE</td>\n";        $html .= "      <td  class=\"formulacion_table_list\"><input name=\"buscador[nombre_tercero]\" id=\"buscador[nombre_tercero]\" class=\"input-text\" style=\"width:100%\"></td>\n";        $html .= "	</tr>";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"formulacion_table_list\" colspan=\"6\"><input type=\"submit\" value=\"BUSCAR TERCERO\" class=\"input-submit\"></td>\n";        $html .= "	</tr>";        $html .= "</table>";        $html .= "</form>";        $html .= "<br>";        $pgn = AutoCarga::factory("ClaseHTML");        $html .= "		" . $pgn->ObtenerPaginado($conteo, $pagina, $action['paginador']);        $html .= "                  <table width=\"100%\" align=\"center\" class=\"modulo_table_list\">\n";        $html .= "                    <tr class=\"modulo_table_list_title\">\n";        $html .= "                      <td align=\"center\" width=\"2%\">\n";        $html .= "                        <a title='IDENTIFICACION'>IDENTIFICACION</a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='CLIENTE'>NOMBRE DEL CLIENTE</a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title=''>UBICACION<a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='DIRECCION'>DIRECCION";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='TELEFONO'>TELEFONO";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" width=\"3%\">\n";        $html .= "                        <a title='CREAR COTIZACION'>COTIZ<a>";        $html .= "                      </td>\n";        $html .= "                    </tr>\n";        foreach ($Terceros_Clientes as $key => $valor) {            $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";            $html .= "						<td align=\"center\">" . $valor['tipo_id_tercero'] . "-" . $valor['tercero_id'] . "</td>";            $html .= "						<td>" . $valor['nombre_tercero'] . "</td>";            $html .= "						<td>" . $valor['pais'] . "-" . $valor['departamento'] . "-" . $valor['municipio'] . "</b></td>";            $html .= "						<td>" . $valor['direccion'] . "</b></td>";            $html .= "						<td>" . $valor['telefono'] . "</b></td>";            if ($valor['tipo_bloqueo_id'] == '1') {                $html .= "						<td>";                $html .= "						<center><a href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'Crear_Cotizacion', array("tipo_id_tercero" => $valor['tipo_id_tercero'], "tercero_id" => $valor['tercero_id'], "Nuevo" => "1")) . "\" class=\"label_error\"  title=\"PRODUCTOS PACTADOS CONTRATO\"><img src=\"" . GetThemePath() . "/images/pplan.png\" border='0' ></a></center>\n";                $html .= "						</td>";            } else {                $html .= "						<td>";                $html .= "						<center><img title=\"BLOQUEADO POR: " . $valor['bloqueo'] . "\" src=\"" . GetThemePath() . "/images/bloqueo.png\" border='0' ></center>\n";                $html .= "						</td>";            }            $html .= "                   </tr>\n";        }        $html .= "				</table>";        $html .= "<br>";        $html .= "<table align=\"center\" width=\"50%\">\n";        $html .= "  <tr>\n";        $html .= "    <td align=\"center\">\n";        $html .= "      <a href=\"" . $action['volver'] . "\"  class=\"label_error\">\n";        $html .= "        VOLVER\n";        $html .= "      </a>\n";        $html .= "    </td>\n";        $html .= "  </tr>\n";        $html .= "</table>\n";        $html .= ThemeCerrarTabla();        return $html;    }    /**     * Funcion donde se crea la Forma del Contrato a llenar       * @param array $datos vector que contiene la informacion de Los Proveedores     * @param array $action vector que contiene los link de la aplicacion     * @param array $datos_empresa vector que contiene la informacion de Empresa que contrata al proveedor     * @param string $fecha contiene la informacion de la fecha actual.     * @return string $html retorna la cadena con el codigo html de la pagina     */    function Crear_Cotizacion($action, $tercero, $Vendedores) {        $html = ThemeAbrirTabla(' CREAR COTIZACION ', '60%');        //Que solo aparezca Cuando NO hay un contrato activo y/o existente para ese tercero selecionado        $ctl = AutoCarga::factory("ClaseUtil");        $html .= $ctl->IsDate("-");        $html .= $ctl->AcceptDate("-");        $html .= $ctl->AcceptNum("-");        $html .= $ctl->LimpiarCampos();        $html .= $ctl->RollOverFilas();        $selected = " ";        $select_vend .= "<select id=\"vendedor_id\" name=\"vendedor_id\" class=\"select\" style=\"width:30%\">";        $select_vend .= "<option value=\"\">-- NINGUNO --</option>";        foreach ($Vendedores as $k => $v) {            if (trim($tercero['vendedor_id']) == (trim($v['tipo_id_vendedor']) . "@" . trim($v['vendedor_id'])))                $selected = " selected ";            else                $selected = " ";            $select_vend .= "<option " . $selected . " value=\"" . trim($v['tipo_id_vendedor']) . "@" . trim($v['vendedor_id']) . "\">" . $v['nombre'] . "</option>";        }        $select_vend .= "</select>";        $html .= "<form name=\"Formulario\" id=\"Formulario\" action=\"" . $action['Guardar'] . "\" method=\"post\">";        $html .= "<table width=\"100%\" align=\"center\" class=\"modulo_table_list\">\n";        $html .= "	<tr class=\"modulo_table_list_title\">\n";        $html .= "		<td colspan=\"4\">";        $html .= "		CREAR NUEVA COTIZACION";        $html .= "		</td>";        $html .= "	</tr>";        $html .= "	<tr class=\"formulacion_table_list\">\n";        $html .= "		<td colspan=\"4\">";        $html .= "		CLIENTE : " . $tercero['tipo_id_tercero'] . "-" . $tercero['tercero_id'] . ": " . $tercero['nombre_tercero'] . " ";        $html .= "		</td>";        $html .= "	</tr>";        $html .= "	<tr class=\"modulo_table_list_title\">\n";        $html .= "		<td colspan=\"\" width=\"20%\">";        $html .= "		DIRECCION";        $html .= "		</td>";        $html .= "		<td colspan=\"\" width=\"30%\" class=\"modulo_list_claro\">";        $html .= "		 " . $tercero['direccion'] . " ";        $html .= "		</td>";        $html .= "		<td colspan=\"\" width=\"20%\">";        $html .= "		TELEFONO";        $html .= "		</td>";        $html .= "		<td colspan=\"\" width=\"30%\" class=\"modulo_list_claro\">";        $html .= "		 " . $tercero['telefono'] . " ";        $html .= "		</td>";        $html .= "	</tr>";        $html .= "	<tr class=\"modulo_table_list_title\">\n";        $html .= "		<td colspan=\"\" width=\"20%\">";        $html .= "		VENDEDOR";        $html .= "		</td>";        $html .= "		<td colspan=\"3\" width=\"30%\" class=\"modulo_list_claro\" align=\"left\">";        $html .= "		 " . $select_vend . " ";        $html .= "		</td>";        $html .= "	</tr>";        $html .= "	<tr class=\"modulo_table_list_title\">";        $html .= "          <td colspan=\"\" width=\"20%\">";        $html .= "              OBSERVACIONES";        $html .= "          </td>";        $html .= "          <td colspan=\"3\" align=\"left\" width=\"30%\" class=\"modulo_list_claro\">";        $html .= "              <TEXTAREA id=\"observacion\" name=\"observacion\" class=\"textarea\" style=\"width:100%\"></TEXTAREA>";        $html .= "          </td>";        $html .= "	</tr>";        $html .= "	<tr class=\"modulo_table_list_title\">\n";        $html .= "		<td colspan=\"4\" width=\"20%\">";        $html .= "		<input type=\"hidden\" value=\"" . $tercero['tercero_id'] . "\" name=\"tercero_id\" id=\"tercero_id\">";        $html .= "		<input type=\"hidden\" value=\"" . $tercero['tipo_id_tercero'] . "\" name=\"tipo_id_tercero\" id=\"tipo_id_tercero\">";        $html .= "		<input type=\"submit\" value=\"CREAR COTIZACION\" class=\"input-submit\">";        $html .= "		</td>";        $html .= "	</tr>";        $html .= "</table>";        $html .= "</form>";        $html .= "<br>";        $html .= "<table align=\"center\" width=\"50%\">\n";        $html .= "  <tr>\n";        $html .= "    <td align=\"center\">\n";        $html .= "      <a href=\"" . $action['volver'] . "\"  class=\"label_error\">\n";        $html .= "        VOLVER\n";        $html .= "      </a>\n";        $html .= "    </td>\n";        $html .= "  </tr>\n";        $html .= "</table>\n";        $html .= ThemeCerrarTabla();        return $html;    }    function FormaCotizacion($action, $Tercero, $Cotizacion, $ProductosCotizacion, $Vendedores, $datos, $url = "", $error = "") {        $html = ThemeAbrirTabla(' COTIZACION CLIENTE: ' . $Tercero['nombre_tercero'] . ' ');        //Que solo aparezca Cuando NO hay un contrato activo y/o existente para ese tercero selecionado        $ctl = AutoCarga::factory("ClaseUtil");        $html .= "<script>";        $html .= "	function Paginador(Formulario,offset)";        $html .= "	{";        $html .= "	xajax_Buscar_ProductosInventario_d(Formulario,offset);";        $html .= "	}";        $html .= "</script>";        $html .= "<script>";        $html .= "	function ValidarCantidad_Checkbox(campo_precio_pactado,costo_ultima_compra,checkbox_id)\n";        $html .= "	{\n";        $html .= "	if(parseFloat(document.getElementById(campo_precio_pactado).value)<parseFloat(costo_ultima_compra))";        $html .= "			document.getElementById(checkbox_id).checked=0;\n";        $html .= "		else{\n";        $html .= "			document.getElementById(checkbox_id).checked=1;\n";        $html .= "			}\n";        $html .= "	}\n";        $html .= "	function ValidarCantidad(campo,valor,cant_sol,capa)\n";        $html .= "	{\n";        $html .= "		document.getElementById(campo).style.background='';\n";        $html .= "		document.getElementById('error').innerHTML='';\n";        $html .= "		if(isNaN(valor) || parseFloat(valor)<=0 || valor=='')\n";        $html .= "		{\n";        $html .= "			document.getElementById(campo).value='';\n";        $html .= "			document.getElementById(campo).style.background='#ff9595';\n";        $html .= "			document.getElementById('error').innerHTML='<center>CANTIDAD NO VALIDA</center>';\n";        $html .= "			document.getElementById(capa).disabled=\"true\";\n";        $html .= "			document.getElementById(capa).checked=0;\n"; /* || parseFloat(valor) < parseFloat(cant_sol) */        $html .= "		}\n";        $html .= "		else{\n";        $html .= "			document.getElementById(capa).style.display=\"\";\n";        $html .= "			document.getElementById(capa).disabled=\"\";\n";        $html .= "		}\n";        $html .= "	}\n";        $html .= "	function ValidarValores(campo_1,precio_compra,capa)\n";        $html .= "	{                                       //console.log(parseFloat(document.getElementById(campo_1).value))                                //console.log(parseFloat(precio_compra))                                        \n";        $html .= "		if(parseFloat(document.getElementById(campo_1).value) < parseFloat(precio_compra))\n";        $html .= "		{\n";        $html .= "			document.getElementById('error_').innerHTML='<center>EL PRECIO NO DEBE SER MENOR AL DE COMPRA: REVISAR CANTIDAD.</center>';\n";        $html .= "			document.getElementById(capa).disabled=\"true\";\n";        $html .= "			document.getElementById(capa).checked=0;\n";        $html .= "		}\n";        $html .= "		else{\n";        $html .= "			document.getElementById(capa).style.display=\"\";\n";        $html .= "			document.getElementById(capa).disabled=\"\";\n";        $html .= "		}\n";        $html .= "	}\n";        $html .= "</script>";        $html .= "<script>                       function validarFormulario(){                    var cantidad = document.getElementById('cantidad_registros').value;                                        if(validarCampos(cantidad)){                        xajax_Guardar_ProductoCotizacion(xajax.getFormValues('GrupoProductos'));                    } else {                       alert('Hay productos regulados con precio de venta invalido!');                    }          }                    function validarCampos(cantidad){                    //console.log('cantidad de input' + cantidad);                    for(var i = 0; i < cantidad; i++){                            var input = document.getElementById('valor_unitario'+i);                            var check = document.getElementById(i);                                                        if(input && check){                                 var datos = input.attributes.rel.value.split('_');                                 //console.log(check);                                if(datos[1] == '1' && check.checked){                                   var precio_regulado = datos[0];                                   var precio_venta = input.value;                                   //if(parseInt(precio_venta) > parseInt(precio_regulado)){                                   // console.log('no valido valor_unitario'+i +  ' con precio venta '+precio_venta + ' precio regulado  '+precio_regulado)                                   //     return false;                                   //}                                 }                                                               } else {                              //  console.log('input not found with index '+i);                            }                    }                                        return true;          }          </script>    ";        $html .= $ctl->IsDate("-");        $html .= $ctl->AcceptDate("-");        $html .= $ctl->AcceptNum("-");        $html .= $ctl->LimpiarCampos();        $html .= $ctl->RollOverFilas();        $selected = " ";        $select_vend .= "<select id=\"vendedor_id\" name=\"vendedor_id\" class=\"select\" style=\"width:30%\">";        $select_vend .= "<option value=\"\">-- NINGUNO --</option>";        foreach ($Vendedores as $k => $v) {            if (trim($Cotizacion['vendedor']) == (trim($v['tipo_id_vendedor']) . "@" . trim($v['vendedor_id'])))                $selected = " selected ";            else                $selected = " ";            $select_vend .= "<option " . $selected . " value=\"" . trim($v['tipo_id_vendedor']) . "@" . trim($v['vendedor_id']) . "\">" . $v['nombre'] . "</option>";        }        $select_vend .= "</select>";        $html .= "<table width=\"50%\" align=\"center\" class=\"modulo_table_list\" >\n";        $html .= "	<tr align=\"center\" class=\"modulo_list_claro\">\n";        $html .= "		<td class=\"normal_10AN\">";        $html .= "			COTIZACION #" . $Cotizacion['pedido_cliente_id_tmp'];        $html .= "		</td>";        $html .= "	</tr>";        $html .= "	<tr align=\"center\">\n";        $html .= "		<td class=\"normal_10AN\">";        $html .= "			" . $Cotizacion['razon_social'] . "";        $html .= "		</td>";        $html .= "	</tr>";        $html .= "	<tr align=\"center\" class=\"modulo_list_claro\">\n";        $html .= "		<td class=\"normal_10AN\">";        $html .= "			" . $Cotizacion['tipo_id_empresa'] . " " . $Cotizacion['id'] . "-" . $Cotizacion['digito_verificacion'];        $html .= "		</td>";        $html .= "	</tr>";        $html .= "</table>";        $html .= "<br>";        $html .= "<form name=\"Formulario\" id=\"Formulario\" action=\"" . $action['Guardar'] . "\" method=\"post\">";        $html .= "<fieldset class=\"modulo_table_list\">";        $html .= "	<legend>DATOS DEL CLIENTE</legend>";        $html .= "		<table width=\"100%\" align=\"center\" class=\"modulo_table_list\">\n";        $html .= "			<tr class=\"formulacion_table_list\">\n";        $html .= "				<td colspan=\"4\">";        $html .= "				CLIENTE : " . $Tercero['tipo_id_tercero'] . "-" . $Tercero['tercero_id'] . ": " . $Tercero['nombre_tercero'] . " ";        $html .= "				</td>";        $html .= "			</tr>";        $html .= "			<tr class=\"modulo_table_list_title\">\n";        $html .= "				<td colspan=\"\" width=\"20%\">";        $html .= "				DIRECCION";        $html .= "				</td>";        $html .= "				<td colspan=\"\" width=\"30%\" class=\"modulo_list_claro\">";        $html .= "		 		" . $Tercero['direccion'] . " ";        $html .= "				</td>";        $html .= "				<td colspan=\"\" width=\"20%\">";        $html .= "				TELEFONO";        $html .= "				</td>";        $html .= "				<td colspan=\"\" width=\"30%\" class=\"modulo_list_claro\">";        $html .= "		 		" . $Tercero['telefono'] . " ";        $html .= "				</td>";        $html .= "			</tr>";        $html .= "			<tr class=\"modulo_table_list_title\">\n";        $html .= "				<td colspan=\"\" width=\"20%\">";        $html .= "				UBICACION";        $html .= "				</td>";        $html .= "				<td colspan=\"\" width=\"30%\" class=\"modulo_list_claro\" align=\"left\">";        $html .= "		 		" . $Cotizacion['ubicacion'] . " ";        $html .= "				</td>";        $html .= "				<td colspan=\"\" width=\"20%\">";        $html .= "				VENDEDOR";        $html .= "				</td>";        $html .= "				<td colspan=\"\" width=\"30%\" class=\"modulo_list_claro\" align=\"left\">";        $html .= "		 		" . $select_vend . " ";        $html .= "				</td>";        $html .= "			</tr>";        $html .= "			<tr class=\"modulo_table_list_title\">\n";        $html .= "				<td colspan=\"\" width=\"20%\">";        $html .= "				CONTRATO";        $html .= "				</td>";        $html .= "				<td colspan=\"3\" align=\"left\" width=\"30%\" class=\"modulo_list_claro\">";        $html .= "		 		" . $Tercero['tipo_contrato'] . " ";        $html .= "				</td>";        $html .= "			</tr>";        $html .= "			<tr class=\"modulo_table_list_title\">\n";        $html .= "				<td colspan=\"\" width=\"20%\">";        $html .= "				OBSERVACIONES";        $html .= "				</td>";        $html .= "				<td colspan=\"3\" align=\"left\" width=\"30%\" class=\"modulo_list_claro\">";        $html .= "		 			<TEXTAREA id=\"observacion\" name=\"observacion\" class=\"textarea\" style=\"width:100%\" onblur=\"xajax_guardar_observacion_tmp_cotizacion({$Cotizacion['pedido_cliente_id_tmp']}, document.getElementById('observacion').value)\">" . $Cotizacion['observaciones'] . "</TEXTAREA>";        $html .= "				</td>";        $html .= "			</tr>";        $html .= "		</table>";        $html .= "</fieldset>";        $html .= "</form>";        $html .= "<br>";        $html .= "<table width=\"100%\" align=\"center\" class=\"modulo_table_list\">\n";        $urlSubirArchivo = ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'Modificar_Cotizacion', array("pedido_cliente_id_tmp" => $Cotizacion['pedido_cliente_id_tmp'], "tipo_id_tercero" => $Tercero['tipo_id_tercero'], "tercero_id" => $Tercero['tercero_id'], "Eliminar" => "1"));        if ($error != "") {            $html .= "<tr align='center'>                        <td colspan='8'><center style='color:red;'>{$error}</center></td>                     </tr>";        }        if ($url != "") {            $html .= "<tr>                        <td><a href='{$url}' target='_blank' >Descargar plano de productos con error</a></td>                     </tr>";        }        $html .= "<tr class=\"modulo_table_list_title\">                        <td colspan=\"2\" class=\"formulacion_table_list\">SELECCIONAR ARCHIVO DE PRODUCTOS</td>                        <td align=\"center\" class=\"formulacion_table_list\" colspan=\"6\"  >                             <form id='formplanoarchivo' class='form' enctype='multipart/form-data' action='{$urlSubirArchivo}' method='post'>                                <input type='file' name='archivo_plano' >                                 <input type='hidden' name='contrato_id' value='{}' />                                <input type='submit' value='Subir Plano' />                            </form>                        </td>                  </tr>";        $html .= "	<tr class=\"modulo_table_list_title\" valign='middle'>\n";        $html .= "  	<td align=\"center\" class=\"formulacion_table_list\" colspan=\"8\">\n";        $html .= "		<input type=\"button\" value=\"INCLUIR PRODUCTOS A LA COTIZACION\" onclick=\"xajax_Buscar_ProductosInventario('" . $datos['empresa'] . "','" . $Cotizacion['pedido_cliente_id_tmp'] . "','" . $Tercero['contrato'] . "');\"  class=\"input-submit\">";        $html .= "  	</td>\n";        $html .= "	</tr>";        $html .= "	<tr class=\"modulo_table_list_title\">\n";        $html .= "  	<td align=\"center\" >\n";        $html .= "      <a title='CODIGO INTERNO DEL PRODUCTO'>CODIGO PRODUCTO</a>";        $html .= "  	</td>\n";        $html .= "      <td align=\"center\" >\n";        $html .= "      <a title='NOMBRE COMPLETO DEL PRODUCTO'>DESCRIPCION</a>";        $html .= "      </td>\n";        $html .= "      <td align=\"center\" >\n";        $html .= "      <a title='NUMERO DE UNIDADES COTIZADAS POR EL CLIENTE'>CANTIDAD<a>";        $html .= "      </td>\n";        $html .= "      <td align=\"center\" >\n";        $html .= "      <a title='PORCENTAJE DE IVA QUE APLICA EL PRODUCTO'>%IVA";        $html .= "      </td>\n";        $html .= "      <td align=\"center\" >\n";        $html .= "      <a title='VALOR UNITARIO'>V/U";        $html .= "      </td>\n";        $html .= "      <td align=\"center\" >\n";        $html .= "      <a title='VALOR TOTAL SIN IVA'>V/T (SIN IVA)";        $html .= "      </td>\n";        $html .= "      <td align=\"center\" >\n";        $html .= "      <a title='VALOR TOTAL SIN IVA'>V/T (CON IVA)";        $html .= "      </td>\n";        $html .= "      <td align=\"center\" width=\"3%\">\n";        $html .= "      <a title='ELIMINAR ITEM DE LA COTIZACION'>OP<a>";        $html .= "      </td>\n";        $html .= "	</tr>\n";        foreach ($ProductosCotizacion as $key => $valor) {            $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";            $html .= "						<td align=\"center\">" . $valor['codigo_producto'] . "</td>";            $html .= "						<td>" . $valor['descripcion'] . "</td>";            $html .= "						<td>" . FormatoValor($valor['numero_unidades'], 0) . "</b></td>";            $html .= "						<td>" . FormatoValor($valor['porc_iva'], 2) . "</b></td>";            $html .= "						<td>$" . FormatoValor($valor['valor_unitario'], 2) . "</b></td>";            $valor_total_producto = $valor['numero_unidades'] * $valor['valor_unitario'];            $valor_total_producto_iva = $valor['numero_unidades'] * $valor['valor_unitario_iva'];            $iva_total = $iva_total + $valor['iva'];            $subtotal = $subtotal + $valor_total_producto;            $html .= "						<td>$" . FormatoValor($valor_total_producto, 2) . "</b></td>";            $html .= "						<td>$" . FormatoValor($valor_total_producto_iva, 2) . "</b></td>";            $html .= "						<td>";            $html .= "						<center><a href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'Modificar_Cotizacion', array("pedido_cliente_id_tmp" => $Cotizacion['pedido_cliente_id_tmp'], "codigo_producto" => $valor['codigo_producto'], "tipo_id_tercero" => $Tercero['tipo_id_tercero'], "tercero_id" => $Tercero['tercero_id'], "Eliminar" => "1")) . "\" class=\"label_error\"  title=\"ELIMINAR ITEM DE LA COTIZACION\"><img src=\"" . GetThemePath() . "/images/delete2.gif\" border='0' ></a></center>\n";            $html .= "						</td>";            $html .= "                   </tr>\n";        }        $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";        $html .= "						<td colspan=\"5\">";        $html .= "						</td>";        $html .= "						<td class=\"normal_10AN\">";        $html .= "							IVA:";        $html .= "						</td>";        $html .= "						<td class=\"normal_10AN\">";        $html .= "							$" . FormatoValor($iva_total, 2);        $html .= "						</td>";        $html .= "                   </tr>\n";        $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";        $html .= "						<td colspan=\"5\">";        $html .= "						</td>";        $html .= "						<td class=\"normal_10AN\">";        $html .= "							SUBTOTAL:";        $html .= "						</td>";        $html .= "						<td class=\"normal_10AN\">";        $html .= "							$" . FormatoValor($subtotal, 2);        $html .= "						</td>";        $html .= "                   </tr>\n";        $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";        $html .= "						<td colspan=\"5\">";        $html .= "						</td>";        $html .= "						<td class=\"normal_10AN\">";        $html .= "							TOTAL:";        $html .= "						</td>";        $html .= "						<td class=\"normal_10AN\">";        $html .= "							$" . FormatoValor(($subtotal + $iva_total), 2);        $html .= "						</td>";        $html .= "                   </tr>\n";        $html .= "				</table>";        $html .= "<table align=\"center\" width=\"50%\">\n";        $html .= "  <tr>\n";        $html .= "    <td align=\"center\">\n";        $html .= "      <a href=\"" . $action['volver'] . "\"  class=\"label_error\">\n";        $html .= "        VOLVER\n";        $html .= "      </a>\n";        $html .= "    </td>\n";        $html .= "  </tr>\n";        $html .= "</table>\n";        $html .= $this->CrearVentana('860', 'COTIZACIONES');        $html .= ThemeCerrarTabla();        return $html;    }    /**     * Funcion donde se crea la Forma del Contrato a llenar       * @param array $datos vector que contiene la informacion de Los Proveedores     * @param array $action vector que contiene los link de la aplicacion     * @param array $datos_empresa vector que contiene la informacion de Empresa que contrata al proveedor     * @param string $fecha contiene la informacion de la fecha actual.     * @return string $html retorna la cadena con el codigo html de la pagina     */    function Listado_Pedidos($action, $datos, $Pedidos, $conteo, $pagina) {        $html = ThemeAbrirTabla(' PEDIDOS - CLIENTE ');        //Que solo aparezca Cuando NO hay un contrato activo y/o existente para ese tercero selecionado        $ctl = AutoCarga::factory("ClaseUtil");        $html .= $ctl->IsDate("-");        $html .= $ctl->AcceptDate("-");        $html .= $ctl->AcceptNum("-");        $html .= $ctl->LimpiarCampos();        $html .= $ctl->RollOverFilas();        $html .="<div align=\"center\" class=\"label_error\" id='error'></div> ";        $html .="<script >\n";        $html .= "  function max(e){  ";        $html .= "  tecla = (document.all) ? e.keyCode : e.which; ";        $html .= "  if (tecla==8) return true;";        $html .= "  if (tecla==13) return false;";        $html .= " }";        $html .= "</script>\n";        $html .= "<script>\n";        $html .= "	function AnularPedido(accion,pedido_cliente_id,temporal,estado) ";        $html .= "	{";        $html .= "		if(temporal!=\"\")";        $html .= "		{";        $html .= "		alert('EL PEDIDO '+pedido_cliente_id+' DEBE CERRARSE EN BODEGA PARA PODER SER ANULADO');";        $html .= "		}";        $html .= "		else";        $html .= "			{";        $html .= "				var x = confirm(accion+' EL PEDIDO #'+pedido_cliente_id+'?');";        $html .= "				if(x)";        $html .= "					xajax_AnularPedido(pedido_cliente_id,estado,accion);";        $html .= "				else";        $html .= "					return false;";        $html .= "			}";        $html .= "	}";        $html .= "</script>";        $html .= "<br>";        $html .= "<form name=\"Buscador\" id=\"Buscador\" action=\"" . $action['buscador'] . "\" method=\"post\">";        $html .= "<table  width=\"50%\" align=\"center\" border=\"0\" class=\"modulo_table_list\">\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"formulacion_table_list\">NOMBRE TERCERO</td>\n";        $html .= "      <td  class=\"formulacion_table_list\"><input name=\"buscador[nombre_tercero]\" id=\"buscador[nombre_tercero]\" class=\"input-text\" style=\"width:100%\"></td>\n";        $html .= "      <td  class=\"formulacion_table_list\"># PEDIDO</td>\n";        $html .= "      <td  class=\"formulacion_table_list\"><input name=\"buscador[pedido_cliente_id]\" id=\"buscador[pedido_cliente_id]\" class=\"input-text\" style=\"width:100%\"></td>\n";        $html .= "      <td  class=\"formulacion_table_list\"><input type=\"submit\" value=\"BUSCAR PEDIDO\" class=\"input-submit\"></td>\n";        $html .= "	</tr>";        $html .= "</table>";        $html .= "</form>";        $pgn = AutoCarga::factory("ClaseHTML");        $html .= "		" . $pgn->ObtenerPaginado($conteo, $pagina, $action['paginador']);        $html .= "                  <table width=\"100%\" align=\"center\" class=\"modulo_table_list\">\n";        $html .= "                    <tr class=\"modulo_table_list_title\">\n";        $html .= "                      <td align=\"center\" width=\"2%\">\n";        $html .= "                        <a title='NUMERO DE PEDIDO'>#PEDIDO </a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='CLIENTE'>CLIENTE</a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='LOCALIZACION DEL CLIENTE'>UBICACION</a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='TELEFONO'>TELEFONO</a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='FECHA CREACION'>FECHA REGISTRO";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='FECHA FINAL'>VENDEDOR";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='MODIFICAR'>MOD<a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='ESTADO'>OP<a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='IMPRIMIR'>IMP<a>";        $html .= "                      </td>\n";        $html .= "                    </tr>\n";        $rpt = new GetReports();        foreach ($Pedidos as $key => $valor) {            $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";            $html .= "						<td align=\"center\">" . $valor['pedido_cliente_id'] . "</td>";            $html .= "						<td>" . $valor['tipo_id_tercero'] . " " . $valor['tercero_id'] . "-" . $valor['nombre_tercero'] . "</b></td>";            $html .= "						<td>" . $valor['direccion'] . "-" . $valor['ubicacion'] . "</td>";            $html .= "						<td>" . $valor['telefono'] . "</td>";            $html .= "						<td>" . $valor['fecha_registro'] . "</td>";            $html .= "						<td>" . $valor['tipo_id_vendedor'] . "-" . $valor['vendedor_id'] . ": " . $valor['nombre'] . "</td>";            $funcion = "";            $url = "#";            if ($valor['estado'] == '1') {                $html .= "						<td>";                $html .= "						<center><a class=\"label_error\" href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'Modificar_Pedido', array("pedido_cliente_id" => $valor['pedido_cliente_id'])) . "\"  title=\"MODIFICAR PEDIDO\"><img src=\"" . GetThemePath() . "/images/modificar.png\" border='0'></a></center>\n";                $html .= "						</td>";                $html .= "						<td>";                if ($valor['accion'] == 'ANULAR') {                    $onclick = " onClick=\"AnularPedido('" . $valor['accion'] . "','" . $valor['pedido_cliente_id'] . "','" . $valor['temporal'] . "','2');\"";                    $url = "#";                } else {                    $onclick = " onClick=\"AnularPedido('" . $valor['accion'] . "','" . $valor['pedido_cliente_id'] . "','" . $valor['temporal'] . "','0');\"";                    /* $onclick=" onClick=\"return confirm('".$valor['accion']." EL PEDIDO #".$valor['pedido_cliente_id']."');\""; */                    $url = "#";                }                $html .= "						<center><a " . $onclick . " href=\"" . $url . "\" class=\"label_error\"  title=\"PEDIDO ACTIVO: CAMBIAR ESTADO A " . $valor['accion'] . "\"><img src=\"" . GetThemePath() . "/images/pactivo.png\" border='0' ></a></center>\n";                $html .= "						</td>";            } else            if ($valor['estado'] == '0') {                $html .= "						<td>";                $url = ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'Pedidos', array("pedido_cliente_id" => $valor['pedido_cliente_id'], "ACTIVAR" => "1"));                $html .= "							<a class=\"label_error\" href=\"" . $url . "\"  title=\"PEDIDO ACTIVO: CAMBIAR ESTADO A ACTIVO\">";                $html .= "							<center><img title=\"PEDIDO INACTIVO\" src=\"" . GetThemePath() . "/images/pinactivo.png\" border='0' ></center>\n";                $html .= "							</a>";                $html .= "						</td>";                $html .= "						<td>";                $html .= "						<center></center>\n";                $html .= "						</td>";            } else            if ($valor['estado'] == '2') {                $html .= "						<td>";                $html .= "							<center><img title=\"PEDIDO ANULADO\" src=\"" . GetThemePath() . "/images/panulado.png\" border='0' ></center>\n";                $html .= "						</td>";                $html .= "						<td>";                $html .= "						<center></center>\n";                $html .= "						</td>";            } else            if ($valor['estado'] == '3') {                $html .= "						<td>";                $html .= "							<center><a href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'Modificar_Pedido', array("pedido_cliente_id" => $valor['pedido_cliente_id'])) . "\"><img title=\"PEDIDO DESPACHADO COMPLETAMENTE\" src=\"" . GetThemePath() . "/images/ok.png\" border='0' ></center></a>\n";                $html .= "						</td>";                $html .= "						<td>";                $html .= "						<center></center>\n";                $html .= "						</td>";            }            $html .= "						<td>";            $html .= $rpt->GetJavaReport('app', 'ContratacionProductosCliente', 'reporte_pedido_cliente', $valor, array('rpt_name' => '', 'rpt_dir' => 'cache', 'rpt_rewrite' => TRUE));            $fnc = $rpt->GetJavaFunction();            $html .= "<center>\n";            $html .= "	<a title=\"IMPRIMIR\" class=\"label_error\" href=\"javascript:" . $fnc . "\">\n";            $html .= "	  <image title=\"IMPRIMIR PEDIDO\" src=\"" . GetThemePath() . "/images/imprimir.png\" border=\"0\">\n";            $html .= "  </a>\n";            $html .= "</center>\n";            $html .= "						</td>";            $html .= "                   </tr>\n";        }        $html .= "				</table>";        $html .= "<br>";        $html .= "<table align=\"center\" width=\"50%\">\n";        $html .= "  <tr>\n";        $html .= "    <td align=\"center\">\n";        $html .= "      <a href=\"" . $action['volver'] . "\"  class=\"label_error\">\n";        $html .= "        VOLVER\n";        $html .= "      </a>\n";        $html .= "    </td>\n";        $html .= "  </tr>\n";        $html .= "</table>\n";        $html .= ThemeCerrarTabla();        $html .= $this->CrearVentana(800, "PEDIDOS CLIENTE");        return $html;    }    /**     * Funcion de consulta de pedidos de clientes     * @param array $datos vector que contiene la informacion de Los Proveedores     * @param array $action vector que contiene los link de la aplicacion     * @param array $datos_empresa vector que contiene la informacion de Empresa que contrata al proveedor     * @param string $fecha contiene la informacion de la fecha actual.     * @return string $html retorna la cadena con el codigo html de la pagina     */    function Listado_ConsulPedidos($action, $pedidoCli, $datos, $Pedidos, $conteo, $pagina) {        $html = ThemeAbrirTabla('CONSULTA PEDIDOS DE CLIENTES');        //Que solo aparezca Cuando NO hay un contrato activo y/o existente para ese tercero selecionado        $ctl = AutoCarga::factory("ClaseUtil");        $html .= $ctl->IsDate("-");        $html .= $ctl->AcceptDate("-");        $html .= $ctl->AcceptNum("-");        $html .= $ctl->LimpiarCampos();        $html .= $ctl->RollOverFilas();        $html .="<div align=\"center\" class=\"label_error\" id='error'></div> ";        $html .="<script >\n";        $html .= "  function max(e){  ";        $html .= "  tecla = (document.all) ? e.keyCode : e.which; ";        $html .= "  if (tecla==8) return true;";        $html .= "  if (tecla==13) return false;";        $html .= " }";        $html .= "</script>\n";        $html .= "<script>\n";        $html .= "	function AnularPedido(accion,pedido_cliente_id,temporal,estado) ";        $html .= "	{";        $html .= "		if(temporal!=\"\")";        $html .= "		{";        $html .= "		alert('EL PEDIDO '+pedido_cliente_id+' DEBE CERRARSE EN BODEGA PARA PODER SER ANULADO');";        $html .= "		}";        $html .= "		else";        $html .= "			{";        $html .= "				var x = confirm(accion+' EL PEDIDO #'+pedido_cliente_id+'?');";        $html .= "				if(x)";        $html .= "					xajax_AnularPedido(pedido_cliente_id,estado,accion);";        $html .= "				else";        $html .= "					return false;";        $html .= "			}";        $html .= "	}";        $html .= "</script>";        $html .= "<br>";        $html .= "<form name=\"Buscador\" id=\"Buscador\" action=\"" . $action['buscador'] . "\" method=\"post\">";        $html .= "<table  width=\"50%\" align=\"center\" border=\"0\" class=\"modulo_table_list\">\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"formulacion_table_list\">NOMBRE TERCERO</td>\n";        $html .= "      <td  class=\"formulacion_table_list\"><input name=\"buscador[nombre_tercero]\" id=\"buscador[nombre_tercero]\" class=\"input-text\" style=\"width:100%\"></td>\n";        $html .= "      <td  class=\"formulacion_table_list\"># PEDIDO</td>\n";        $html .= "      <td  class=\"formulacion_table_list\"><input name=\"buscador[pedido_cliente_id]\" id=\"buscador[pedido_cliente_id]\" class=\"input-text\" value=\"\" style=\"width:100%\"></td>\n";        $html .= "      <td  class=\"formulacion_table_list\"><input type=\"submit\" value=\"BUSCAR PEDIDO\" class=\"input-submit\"></td>\n";        $html .= "	</tr>";        $html .= "</table>";        $html .= "</form>";        $pgn = AutoCarga::factory("ClaseHTML");        $html .= "		" . $pgn->ObtenerPaginado($conteo, $pagina, $action['paginador']);        $html .= "                  <table width=\"100%\" align=\"center\" class=\"modulo_table_list\">\n";        $reporGral = ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'MostrarPedidosGral') . "&pedido=" . $pedidoCli;        if (!empty($Pedidos)) {            $html .= "                    <tr>\n";            $html .= "                      <td colspan=\"2\">\n";            $html .= "                      <a href=\"" . $reporGral . "\" target=\"_new\" class=\"label_error\"  title=\"IMPRIMIR LISTADO\"><img src=\"" . GetThemePath() . "/images/imprimir.png\" border='0' >&nbsp;Impresi&oacute;n gral</a>\n";            $html .= "                      </td>\n";            $html .= "                    </tr>\n";        }        $html .= "                    <tr class=\"modulo_table_list_title\">\n";        $html .= "                      <td align=\"center\" width=\"2%\">\n";        $html .= "                        <a title='NUMERO DE PEDIDO'>#PEDIDO </a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='CLIENTE'>CLIENTE</a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='LOCALIZACION DEL CLIENTE'>UBICACION</a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='TELEFONO'>TELEFONO</a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='FECHA CREACION'>FECHA REGISTRO";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title=''>VENDEDOR";        $html .= "                      </td>\n";        // $html .= "                      <td align=\"center\" >\n";        // $html .= "                        <a title='MODIFICAR'>MOD<a>";        // $html .= "                      </td>\n";        // $html .= "                      <td align=\"center\" >\n";        // $html .= "                        <a title='ESTADO'>OP<a>";        // $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='IMPRIMIR'>IMP<a>";        $html .= "                      </td>\n";        $html .= "                    </tr>\n";        $rpt = new GetReports();        foreach ($Pedidos as $key => $valor) {            $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";            $html .= "						<td align=\"center\">" . $valor['pedido_cliente_id'] . "</td>";            $html .= "						<td>" . $valor['tipo_id_tercero'] . " " . $valor['tercero_id'] . "-" . $valor['nombre_tercero'] . "</b></td>";            $html .= "						<td>" . $valor['direccion'] . "-" . $valor['ubicacion'] . "</td>";            $html .= "						<td>" . $valor['telefono'] . "</td>";            $html .= "						<td>" . $valor['fecha_registro'] . "</td>";            $html .= "						<td>" . $valor['tipo_id_vendedor'] . "-" . $valor['vendedor_id'] . ": " . $valor['nombre'] . "</td>";            $funcion = "";            $url = "#";            // if($valor['estado']=='1')            // {            // $html .= "						<td>";            // $html .= "						<center><a class=\"label_error\" href=\"".ModuloGetURL('app','ContratacionProductosCliente','controller','Modificar_Pedido',array("pedido_cliente_id"=>$valor['pedido_cliente_id']))."\"  title=\"MODIFICAR PEDIDO\"><img src=\"".GetThemePath()."/images/modificar.png\" border='0'></a></center>\n";            // $html .= "						</td>";            // $html .= "						<td>";            // if($valor['accion']=='ANULAR')            // {            // $onclick=" onClick=\"AnularPedido('".$valor['accion']."','".$valor['pedido_cliente_id']."','".$valor['temporal']."','2');\"";            // $url = "#";            // }            // else            // {            // $onclick=" onClick=\"AnularPedido('".$valor['accion']."','".$valor['pedido_cliente_id']."','".$valor['temporal']."','0');\"";            // $url = "#";            // }            // $html .= "						<center><a ".$onclick." href=\"".$url."\" class=\"label_error\"  title=\"PEDIDO ACTIVO: CAMBIAR ESTADO A ".$valor['accion']."\"><img src=\"".GetThemePath()."/images/pactivo.png\" border='0' ></a></center>\n";            // $html .= "						</td>";            // }            // else            // if($valor['estado']=='0')            // {            // $html .= "						<td>";            // $url = ModuloGetURL('app','ContratacionProductosCliente','controller','Pedidos',array("pedido_cliente_id"=>$valor['pedido_cliente_id'],"ACTIVAR"=>"1"));	            // $html .= "							<a class=\"label_error\" href=\"".$url."\"  title=\"PEDIDO ACTIVO: CAMBIAR ESTADO A ACTIVO\">";            // $html .= "							<center><img title=\"PEDIDO INACTIVO\" src=\"".GetThemePath()."/images/pinactivo.png\" border='0' ></center>\n";            // $html .= "							</a>";            // $html .= "						</td>";            // $html .= "						<td>";            // $html .= "						<center></center>\n";            // $html .= "						</td>";            // }            // else            // if($valor['estado']=='2')            // {            // $html .= "						<td>";            // $html .= "							<center><img title=\"PEDIDO ANULADO\" src=\"".GetThemePath()."/images/panulado.png\" border='0' ></center>\n";            // $html .= "						</td>";            // $html .= "						<td>";            // $html .= "						<center></center>\n";            // $html .= "						</td>";            // }else            // if($valor['estado']=='3')            // {            // $html .= "						<td>";            // $html .= "							<center><a href=\"".ModuloGetURL('app','ContratacionProductosCliente','controller','Modificar_Pedido',array("pedido_cliente_id"=>$valor['pedido_cliente_id']))."\"><img title=\"PEDIDO DESPACHADO COMPLETAMENTE\" src=\"".GetThemePath()."/images/ok.png\" border='0' ></center></a>\n";            // $html .= "						</td>";            // $html .= "						<td>";            // $html .= "						<center></center>\n";            // $html .= "						</td>";            // }            $html .= "						<td>";            $html .= $rpt->GetJavaReport('app', 'ContratacionProductosCliente', 'reporte_pedido2_cliente', $valor, array('rpt_name' => '', 'rpt_dir' => 'cache', 'rpt_rewrite' => TRUE));            $fnc = $rpt->GetJavaFunction();            $html .= "<center>\n";            $html .= "	<a title=\"IMPRIMIR\" class=\"label_error\" href=\"javascript:" . $fnc . "\">\n";            $html .= "	  <image title=\"IMPRIMIR PEDIDO\" src=\"" . GetThemePath() . "/images/imprimir.png\" border=\"0\">\n";            $html .= "  </a>\n";            $html .= "</center>\n";            $html .= "						</td>";            $html .= "                   </tr>\n";        }        $html .= "				</table>";        $html .= "<br>";        $html .= "<table align=\"center\" width=\"50%\">\n";        $html .= "  <tr>\n";        $html .= "    <td align=\"center\">\n";        $html .= "      <a href=\"" . $action['volver'] . "\"  class=\"label_error\">\n";        $html .= "        VOLVER\n";        $html .= "      </a>\n";        $html .= "    </td>\n";        $html .= "  </tr>\n";        $html .= "</table>\n";        $html .= ThemeCerrarTabla();        $html .= $this->CrearVentana(800, "PEDIDOS CLIENTE");        return $html;    }    function FormaPedidos($action, $Pedido, $ProductosPedido, $datos, $Tercero) {        $html = ThemeAbrirTabla(' PEDIDO CLIENTE: ' . $Pedido['nombre_tercero'] . ' ');        //Que solo aparezca Cuando NO hay un contrato activo y/o existente para ese tercero selecionado        $ctl = AutoCarga::factory("ClaseUtil");        $html .= "<script>";        $html .= "	function Paginador(Formulario,offset)";        $html .= "	{";        $html .= "	xajax_Buscar_Productos_d(Formulario,offset);";        $html .= "	}";        $html .= "</script>";        $html .= "<script>";        $html .= "	function ValidarCantidad_Checkbox(campo_precio_pactado,costo_ultima_compra,checkbox_id)\n";        $html .= "	{\n";        $html .= "	if(parseFloat(document.getElementById(campo_precio_pactado).value)<parseFloat(costo_ultima_compra))";        $html .= "			document.getElementById(checkbox_id).checked=0;\n";        $html .= "		else{\n";        $html .= "			document.getElementById(checkbox_id).checked=1;\n";        $html .= "			}\n";        $html .= "	}\n";        $html .= "	function ValidarCantidad(campo,valor,cant_sol,capa)\n";        $html .= "	{\n";        $html .= "		document.getElementById(campo).style.background='';\n";        $html .= "		document.getElementById('error').innerHTML='';\n";        $html .= "		if(isNaN(valor) || parseFloat(valor)<=0 || valor=='')\n";        $html .= "		{\n";        $html .= "			document.getElementById(campo).value='';\n";        $html .= "			document.getElementById(campo).style.background='#ff9595';\n";        $html .= "			document.getElementById('error').innerHTML='<center>CANTIDAD NO VALIDA</center>';\n";        $html .= "			document.getElementById(capa).disabled=\"true\";\n";        $html .= "			document.getElementById(capa).checked=0;\n"; /* || parseFloat(valor) < parseFloat(cant_sol) */        $html .= "		}\n";        $html .= "		else{\n";        $html .= "			document.getElementById(capa).style.display=\"\";\n";        $html .= "			document.getElementById(capa).disabled=\"\";\n";        $html .= "		}\n";        $html .= "	}\n";        $html .= "	function ValidarCantidad_(campo,valor,cant_sol,capa)\n";        $html .= "	{\n";        $html .= "		document.getElementById(campo).style.background='';\n";        $html .= "		document.getElementById('error').innerHTML='';\n";        $html .= "			document.getElementById(capa).checked=0;\n"; /* || parseFloat(valor) < parseFloat(cant_sol) */        $html .= "		if(isNaN(valor) || parseFloat(valor)<0 || valor=='')\n";        $html .= "		{\n";        $html .= "			document.getElementById(campo).value='';\n";        $html .= "			document.getElementById(campo).style.background='#ff9595';\n";        $html .= "			document.getElementById('error').innerHTML='<center>CANTIDAD NO VALIDA</center>';\n";        $html .= "			document.getElementById(capa).disabled=\"true\";\n";        $html .= "			document.getElementById(capa).checked=0;\n"; /* || parseFloat(valor) < parseFloat(cant_sol) */        $html .= "		}\n";        $html .= "		else{\n";        $html .= "			document.getElementById(capa).style.display=\"\";\n";        $html .= "			document.getElementById(capa).disabled=\"\";\n";        $html .= "		}\n";        $html .= "	}\n";        $html .= "	function ValidarValores(campo_1,precio_compra,capa)\n";        $html .= "	{\n";        $html .= "		if(parseFloat(document.getElementById(campo_1).value) < parseFloat(precio_compra))\n";        $html .= "		{\n";        $html .= "			document.getElementById('error_').innerHTML='<center>EL PRECIO NO DEBE SER MENOR AL DE COMPRA: REVISAR CANTIDAD..</center>';\n";        $html .= "			document.getElementById(capa).disabled=\"true\";\n";        $html .= "			document.getElementById(capa).checked=0;\n";        $html .= "		}\n";        $html .= "		else{\n";        $html .= "			document.getElementById(capa).style.display=\"\";\n";        $html .= "			document.getElementById(capa).disabled=\"\";\n";        $html .= "		}\n";        $html .= "	}\n";        $html .= "	function ValidarValores_(campo_1,precio_compra,capa)\n";        $html .= "	{\n";        $html .= "		if(parseFloat(document.getElementById(campo_1).value) < parseFloat(precio_compra))\n";        $html .= "		{\n";        $html .= "			document.getElementById('error_1').innerHTML='<center>LA CANTIDAD NO PUEDE SER MENOR A LA DESPACHADA: REVISAR CANTIDAD NUEVA</center>';\n";        $html .= "			document.getElementById(capa).disabled=\"true\";\n";        $html .= "			document.getElementById(capa).checked=0;\n";        $html .= "		}\n";        $html .= "		else{\n";        $html .= "			document.getElementById(capa).style.display=\"\";\n";        $html .= "			document.getElementById(capa).disabled=\"\";\n";        $html .= "		}\n";        $html .= "	}\n";        $html .= "</script>";        $html .= $ctl->IsDate("-");        $html .= $ctl->AcceptDate("-");        $html .= $ctl->AcceptNum("-");        $html .= $ctl->LimpiarCampos();        $html .= $ctl->RollOverFilas();        $html .= "<table width=\"50%\" align=\"center\" class=\"modulo_table_list\" >\n";        $html .= "	<tr align=\"center\" class=\"modulo_list_claro\">\n";        $html .= "		<td class=\"normal_10AN\">";        $html .= "			PEDIDO #" . $Pedido['pedido_cliente_id'];        $html .= "		</td>";        $html .= "	</tr>";        $html .= "	<tr align=\"center\">\n";        $html .= "		<td class=\"normal_10AN\">";        $html .= "			" . $Pedido['razon_social'] . "";        $html .= "		</td>";        $html .= "	</tr>";        $html .= "	<tr align=\"center\" class=\"modulo_list_claro\">\n";        $html .= "		<td class=\"normal_10AN\">";        $html .= "			" . $Pedido['tipo_id_empresa'] . " " . $Pedido['id'] . "-" . $Pedido['digito_verificacion'];        $html .= "		</td>";        $html .= "	</tr>";        $html .= "</table>";        $html .= "<br>";        $html .= "<form name=\"Formulario\" id=\"Formulario\" action=\"" . $action['Guardar'] . "\" method=\"post\">";        $html .= "<fieldset class=\"modulo_table_list\">";        $html .= "	<legend>DATOS DEL CLIENTE</legend>";        $html .= "		<table width=\"100%\" align=\"center\" class=\"modulo_table_list\">\n";        $html .= "			<tr class=\"formulacion_table_list\">\n";        $html .= "				<td colspan=\"4\">";        $html .= "				CLIENTE : " . $Pedido['tipo_id_tercero'] . "-" . $Pedido['tercero_id'] . ": " . $Pedido['nombre_tercero'] . " ";        $html .= "				</td>";        $html .= "			</tr>";        $html .= "			<tr class=\"modulo_table_list_title\">\n";        $html .= "				<td colspan=\"\" width=\"20%\">";        $html .= "				DIRECCION";        $html .= "				</td>";        $html .= "				<td colspan=\"\" width=\"30%\" class=\"modulo_list_claro\">";        $html .= "		 		" . $Pedido['direccion'] . " ";        $html .= "				</td>";        $html .= "				<td colspan=\"\" width=\"20%\">";        $html .= "				TELEFONO";        $html .= "				</td>";        $html .= "				<td colspan=\"\" width=\"30%\" class=\"modulo_list_claro\">";        $html .= "		 		" . $Pedido['telefono'] . " ";        $html .= "				</td>";        $html .= "			</tr>";        $html .= "			<tr class=\"modulo_table_list_title\">\n";        $html .= "				<td colspan=\"\" width=\"20%\">";        $html .= "				UBICACION";        $html .= "				</td>";        $html .= "				<td colspan=\"\" width=\"30%\" class=\"modulo_list_claro\" align=\"left\">";        $html .= "		 		" . $Pedido['ubicacion'] . " ";        $html .= "				</td>";        $html .= "				<td colspan=\"\" width=\"20%\">";        $html .= "				VENDEDOR";        $html .= "				</td>";        $html .= "				<td colspan=\"\" width=\"30%\" class=\"modulo_list_claro\" align=\"left\">";        $html .= "		 		" . $Pedido['tipo_id_tercero'] . "-" . $Pedido['tercero_id'] . ": " . $Pedido['nombre'] . " ";        $html .= "				</td>";        $html .= "			</tr>";        $html .= "			<tr class=\"modulo_table_list_title\">\n";        $html .= "				<td colspan=\"\" width=\"20%\">";        $html .= "				CONTRATO";        $html .= "				</td>";        $html .= "				<td colspan=\"3\" align=\"left\" width=\"30%\" class=\"modulo_list_claro\">";        $html .= "		 		" . $Tercero['tipo_contrato'] . " ";        $html .= "				</td>";        $html .= "			</tr>";        $html .= "			<tr class=\"modulo_table_list_title\">\n";        $html .= "				<td colspan=\"\" width=\"20%\">";        $html .= "				OBSERVACIONES";        $html .= "				</td>";        $html .= "				<td colspan=\"2\" align=\"left\" width=\"30%\" class=\"modulo_list_claro\">";        $html .= "		 			<TEXTAREA id=\"observacion\" name=\"observacion\" class=\"textarea\" style=\"width:100%\">" . $Pedido['observacion'] . "</TEXTAREA>";        $html .= "				</td>";        $html .= "				<td align=\"left\" width=\"30%\" class=\"modulo_list_claro\">";        $html .= "					<input type=\"submit\" id=\"\" class=\"input-submit\" value=\"GUARDAR OBSERVACION\"> ";        $html .= "					<input type=\"hidden\" value=\"1\" name=\"OBSERVACION_\" id=\"OBSERVACION_\">";        $html .= "					<input type=\"hidden\" value=\"" . $Pedido['pedido_cliente_id'] . "\" name=\"pedido_cliente_id\" id=\"pedido_cliente_id\">";        $html .= "				</td>";        $html .= "			</tr>";        $html .= "		</table>";        $html .= "</fieldset>";        $html .= "</form>";        $html .= "<br>";        $html .= "<center><div id=\"error\" class=\"label_error\"></div></center>";        $html .= "<center><div id=\"error_1\" class=\"label_error\"></div></center>";        $html .= "<form id=\"Formulario_Pedidos\" name=\"Formulario_Pedidos\" action=\"" . $action['modificar'] . "\" method=\"post\">";        $html .= "<table width=\"100%\" align=\"center\" class=\"modulo_table_list\">\n";        $html .= "	<tr class=\"modulo_table_list_title\">\n";        $html .= "  	<td align=\"center\" class=\"formulacion_table_list\" colspan=\"11\">\n";        if ($Pedido['estado'] != '3')            $html .= "		<input type=\"button\" value=\"INCLUIR PRODUCTOS AL PEDIDO\" onclick=\"xajax_Buscar_Productos('" . $datos['empresa'] . "','" . $Pedido['pedido_cliente_id'] . "','" . $Tercero['contrato'] . "');\"  class=\"input-submit\">";        $html .= "  	</td>\n";        $html .= "	</tr>";        $html .= "	<tr class=\"modulo_table_list_title\">\n";        $html .= "  	<td align=\"center\" >\n";        $html .= "      <a title='CODIGO INTERNO DEL PRODUCTO'>CODIGO PRODUCTO</a>";        $html .= "  	</td>\n";        $html .= "      <td align=\"center\" >\n";        $html .= "      <a title='NOMBRE COMPLETO DEL PRODUCTO'>DESCRIPCION</a>";        $html .= "      </td>\n";        $html .= "      <td align=\"center\" >\n";        $html .= "      <a title='NUMERO DE UNIDADES PEDIDAS POR EL CLIENTE'>CANTIDAD<a>";        $html .= "      </td>\n";        $html .= "      <td align=\"center\" >\n";        $html .= "      <a title='NUMERO DE UNIDADES DESPACHADAS AL CLIENTE'>CANT.DESP<a>";        $html .= "      </td>\n";        $html .= "      <td align=\"center\" >\n";        $html .= "      <a title='CANTIDADES NUEVAS'>CANT.NUEVA<a>";        $html .= "      </td>\n";        $html .= "      <td align=\"center\" >\n";        $html .= "      <a title='PORCENTAJE DE IVA QUE APLICA EL PRODUCTO'>%IVA";        $html .= "      </td>\n";        $html .= "      <td align=\"center\" >\n";        $html .= "      <a title='VALOR UNITARIO'>V/U";        $html .= "      </td>\n";        $html .= "      <td align=\"center\" >\n";        $html .= "      <a title='VALOR TOTAL SIN IVA'>V/T (SIN IVA)";        $html .= "      </td>\n";        $html .= "      <td align=\"center\" >\n";        $html .= "      <a title='VALOR TOTAL SIN IVA'>V/T (CON IVA)";        $html .= "      </td>\n";        $html .= "      <td align=\"center\" width=\"3%\">\n";        $html .= "      <a title='ELIMINAR ITEM DE LA COTIZACION'>OP<a>";        $html .= "      </td>\n";        $html .= "      <td align=\"center\" width=\"3%\">\n";        $html .= "      <a title='SELECCIONAR'>SEL<a>";        $html .= "      </td>\n";        $html .= "	</tr>\n";        $i = 0;        foreach ($ProductosPedido as $key => $valor) {            $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";            $html .= "						<td align=\"center\">" . $valor['codigo_producto'] . "</td>";            $html .= "						<td>" . $valor['descripcion'] . "</td>";            $html .= "						<td>" . FormatoValor($valor['numero_unidades'], 0) . "</b></td>";            $html .= "						<td>" . FormatoValor($valor['cantidad_despachada'], 0) . "</b></td>";            $html .= "						<td>";            $disabled = "  ";            if ($valor['total'] == '0') {                $disabled = "disabled";            }            $html .= "							<input " . $disabled . " onkeyup=\"ValidarCantidad_('cantidad_nueva" . $i . "',this.value,'0','check_" . $i . "');\" type=\"text\" class=\"input-text\" style=\"width:100%\" name=\"cantidad_nueva" . $i . "\" id=\"cantidad_nueva" . $i . "\" onkeypress=\"return acceptNum(event)\">";            $html .= "						</td>";            $html .= "						<td>" . FormatoValor($valor['porc_iva'], 2) . "</b></td>";            $html .= "						<td>$" . FormatoValor($valor['valor_unitario'], 2) . "</b></td>";            $valor_total_producto = $valor['numero_unidades'] * $valor['valor_unitario'];            $valor_total_producto_iva = $valor['numero_unidades'] * $valor['valor_unitario_iva'];            $iva_total = $iva_total + $valor['iva'];            $subtotal = $subtotal + $valor_total_producto;            $html .= "						<td>$" . FormatoValor($valor_total_producto, 2) . "</b></td>";            $html .= "						<td>$" . FormatoValor($valor_total_producto_iva, 2) . "</b></td>";            if ($valor['numero_unidades'] == $valor['cantidad_despachada']) {                $html .= "						<td>";                $html .= "						<center><a class=\"label_error\"  title=\"PRODUCTO DESPACHADO TOTALMENTE\"><img src=\"" . GetThemePath() . "/images/ok.png\" border='0' ></a></center>\n";                $html .= "						</td>";            } else            if ($valor['cantidad_despachada'] > 0) {                $html .= "						<td>";                $html .= "						<center><a class=\"label_error\"  title=\"PRODUCTO DESPACHADO PARCIALMENTE\"><img src=\"" . GetThemePath() . "/images/alarma.gif\" border='0' ></a></center>\n";                $html .= "						</td>";            } else {                $html .= "						<td>";                $html .= "						<center><a  onClick=\"return confirm('DESEA ELIMINAR DEL PEDIDO, EL PRODUCTO: " . $valor['descripcion'] . "');\" href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'Modificar_Pedido', array("pedido_cliente_id" => $Pedido['pedido_cliente_id'], "codigo_producto" => $valor['codigo_producto'], "Eliminar" => "1")) . "\" class=\"label_error\"  title=\"ELIMINAR ITEM DE LA COTIZACION\"><img src=\"" . GetThemePath() . "/images/delete2.gif\" border='0' ></a></center>\n";                $html .= "						</td>";            }            $html .= "						<td>";            $html .= "						<input disabled type=\"checkbox\" name=\"check_" . $i . "\" id=\"check_" . $i . "\" value=\"" . $valor['codigo_producto'] . "\" class=\"input-checkbox\" onclick=\"ValidarValores_('cantidad_nueva" . $i . "','" . $valor['cantidad_despachada'] . "','check_" . $i . "');\"> ";            $html .= "						</td>";            $html .= "                   </tr>\n";            $i++;        }        $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";        $html .= "						<td colspan=\"8\">";        $html .= "						</td>";        $html .= "						<td class=\"normal_10AN\" colspan=\"3\">";        $html .= "							<input type=\"hidden\" value=\"1\" name=\"MODIFICAR\" id=\"MODIFICAR\">";        $html .= "							<input type=\"hidden\" value=\"" . $i . "\" name=\"cantidad_registros\" id=\"cantidad_registros\">";        $html .= "							<input type=\"hidden\" value=\"" . $Pedido['pedido_cliente_id'] . "\" name=\"pedido_cliente_id\" id=\"pedido_cliente_id\">";        $html .= "							<input type=\"submit\" value=\"MODIFICAR PEDIDO\" style=\"width:100%\" class=\"input-submit\">";        $html .= "						</td>";        $html .= "                   </tr>\n";        $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";        $html .= "						<td colspan=\"7\">";        $html .= "						</td>";        $html .= "						<td class=\"normal_10AN\">";        $html .= "							IVA:";        $html .= "						</td>";        $html .= "						<td class=\"normal_10AN\">";        $html .= "							$" . FormatoValor($iva_total, 2);        $html .= "						</td>";        $html .= "                   </tr>\n";        $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";        $html .= "						<td colspan=\"7\">";        $html .= "						</td>";        $html .= "						<td class=\"normal_10AN\">";        $html .= "							SUBTOTAL:";        $html .= "						</td>";        $html .= "						<td class=\"normal_10AN\">";        $html .= "							$" . FormatoValor($subtotal, 2);        $html .= "						</td>";        $html .= "                   </tr>\n";        $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";        $html .= "						<td colspan=\"7\">";        $html .= "						</td>";        $html .= "						<td class=\"normal_10AN\">";        $html .= "							TOTAL:";        $html .= "						</td>";        $html .= "						<td class=\"normal_10AN\">";        $html .= "							$" . FormatoValor(($subtotal + $iva_total), 2);        $html .= "						</td>";        $html .= "                   </tr>\n";        $html .= "	</table>";        $html .= "</form>";        $html .= "<table align=\"center\" width=\"50%\">\n";        $html .= "  <tr>\n";        $html .= "    <td align=\"center\">\n";        $html .= "      <a href=\"" . $action['volver'] . "\"  class=\"label_error\">\n";        $html .= "        VOLVER\n";        $html .= "      </a>\n";        $html .= "    </td>\n";        $html .= "  </tr>\n";        $html .= "</table>\n";        $html .= $this->CrearVentana('900', 'PEDIDOS');        $html .= ThemeCerrarTabla();        return $html;    }    /**     * Funcion donde se crea una Forma con una Ventana con capas para mostrar informacion     * en pantalla     * @param array $action vector que contiene los link de la aplicacion           * @param int $tmn Tamaï¿½o que tendra la ventana     * @return string     */    function CrearVentana($tmn, $Nombre) {        $html .= "<script>\n";        $html .= "  var contenedor = 'Contenedor';\n";        $html .= "  var titulo = 'titulo';\n";        $html .= "  var hiZ = 4;\n";        $html .= "  function OcultarSpan()\n";        $html .= "  { \n";        $html .= "    try\n";        $html .= "    {\n";        $html .= "      e = xGetElementById('Contenedor');\n";        $html .= "      e.style.display = \"none\";\n";        $html .= "    }\n";        $html .= "    catch(error){}\n";        $html .= "  }\n";        $html .= "  function MostrarSpan()\n";        $html .= "  { \n";        $html .= "    try\n";        $html .= "    {\n";        $html .= "      e = xGetElementById('Contenedor');\n";        $html .= "      e.style.display = \"\";\n";        $html .= "      Iniciar();\n";        $html .= "    }\n";        $html .= "    catch(error){alert(error)}\n";        $html .= "  }\n";        $html .= "  function MostrarTitle(Seccion)\n";        $html .= "  {\n";        $html .= "    xShow(Seccion);\n";        $html .= "  }\n";        $html .= "  function OcultarTitle(Seccion)\n";        $html .= "  {\n";        $html .= "    xHide(Seccion);\n";        $html .= "  }\n";        $html .= "  function Iniciar()\n";        $html .= "  {\n";        $html .= "    contenedor = 'Contenedor';\n";        $html .= "    titulo = 'titulo';\n";        $html .= "    ele = xGetElementById('Contenido');\n";        $html .= "    xResizeTo(ele," . $tmn . ", 'auto');\n";        $html .= "    ele = xGetElementById(contenedor);\n";        $html .= "    xResizeTo(ele," . $tmn . ", 'auto');\n";        $html .= "    xMoveTo(ele, xClientWidth()/4, xScrollTop()+20);\n";        $html .= "    ele = xGetElementById(titulo);\n";        $html .= "    xResizeTo(ele," . ($tmn - 20) . ", 20);\n";        $html .= "    xMoveTo(ele, 0, 0);\n";        $html .= "    xEnableDrag(ele, myOnDragStart, myOnDrag, myOnDragEnd);\n";        $html .= "    ele = xGetElementById('cerrar');\n";        $html .= "    xResizeTo(ele,20, 20);\n";        $html .= "    xMoveTo(ele," . ($tmn - 20) . ", 0);\n";        $html .= "  }\n";        $html .= "  function myOnDragStart(ele, mx, my)\n";        $html .= "  {\n";        $html .= "    window.status = '';\n";        $html .= "    if (ele.id == titulo) xZIndex(contenedor, hiZ++);\n";        $html .= "    else xZIndex(ele, hiZ++);\n";        $html .= "    ele.myTotalMX = 0;\n";        $html .= "    ele.myTotalMY = 0;\n";        $html .= "  }\n";        $html .= "  function myOnDrag(ele, mdx, mdy)\n";        $html .= "  {\n";        $html .= "    if (ele.id == titulo) {\n";        $html .= "      xMoveTo(contenedor, xLeft(contenedor) + mdx, xTop(contenedor) + mdy);\n";        $html .= "    }\n";        $html .= "    else {\n";        $html .= "      xMoveTo(ele, xLeft(ele) + mdx, xTop(ele) + mdy);\n";        $html .= "    }  \n";        $html .= "    ele.myTotalMX += mdx;\n";        $html .= "    ele.myTotalMY += mdy;\n";        $html .= "  }\n";        $html .= "  function myOnDragEnd(ele, mx, my)\n";        $html .= "  {\n";        $html .= "  }\n";        $html .= "</script>\n";        $html .= "<div id='Contenedor' class='d2Container' style=\"display:none;z-index:4\">\n";        $html .= "  <div id='titulo' class='draggable' style=\" text-transform: uppercase;text-align:center;\">" . $Nombre . "</div>\n";        $html .= "  <div id='cerrar' class='draggable'><a class=\"hcPaciente\" href=\"javascript:OcultarSpan()\" title=\"Cerrar\" style=\"font-size:9px;\">X</a></div><br><br>\n";        $html .= "  <div id='Contenido' class='d2Content'>\n";        $html .= "  </div>\n";        $html .= "</div>\n";        return $html;    }    /**     * Funcion donde se crea la Forma del Contrato a llenar       * @param array $datos vector que contiene la informacion de Los Proveedores     * @param array $action vector que contiene los link de la aplicacion     * @param array $datos_empresa vector que contiene la informacion de Empresa que contrata al proveedor     * @param string $fecha contiene la informacion de la fecha actual.     * @return string $html retorna la cadena con el codigo html de la pagina     */    function Listado_Vendedores($action, $datos, $vendedores, $tipos_ids_terceros, $conteo, $pagina) {        $html = ThemeAbrirTabla(' VENDEDORES ');        //Que solo aparezca Cuando NO hay un contrato activo y/o existente para ese tercero selecionado        $ctl = AutoCarga::factory("ClaseUtil");        $html .= $ctl->IsDate("-");        $html .= $ctl->AcceptDate("-");        $html .= $ctl->AcceptNum("-");        $html .= $ctl->LimpiarCampos();        $html .= $ctl->RollOverFilas();        $html .="<div align=\"center\" class=\"label_error\" id='error'></div> ";        $html .="<script >\n";        $html .= "  function max(e){  ";        $html .= "  tecla = (document.all) ? e.keyCode : e.which; ";        $html .= "  if (tecla==8) return true;";        $html .= "  if (tecla==13) return false;";        $html .= " }";        $html .= "</script>\n";        $html .= "<table class=\"modulo_table_list\" rules=\"all\" align=\"center\">";        $html .= "	<tr class=\"modulo_list_claro\">";        $html .= "    <td align=\"center\" class=\"normal_10AN\">\n";        $html .= "		CREAR NUEVO VENDEDOR";        $html .= "    </td>\n";        $html .= "    <td align=\"center\">\n";        $html .= "		<center class=\"label_error\"><a href=\"" . $action['Crear_Vendedor'] . "\"><img src=\"" . GetThemePath() . "/images/producto_proveedor.png\" border='0'></a></center>";        $html .= "    </td>\n";        $html .= "	</tr>";        $html .= "</table>";        $html .= "<br>";        $select .= "<select id=\"buscador[tipo_id_vendedor]\" name=\"buscador[tipo_id_vendedor]\" class=\"select\">";        $select .= "<option value=\"\">-- TODOS --</option>";        foreach ($tipos_ids_terceros as $k => $valor) {            $select .= "<option value=\"" . $valor['tipo_id_tercero'] . "\">" . $valor['tipo_id_tercero'] . "</option>";        }        $select .= "</select>";        $html .= "<form name=\"Buscador\" id=\"Buscador\" action=\"" . $action['buscador'] . "\" method=\"post\">";        $html .= "<table  width=\"50%\" align=\"center\" border=\"0\" class=\"modulo_table_list\">\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"formulacion_table_list\">TIPO IDENTIFICACION</td>\n";        $html .= "      <td  class=\"formulacion_table_list\">" . $select . "</td>\n";        $html .= "      <td  class=\"formulacion_table_list\"># IDENTIFICACION</td>\n";        $html .= "      <td  class=\"formulacion_table_list\"><input name=\"buscador[vendedor_id]\" id=\"buscador[vendedor_id]\" class=\"input-text\" style=\"width:100%\"></td>\n";        $html .= "      <td  class=\"formulacion_table_list\">NOMBRE</td>\n";        $html .= "      <td  class=\"formulacion_table_list\"><input name=\"buscador[nombre]\" id=\"buscador[nombre]\" class=\"input-text\" style=\"width:100%\"></td>\n";        $html .= "	</tr>";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"formulacion_table_list\" colspan=\"6\"><input type=\"submit\" value=\"BUSCAR VENDEDOR\" class=\"input-submit\"></td>\n";        $html .= "	</tr>";        $html .= "</table>";        $html .= "</form>";        $html .= "<br>";        $pgn = AutoCarga::factory("ClaseHTML");        $html .= "		" . $pgn->ObtenerPaginado($conteo, $pagina, $action['paginador']);        $html .= "                  <table width=\"50%\" align=\"center\" class=\"modulo_table_list\">\n";        $html .= "                    <tr class=\"modulo_table_list_title\">\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='IDENTIFICACION DEL VENDEDOR'>IDENTIFICACION - VENDEDOR </a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='NOMBRE DEL VENDEDOR'>NOMBRE</a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='TELEFONO'>TELEFONO";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" width=\"3%\">\n";        $html .= "                        <a title='USUARIO - SISTEMA'>USUARIO<a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" width=\"3%\">\n";        $html .= "                        <a title='MODIFICAR'>MOD.<a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" width=\"3%\">\n";        $html .= "                        <a title='ESTADO DEL CONTRATO'>EST.<a>";        $html .= "                      </td>\n";        $html .= "                    </tr>\n";        foreach ($vendedores as $key => $valor) {            $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";            $html .= "						<td>" . $valor['tipo_id_vendedor'] . "-" . $valor['vendedor_id'] . "</td>";            $html .= "						<td>" . $valor['nombre'] . "</b></td>";            $html .= "						<td>" . $valor['telefono'] . "</b></td>";            $html .= "						<td>" . $valor['usuario'] . "</td>";            $html .= "						<td>";            $html .= "						<center><a href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'FormularioVendedor', array("tipo_id_vendedor" => $valor['tipo_id_vendedor'], "vendedor_id" => $valor['vendedor_id'])) . "\" class=\"label_error\"  title=\"MODIFICAR VENDEDOR\"><img src=\"" . GetThemePath() . "/images/modificar.png\" border='0'></a></center>\n";            $html .= "						</td>";            if ($valor['estado'] == '1') {                $html .= "						<td>";                $html .= "						<center><a onClick=\"return confirm('INACTIVAR EL VENDEDOR: " . $valor['nombre'] . "?');\" href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'CrearVendedores', array("tipo_id_vendedor" => $valor['tipo_id_vendedor'], "vendedor_id" => $valor['vendedor_id'], "cambiar_estado" => "0", "buscador" => $_REQUEST['buscador'])) . "\" class=\"label_error\"  title=\"VENDEDOR ACTIVO, CAMBIAR A INACTIVO\"><img src=\"" . GetThemePath() . "/images/pactivo.png\" border='0'></a></center>\n";                $html .= "						</td>";            } else {                $html .= "						<td>";                $html .= "							<center><a onClick=\"return confirm('ACTIVAR EL VENDEDOR: " . $valor['nombre'] . "?');\" href=\"" . ModuloGetURL('app', 'ContratacionProductosCliente', 'controller', 'CrearVendedores', array("tipo_id_vendedor" => $valor['tipo_id_vendedor'], "vendedor_id" => $valor['vendedor_id'], "cambiar_estado" => "1", "buscador" => $_REQUEST['buscador'])) . "\" class=\"label_error\"  title=\"VENDEDOR INACTIVO, CAMBIAR A ACTIVO\"><img title=\"CONTRATO INACTIVO\" src=\"" . GetThemePath() . "/images/pinactivo.png\" border='0' ></a></center>\n";                $html .= "						</td>";            }            $html .= "                   </tr>\n";        }        $html .= "				</table>";        $html .= "<br>";        $html .= "<table align=\"center\" width=\"50%\">\n";        $html .= "  <tr>\n";        $html .= "    <td align=\"center\">\n";        $html .= "      <a href=\"" . $action['volver'] . "\"  class=\"label_error\">\n";        $html .= "        VOLVER\n";        $html .= "      </a>\n";        $html .= "    </td>\n";        $html .= "  </tr>\n";        $html .= "</table>\n";        $html .= ThemeCerrarTabla();        /* $html .= $this->CrearVentana('600','VENDEDORES'); */        return $html;    }    /**     * Funcion donde se crea la Forma del Contrato a llenar       * @param array $datos vector que contiene la informacion de Los Proveedores     * @param array $action vector que contiene los link de la aplicacion     * @param array $datos_empresa vector que contiene la informacion de Empresa que contrata al proveedor     * @param string $fecha contiene la informacion de la fecha actual.     * @return string $html retorna la cadena con el codigo html de la pagina     */    function Formulario_Vendedores($action, $datos, $vendedores, $tipo_id_terceros, $usuarios, $Vendedor) {        $html = ThemeAbrirTabla(' DATOS VENDEDOR ', '50%');        //Que solo aparezca Cuando NO hay un contrato activo y/o existente para ese tercero selecionado        $ctl = AutoCarga::factory("ClaseUtil");        $html .= $ctl->IsDate("-");        $html .= $ctl->AcceptDate("-");        $html .= $ctl->AcceptNum("-");        $html .= $ctl->LimpiarCampos();        $html .= $ctl->RollOverFilas();        $html .="<div align=\"center\" class=\"label_error\" id='error'></div> ";        $html .="<script >\n";        $html .= "  function max(e){  ";        $html .= "  tecla = (document.all) ? e.keyCode : e.which; ";        $html .= "  if (tecla==8) return true;";        $html .= "  if (tecla==13) return false;";        $html .= " }";        $html .= "</script>\n";        $select_tipos_id_terceros .= "<select name=\"tipo_id_vendedor\" id=\"tipo_id_vendedor\" class=\"select\" style=\"width:50%\">";        $select_tipos_id_terceros .= "	<option value=\"\">-- SELECCIONAR --</option>";        foreach ($tipo_id_terceros as $key => $valor) {            if (trim($Vendedor[0]['tipo_id_vendedor']) == trim($valor['tipo_id_tercero']))                $selected = " selected ";            else                $selected = " ";            $select_tipos_id_terceros .= "	<option " . $selected . " value=\"" . $valor['tipo_id_tercero'] . "\">" . $valor['tipo_id_tercero'] . "</option>";        }        $select_tipos_id_terceros .= "</select>";        $select_usuarios .= "<select name=\"usuario_sistema\" id=\"usuario_sistema\" class=\"select\" style=\"width:100%\">";        $select_usuarios .= "	<option value=\"\">-- SELECCIONAR --</option>";        foreach ($usuarios as $k => $v) {            if (trim($Vendedor[0]['usuario_sistema']) == trim($v['usuario_id']))                $selected = " selected ";            else                $selected = " ";            $select_usuarios .= "	<option " . $selected . " value=\"" . $v['usuario_id'] . "\">" . $v['nombre'] . "-" . $v['usuario'] . "</option>";        }        $select_usuarios .= "</select>";        $html .= "<br>";        $html .= "				<form name=\"datos_vendedor\" id=\"datos_vendedor\" action=\"" . $action['GuardarVendedor'] . "\" method=\"POST\">";        $html .= "                  <table width=\"100%\" align=\"center\" class=\"modulo_table_list\">\n";        $html .= "					<tr class=\"formulacion_table_list\">";        $html .= "						<td colspan=\"2\">";        $html .= "							DATOS DEL VENDEDOR";        $html .= "						</td>";        $html .= "					</tr>";        $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";        $html .= "                      <td align=\"left\" width=\"40%\" class=\"modulo_table_list_title\">\n";        $html .= "                        <a title=''>TIPO. ID</a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"left\" >\n";        $html .= "                        " . $select_tipos_id_terceros;        $html .= "                      </td>\n";        $html .= "                    </tr>\n";        $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";        $html .= "                      <td align=\"left\" class=\"modulo_table_list_title\">\n";        $html .= "                        <a title='NUMERO DE IDENTIFICACION DEL VENDEDOR'># IDENTIFICACION</a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"left\" >\n";        $html .= "                        <input value=\"" . $Vendedor[0]['vendedor_id'] . "\" onkeypress=\"return acceptNum(event)\" type=\"text\" style=\"width:100%\" class=\"input-text\" name=\"vendedor_id\" id=\"vendedor_id\" maxlength=\"32\">";        $html .= "                      </td>\n";        $html .= "                    </tr>\n";        $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";        $html .= "                      <td align=\"left\" class=\"modulo_table_list_title\">\n";        $html .= "                        <a title='NOMBRE DEL VENDEDOR'>NOMBRE</a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"left\" >\n";        $html .= "                        <input value=\"" . $Vendedor[0]['nombre'] . "\" type=\"text\" style=\"width:100%\" class=\"input-text\" name=\"nombre\" id=\"nombre\" maxlength=\"65\">";        $html .= "                      </td>\n";        $html .= "                    </tr>\n";        $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";        $html .= "                      <td align=\"left\" class=\"modulo_table_list_title\">\n";        $html .= "                        <a title='TELEFONO'>TELEFONO";        $html .= "                      </td>\n";        $html .= "                      <td align=\"left\" >\n";        $html .= "                        <input value=\"" . $Vendedor[0]['telefono'] . "\" onkeypress=\"return acceptNum(event)\" type=\"text\" style=\"width:100%\" class=\"input-text\" name=\"telefono\" id=\"telefono\" maxlength=\"20\">";        $html .= "                      </td>\n";        $html .= "                    </tr>\n";        $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";        $html .= "                      <td class=\"modulo_table_list_title\" align=\"left\" >\n";        $html .= "                        <a title='USUARIO - SISTEMA'>USUARIO<a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"left\" >\n";        $html .= "                        " . $select_usuarios;        $html .= "                      </td>\n";        $html .= "                    </tr>\n";        $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";        $html .= "						<td colspan=\"2\" class=\"modulo_table_list_title\">";        if (empty($Vendedor))            $html .= "							<input type=\"hidden\" name=\"consulta\" id=\"consulta\" value=\"1\">";        else {            $html .= "							<input type=\"hidden\" name=\"consulta\" id=\"consulta\" value=\"0\">";            $html .= "							<input type=\"hidden\" name=\"tipo_id_vendedor_old\" id=\"tipo_id_vendedor_old\" value=\"" . $Vendedor[0]['tipo_id_vendedor'] . "\">";            $html .= "							<input type=\"hidden\" name=\"vendedor_id_old\" id=\"vendedor_id_old\" value=\"" . $Vendedor[0]['vendedor_id'] . "\">";        }        $html .= "							<input type=\"submit\" value=\"GUARDAR DATOS - VENDEDOR\" class=\"input-submit\">";        $html .= "						</td>";        $html .= "                    </tr>\n";        $html .= "				</table>";        $html .= "			</form>";        $html .= "<br>";        $html .= "<table align=\"center\" width=\"50%\">\n";        $html .= "  <tr>\n";        $html .= "    <td align=\"center\">\n";        $html .= "      <a href=\"" . $action['volver'] . "\"  class=\"label_error\">\n";        $html .= "        VOLVER\n";        $html .= "      </a>\n";        $html .= "    </td>\n";        $html .= "  </tr>\n";        $html .= "</table>\n";        $html .= ThemeCerrarTabla();        /* $html .= $this->CrearVentana('600','VENDEDORES'); */        return $html;    }    /**     * Funcion donde se crea la Forma del Contrato a llenar       * @param array $datos vector que contiene la informacion de Los Proveedores     * @param array $action vector que contiene los link de la aplicacion     * @param array $datos_empresa vector que contiene la informacion de Empresa que contrata al proveedor     * @param string $fecha contiene la informacion de la fecha actual.     * @return string $html retorna la cadena con el codigo html de la pagina     */    function Vigencia_Cotizacion($action, $datos, $vigencia_parametrizada) {        $html = ThemeAbrirTabla(' VIGENCIA COTIZACION ', '50%');        //Que solo aparezca Cuando NO hay un contrato activo y/o existente para ese tercero selecionado        $ctl = AutoCarga::factory("ClaseUtil");        $html .= $ctl->IsDate("-");        $html .= $ctl->AcceptDate("-");        $html .= $ctl->AcceptNum("-");        $html .= $ctl->LimpiarCampos();        $html .= $ctl->RollOverFilas();        $html .="<div align=\"center\" class=\"label_error\" id='error'></div> ";        $html .="<script >\n";        $html .= "  function max(e){  ";        $html .= "  tecla = (document.all) ? e.keyCode : e.which; ";        $html .= "  if (tecla==8) return true;";        $html .= "  if (tecla==13) return false;";        $html .= " }";        $html .= "</script>\n";        $html .= "				<form name=\"datos_vendedor\" id=\"datos_vendedor\" action=\"" . $action['GuardarVendedor'] . "\" method=\"POST\">";        $html .= "                  <table width=\"100%\" align=\"center\" class=\"modulo_table_list\">\n";        $html .= "					<tr class=\"formulacion_table_list\">";        $html .= "						<td colspan=\"3\">";        $html .= "							VIGENCIA DE LA COTIZACION DE UN CLIENTE";        $html .= "						</td>";        $html .= "					</tr>";        $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";        $html .= "                      <td align=\"left\" class=\"modulo_table_list_title\">\n";        $html .= "                        <a title=''>VIGENCIA DE LA COTIZACION</a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"left\" >\n";        $html .= "                        <input value=\"" . $vigencia_parametrizada['dias'] . "\" onkeypress=\"return acceptNum(event)\" type=\"text\" style=\"width:100%\" class=\"input-text\" name=\"dias\" id=\"dias\" maxlength=\"3\">";        $html .= "                      </td>\n";        $html .= "                      <td align=\"left\" CLASS=\"label\">\n";        $html .= "                        DIAS";        $html .= "                      </td>\n";        $html .= "                    </tr>\n";        $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";        $html .= "						<td colspan=\"3\" class=\"modulo_table_list_title\">";        if (empty($vigencia_parametrizada))            $html .= "							<input type=\"hidden\" name=\"consulta\" id=\"consulta\" value=\"1\">";        else {            $html .= "							<input type=\"hidden\" name=\"consulta\" id=\"consulta\" value=\"0\">";        }        $html .= "							<input type=\"submit\" value=\"GUARDAR DATOS\" class=\"input-submit\">";        $html .= "						</td>";        $html .= "                    </tr>\n";        $html .= "				</table>";        $html .= "			</form>";        $html .= "<br>";        $html .= "<table align=\"center\" width=\"50%\">\n";        $html .= "  <tr>\n";        $html .= "    <td align=\"center\">\n";        $html .= "      <a href=\"" . $action['volver'] . "\"  class=\"label_error\">\n";        $html .= "        VOLVER\n";        $html .= "      </a>\n";        $html .= "    </td>\n";        $html .= "  </tr>\n";        $html .= "</table>\n";        $html .= ThemeCerrarTabla();        /* $html .= $this->CrearVentana('600','VENDEDORES'); */        return $html;    }    /*     * *************************************************************     * Funcion:salida para mostrar pedidos clientes gral      ROMA. 											06-12-2012     * ************************************************************* */    function FormaPedGral($pedidoid) {        $sql = AutoCarga::factory("ContratacionProductosClienteSQL", "classes", "app", "ContratacionProductosCliente");        $pedidos = $sql->Lista_pedidos_clientes($pedidoid);        $html .= "<table border=\"0\" align =\"center\" cellpading=\"0\" cellspacing=\"0\" width=\"100%\">\n";        foreach ($pedidos as $k => $v) {            $html .= "<tr>";            $html .= " <td>";            $html .=" <table border=\"0\" align =\"center\" width=\"100%\">";            $html .="  <tr>";            $html .= "<td width=\"50%\">\n";            $html .= " <img src=\"" . GetThemePath() . "/images/logopedido.png\" border='0'>\n";            $html .= "</td>\n";            $html .="<td align=\"left\">";            $est = "  style=\"font-family: sans_serif, Verdana, helvetica, Arial; font-weight:bold;font-size:7.5px\"";            $html .="	<table $est width=\"100%\" align=\"left\" >\n";            $html .="		<tr>";            $html .="			<td align=\"center\"  >" . $v['razon_social'] . ": " . $v['tipo_id_empresa'] . " " . $v['id'] . "-" . $v['digito_verificacion'] . "</td>";            $html .="		</tr>";            $html .="		<tr>";            $html .="			<td align=\"center\"  >" . $v['direccion_empresa'] . " - " . $v['telefonos'] . "</td>";            $html .="		</tr>";            $html .="		<tr>";            $html .="			<td align=\"center\" >" . $v['ubicacion_empresa'] . "</td>";            $html .="		</tr>";            $html .="		<tr>";            $html .="			<td align=\"center\" >PEDIDO # " . $v['pedido_cliente_id'] . "</td>";            $html .="		</tr>";            $html .="	</table>";            $html .="</td>";            $html .="  </tr>";            $html .="  <tr>";            $html .="    <td colspan=\"2\">";            $detl = $sql->Consulta_Pedido_d($v['pedido_cliente_id']);            $estilo = " style=\"font-family: sans_serif, Verdana, helvetica, Arial; font-size:10px\"";            if (!empty($detl)) {                $html .= "	<table width=\"100%\" align=\"center\" style=\"border:1px solid #000000;\" rules=\"all\">\n";                $html .= "		<tr>\n";                $html .= "			<td width=\"10%\" class=\"label\" colspan=\"2\" align=\"center\">GESTION COMERCIAL</td>\n";                $html .= "		</tr>\n";                $html .= "		<tr>\n";                $html .= "			<td width=\"10%\" class=\"label\" colspan=\"2\" align=\"center\">REQUISICION DE MEDICAMENTOS Y DISPOSITIVOS MEDICOS</td>\n";                $html .= "		</tr>\n";                $html .= "		<tr>\n";                $html .= "			<td width=\"10%\" class=\"label\">FECHA: " . $v['fecha_registro'] . " </td>\n";                $html .= "			<td width=\"10%\" class=\"label\">CLIENTE: " . $v['nombre_tercero'] . " " . $v['tipo_id_tercero'] . "-" . $v['tercero_id'] . " </td>\n";                $html .= "		</tr>\n";                $html .= "		<tr>\n";                $html .= "			<td width=\"10%\" class=\"label\">DIRECCION: " . $v['direccion'] . " : " . $v['ubicacion'] . " </td>\n";                $html .= "			<td width=\"10%\" class=\"label\">TELEFONO: " . $v['telefono'] . " " . $v['tipo_id_tercero'] . "-" . $v['tercero_id'] . " </td>\n";                $html .= "		</tr>\n";                $html .= "		<tr>\n";                $html .= "			<td width=\"10%\" class=\"label\">VENDEDOR: " . $v['tipo_id_vendedor'] . "-" . $v['vendedor_d'] . ": " . $v['nombre'] . "  </td>\n";                $html .= "			<td width=\"10%\" class=\"label\"><b>OBSERVACIONES:</b> " . $v['observacion'] . "</td>\n";                $html .= "		</tr>\n";                $html .= "	</table>";                $html .= "<br><hr>";                $html .= "	<table width=\"100%\" align=\"center\" style=\"border:1px solid #000000;\" rules=\"all\">\n";                $html .= "		<tr align=\"center\">\n";                $html .= "			<td class=\"label\">CODIGO PRODUCTO</td>\n";                $html .= "			<td class=\"label\">PRODUCTO</td>\n";                $html .= "			<td class=\"label\">CANTIDAD</td>\n";                $html .= "			<td class=\"label\">LOT</td>\n";                $html .= "			<td class=\"label\">F.VENC</td>\n";                $html .= "			<td class=\"label\">OBS</td>\n";                $html .= "		</tr>\n";                foreach ($detl as $k1 => $dtl) {                    $html .= "     <tr>\n";                    $html .= "			<td class=\"label\" style=\"font-weight:lighter;\">" . $dtl['codigo_producto'] . "</td>\n";                    $html .= "			<td class=\"label\" style=\"font-weight:lighter;\">" . $dtl['descripcion'] . "</td>\n";                    $html .= "			<td class=\"label\" style=\"font-weight:lighter;\" align=\"center\">" . FormatoValor($dtl['numero_unidades'], 0) . "</td>\n";                    $html .= "			<td class=\"label\">&nbsp;</td>\n";                    $html .= "			<td class=\"label\">&nbsp;</td>\n";                    $html .= "			<td align=\"center\" class=\"label\" style=\"font-weight:lighter;\">";                    if ($dtl['sw_requiereautorizacion_despachospedidos'] == '1')                        $html .= " 			<img title=\"EL PRODUCTO REQUIERE AUTORIZACION PARA SER DESPACHADO\" src=\"" . GetThemePath() . "/images/alarma.gif\" border='0' >	";                    $html .= "			</td>";                    $html .= "		</tr>\n";                }                $html .= "	</table>";                $html .= "<br>";                $usuario = $sql->ObtenerInformacionUsuario(UserGetUID());                $html .= "	<table border='0' width=\"100%\">\n";                $html .= "		<tr>\n";                $html .= "			<td align=\"justify\" width=\"50%\">\n";                $html .= "				<font size='1' face='arial'>\n";                $html .= "					Imprimiï¿½:&nbsp;" . $usuario['nombre'] . "\n";                $html .= "				</font>\n";                $html .= "			</td>\n";                $html .= "			<td align=\"right\" width=\"50%\">\n";                $html .= "				<font size='1' face='arial'>\n";                $html .= "					Fecha Impresiï¿½n :&nbsp;&nbsp;" . date("d/m/Y - h:i a") . "\n";                $html .= "				</font>\n";                $html .= "			</td>\n";                $html .= "		</tr>\n";                $html .= "	</table>\n";            }            $html .="    </td>";            $html .="  </tr>";            $html .="  <tr>";            $html .="   <td>";            $html .="    <h1 class=\"SaltoDePagina\"> </h1>";            $html .="   </td>";            $html .="  </tr>";            $html .=" </table>";            $html .= " </td>";            $html .= "</tr>";        } //end main for cycle        $html .= "</table>";        return $html;    }	function Productos_Todos_Contrato($datos, $action, $productos_inventario, $conteo, $pagina) {        $html = ThemeAbrirTabla('PRODUCTOS: CONTRATO - CLIENTE');        /*          Funciones JavaScript         */        $html .= "<script>";        $html .= "function Paginador(Formulario,offset)";        $html .= "{";        $html .= "xajax_Listado_TerceroCliente(Formulario,offset);";        $html .= "}";        $html .= "</script>";        $html .= "<script>";        $html .= "	function ValidarCantidad_Checkbox(campo_precio_pactado,costo_ultima_compra,checkbox_id)\n";        $html .= "	{\n";        $html .= "	if(parseFloat(document.getElementById(campo_precio_pactado).value)<parseFloat(costo_ultima_compra))";        $html .= "			document.getElementById(checkbox_id).checked=0;\n";        $html .= "		else{\n";        $html .= "			document.getElementById(checkbox_id).checked=1;\n";        $html .= "			}\n";        $html .= "	}\n";        $html .= "	function ValidarCantidad(campo,valor,cant_sol,capa)\n";        $html .= "	{\n";        $html .= "		document.getElementById(campo).style.background='';\n";        $html .= "		document.getElementById('error').innerHTML='';\n";        $html .= "			document.getElementById(capa).checked=0;\n";        $html .= "		if(isNaN(valor) || parseFloat(valor)<=0 || valor=='')\n";        $html .= "		{\n";        $html .= "			document.getElementById(campo).value='';\n";        $html .= "			document.getElementById(campo).style.background='#ff9595';\n";        $html .= "			document.getElementById('error').innerHTML='<center>CANTIDAD NO VALIDA</center>';\n";        $html .= "			document.getElementById(capa).disabled=\"true\";\n";        $html .= "		}\n";        $html .= "		else{\n";        $html .= "			document.getElementById(capa).style.display=\"\";\n";        $html .= "			document.getElementById(capa).disabled=\"\";\n";        $html .= "		}\n";        $html .= "	}\n";        $html .= "function Validar_Campos(Formulario)";        $html .= "{";        $html .= " var entrar = confirm('Continuar?');";        $html .= " if(entrar)";        $html .= "		Formulario.submit();";        $html .= "	else";        $html .= "		return false;";        $html .= "}";        $html .= "</script>";        /*          Fin Funciones JavaScript         */        $ctl = AutoCarga::factory("ClaseUtil");        $html .= $ctl->IsDate("-");        $html .= $ctl->AcceptDate("-");        $html .= $ctl->AcceptNum("-");        $html .= $ctl->LimpiarCampos();        $html .= $ctl->RollOverFilas();        $html .= "<center><div class=\"label_error\" id=\"error\"></div></center>";        $html .= "<table  width=\"85%\" align=\"center\" border=\"0\" class=\"modulo_table_list\" >\n";        $html .= "  <tr align=\"center\" >\n";        $html .= "      <td  class=\"formulacion_table_list\" colspan=\"3\" > <b>EMPRESA : " . $datos['razon_social'] . " </b> </td>\n";        $html .= "  </tr>\n";        $html .= "</table>";        $html .= "<br>";        $html .= "<form name=\"Formulario\" id=\"Formulario\" action=\"" . $action['buscar'] . "\"  method=\"post\" >\n";        $html .= "<table  width=\"85%\" align=\"center\" border=\"0\" class=\"modulo_table_list\" >\n";        $html .= "  <tr align=\"center\" class=\"formulacion_table_list\">\n";        $html .= "		<td colspan=\"9\" >";        $html .= "		BUSCADOR DE PRODUCTOS.";        $html .= "		</td>";        $html .= "	</tr>";        $html .= "  <tr align=\"center\" class=\"modulo_table_list_title\">\n";        $html .= "		<td >";        $html .= "			CLASE";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			<input type=\"input-text\" name=\"buscador[laboratorio]\" id=\"buscador[laboratorio]\" class=\"input-text\" style=\"width:100%\">";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			SUBCLASE";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			<input type=\"input-text\" name=\"buscador[principio_activo]\" id=\"buscador[principio_activo]\" class=\"input-text\" style=\"width:100%\">";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			CODIGO PRODUCTO";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			<input type=\"input-text\" name=\"buscador[codigo_producto]\" id=\"buscador[codigo_producto]\" class=\"input-text\" style=\"width:100%\">";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			DESCRIPCION";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			<input type=\"input-text\" name=\"buscador[descripcion]\" id=\"buscador[descripcion]\" class=\"input-text\" style=\"width:100%\">";        $html .= "		</td>";        $html .= "		<td >";        $html .= "			<input type=\"submit\" class=\"input-submit\" style=\"width:100%\" value=\"BUSCAR PRODUCTO.\">";        $html .= "		</td>";        $html .= "	</tr>";        $html .= "</table>";        $html .= "</form>";        $html .= " <br>";        $pgn = AutoCarga::factory("ClaseHTML");        $html .= "		" . $pgn->ObtenerPaginado($conteo, $pagina, $action['paginador']);        $html .= "		<div id=\"error\" class=\"label_error\"></div>";        $html .= "		<form name=\"FormularioProductos\" id=\"FormularioProductos\" action=\"" . $action['guardar'] . "\"  method=\"post\" onSubmit=\"Validar_Campos(document.FormularioProductos); return false;\">\n";        $html .= "                  <table width=\"100%\" align=\"center\" class=\"modulo_table_list\">\n";        $html .= "                    <tr class=\"modulo_table_list_title\">\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='CODIGO DEL PRODUCTO'>COD. PRODUCTO </a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='NOMBRE DEL PRODUCTO'>DESCRIPCION</a>";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='COSTO COMPRA'>COSTO COMPRA";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" >\n";        $html .= "                        <a title='COSTO VENTA'>COSTO VENTA";        $html .= "                      </td>\n";        $html .= "                      <td align=\"center\" width=\"2%\">\n";        $html .= "                        <a title='SELECCIONAR'>SEL<a>";        $html .= "                      </td>\n";        $html .= "                    </tr>\n";        $i = 0;        foreach ($productos_inventario as $key => $valor) {            $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";            $html .= "						<td align=\"center\">" . $valor['codigo_producto'] . "</td>";            $html .= "						<td>" . $valor['descripcion'] . "</td>";            $html .= "						<td>$" . FormatoValor($valor['costo_ultima_compra'], 2) . "</b></td>";            $html .= "						<td>";            $html .= "						<input type=\"input-text\" name=\"precio_pactado" . $i . "\" id=\"precio_pactado" . $i . "\" class=\"input-text\" style=\"width:100%\" onkeyup=\"ValidarCantidad('precio_pactado" . $i . "',this.value,'" . $valor['costo_ultima_compra'] . "','$i');\">";            $html .= "						";            $html .= "						</td>";            $html .= "						<td align=\"center\"><input disabled type=\"checkbox\" name=\"" . $i . "\" id=\"" . $i . "\" value=\"" . $valor['codigo_producto'] . "\" class=\"input-checkbox\" > </td>";            $html .= "                   </tr>\n";            $i++;        }        $html .= "                  <tr class=\"modulo_list_claro\" onMouseOver=\"mOvr(this,'#ffffff');\" onMouseOut=\"mOut(this,'#DDDDDD');\">\n";		$html .= "						<td></td>";        $html .= "						<td><input type=\"hidden\" name=\"cantidad_registros\" id=\"cantidad_registros\" value=\"" . $i . "\"></td>";        $html .= "						<td></td>";        $html .= "						<td align=\"center\"><input type=\"submit\" class=\"input-submit\" style=\"width:100%\" value=\"AGREGAR A LOS CONTRATOS\"> </td>";        $html .= "						<td></td>";        $html .= "                   </tr>\n";        $html .= "				</table>";        $html .= "		</form>";        $html .= "<table align=\"center\" width=\"50%\">\n";        $html .= "  <tr>\n";        $html .= "    <td align=\"center\">\n";        $html .= "      <a href=\"" . $action['volver'] . "\"  class=\"label_error\">\n";        $html .= "        Volver\n";        $html .= "      </a>\n";        $html .= "    </td>\n";        $html .= "  </tr>\n";        $html .= "</table>\n";        $html .= ThemeCerrarTabla();        $html .= $this->CrearVentana('800', 'BUSCAR TERCEROS CLIENTES');        /*          Precarga de algunos datos Del Cliente que requieren Xajax y Javascript         */        return $html;    }}?>
