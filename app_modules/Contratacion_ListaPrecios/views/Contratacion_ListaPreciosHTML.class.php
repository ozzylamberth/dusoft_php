<?php   /**  * @package IPSOFT-SIIS  * @version $Id: ContratacionProductosClienteHTML.class.php,v 1.14 2010/01/26 22:40:56 sandra Exp $Revision: 1.14 $  * @copyright (C) 2009 IPSOFT - SA (www.ipsoft-sa.com)  * @author Mauricio Adrian Medina Santacruz  */  IncludeClass("ClaseHTML");  IncludeClass("ClaseUtil");  IncludeClass("CalendarioHtml");    class Contratacion_ListaPreciosHTML  {     /**     * Constructor de la clase     */         function  Contratacion_ListaPreciosHTML(){}        	function FormaMenu($action)                             		{     		$html .= ThemeAbrirTabla('MENU -  CREACION DE LISTAS DE PRECIOS');				//print_r($_REQUEST);				$accion=$action['volver'];		$html  = ThemeAbrirTabla('MENU - CREACION DE LISTAS DE PRECIOS');		$html .= "  <table border=\"0\" width=\"60%\" align=\"center\">";		$html .= "  <tr><td>";		$html .= "      <table border=\"0\" width=\"70%\" align=\"center\" class=\"modulo_table_list\">";		$html .= "      <tr class=\"modulo_table_list_title\">";		$html .= "      <td align=\"center\">";		$html .= "      MENÚ";		$html .= "      </td>";		$html .= "      </tr>";		//print_r($_REQUEST);		$url  .= "&datos[empresa]=".$_REQUEST['datos']['empresa']."";			$html .= "      <tr class=\"modulo_list_claro\">";		$html .= "      <td class=\"label\" align=\"center\">";		$html .= "      <a href=\"".ModuloGetURL('app','Contratacion_ListaPrecios','controller','CrearListaPrecios')."".$url."\">CREAR - LISTA DE PRECIOS</a>";		$html .= "      </td>";		$html .= "      </tr>";        $html .= "      <tr class=\"modulo_list_claro\">";		$html .= "      <td class=\"label\" align=\"center\">";		$html .= "      <a href=\"".ModuloGetURL('app','Contratacion_ListaPrecios','controller','ModificarListaPrecios')."".$url."\">MODIFICAR - LISTA DE PRECIOS</a>";		$html .= "      </td>";		$html .= "      </tr>";		    		/*$html .= "      <tr class=\"modulo_list_claro\">";		$html .= "      <td class=\"label\" align=\"center\">";		$html .= "      <a href=\"". ModuloGetURL('app','Contratacion_ListaPrecios','controller','ListarFacturas') ."".$url."\">FACTURAS PROVEEDOR</a>";		$html .= "      </td>";		$html .= "      </tr>";*/				$html .= "      </table>";        		$html .= "  </td></tr>";		$html .= ' 	<form name="forma" action="'.$action['volver'].'" method="post">';		$html .= "  <tr>";		$html .= "  <td align=\"center\"><br>";		$html .= '  <input class="input-submit" type="submit" name="volver" value="Volver">';		$html .= "  </td>";		$html .= "  </form>";		$html .= "  </tr>";        		$html .= "  </table>";				        $html .= ThemeCerrarTabla();	        return $html;        }        /**  * Funcion forma que permite realizar  la busqueda de los proveedores	* @param array $action vector que contiene los link de la aplicacion	* @return string $html retorna la cadena con el codigo html de la pagina    */ 		function FormaCrearListasPrecios($action)                             		{     		$html .= ThemeAbrirTabla('CREAR LISTAS DE PRECIOS');						//print_r($_REQUEST);      $html .= "<script>";      $html .= " function Paginador(Formulario,offset)";      $html .= " { ";      $html .= "  xajax_ListaPrecios_Detalle(Formulario,offset);";      $html .= " } ";      $html .= "</script>";            $html .= "<script>\n";      $html .= "  function mOvr(src,clrOver)\n";      $html .= "  {\n";      $html .= "    src.style.background = clrOver;\n";      $html .= "  }\n";      $html .= "  function mOut(src,clrIn)\n";      $html .= "  {\n";      $html .= "    src.style.background = clrIn;\n";      $html .= "  }\n";      $html .= "  function acceptDate(evt)\n";      $html .= "  {\n";      $html .= "    var nav4 = window.Event ? true : false;\n";      $html .= "    var key = nav4 ? evt.which : evt.keyCode;\n";      $html .= "    return (key <= 13 ||(key >= 47 && key <= 57));\n";      $html .= "  }\n";      $html .= "</script>\n";			$html .= "		<form name=\"formabuscar\" id=\"formabuscar\" action=\"".$action['volver']."\" method=\"post\">";			$html .= "<table   width=\"40%\" align=\"center\" border=\"0\">";      $html .= "	<tr>\n";			$html .= "		<td  width=\"40%\" class=\"modulo_table_list_title\">CODIGO LISTA</td>\n";			$html .= "	    <td class=\"modulo_list_claro\" colspan=\"4\">\n";			$html .= "  	   <input type=\"text\" style=\"width:100%\" class=\"input-text\" id=\"codigo_lista\" name=\"codigo_lista\" maxlength=\"32\"></td>\n";			$html .= "	</tr>\n";			$html .= "		<tr>\n";			$html .= "			<td class=\"modulo_table_list_title\">DESCRIPCION:</td>\n";			$html .= "			<td  colspan=\"4\" class=\"modulo_list_claro\" ><input style=\"width:100%\" type=\"text\" class=\"input-text\" id=\"descripcion\" name=\"descripcion\" maxlength=\"32\"></td>\n";			$html .= "	</tr>\n";			$html .= "	<tr>\n";			$html .= "	   	<td align='center'>\n";			$html .= "			<input onclick=\"xajax_ListaPrecios(xajax.getFormValues('formabuscar'),'1');\" class=\"input-submit\" type=\"button\" value=\"Buscar\">\n";			$html .= "		</td>\n";			$html .= "		<td align='center' colspan=\"1\">\n";			$html .= "			<input class=\"input-submit\" type=\"reset\" value=\"Limpiar Campos\">\n";			$html .= "	  	</td>\n";						$html .= "		  <td align='center' >\n";			$html .= "		      <input class=\"input-submit\" type=\"submit\" value=\"Volver\">\n";			$html .= "		  </td>\n";						$html .= "	 </tr>\n";      $html .= "</form>\n";			$html .= "</table><br>\n";			$html .= "<div id=\"ListaPrecios\"></div>";           $html .= "   <form id=\"buscador_listaproductos\" name=\"buscador_listaproductos\">";     $html .= "<div id=\"ListaPreciosDetalle\"></div>";     $html .= "  </form>";//310-484-1939 Veronica Diaz          $html .= "   <center>";     $html .= "   <div id=\"paginador\"></div>";     $html .= "   <form id=\"ProductosEnLista\" name=\"ProductosEnLista\"> ";     $html .= "<div id=\"ListaPreciosRegistrados\" style=\"100%;width:95%;height:300px;overflow:scroll;display:none;\"></div>";     $html .= "  </form>";     $html .= "<div id=\"BotonListaPreciosRegistrados\"></div>";     $html .= "   </center>";          /*     $html .= "   <form id=\"buscador_noRegistrados\" name=\"buscador_noRegistrados\">";     $html .= "<div id=\"BuscadorNoRegistrados\"></div>";     $html .= "  </form>";//310-484-1939 Veronica Diaz          $html .= "   <center>";     $html .= "   <form id=\"ProductosFueraDeLista\" name=\"ProductosFueraDeLista\">";     $html .= "<div id=\"ListaPreciosNoRegistrados\" style=\"100%;width:90%;height:200px;overflow:scroll;display:none;\"></div>";     $html .= "  </form>";     $html .= "<div id=\"BotonListaPreciosNoRegistrados\"></div>";     $html .= "   </center>";*/	   $html .= $this->CrearVentana();	   $html .= ThemeCerrarTabla();	        return $html;    }		    /**      * Funcion donde se crea una Forma con una Ventana con capas para mostrar informacion           * en pantalla           * @param array $action vector que contiene los link de la aplicacion      	 * @param int $tmn Tamaño que tendra la ventana     * @return string    */    function CrearVentana($tmn,$Nombre)    {      $html .= "<script>\n";      $html .= "  var contenedor = 'Contenedor';\n";      $html .= "  var titulo = 'titulo';\n";      $html .= "  var hiZ = 4;\n";      $html .= "  function OcultarSpan()\n";      $html .= "  { \n";      $html .= "    try\n";      $html .= "    {\n";      $html .= "      e = xGetElementById('Contenedor');\n";      $html .= "      e.style.display = \"none\";\n";      $html .= "    }\n";      $html .= "    catch(error){}\n";      $html .= "  }\n";      $html .= "  function MostrarSpan()\n";      $html .= "  { \n";      $html .= "    try\n";      $html .= "    {\n";      $html .= "      e = xGetElementById('Contenedor');\n";      $html .= "      e.style.display = \"\";\n";      $html .= "      Iniciar();\n";      $html .= "    }\n";      $html .= "    catch(error){alert(error)}\n";      $html .= "  }\n";                 $html .= "  function MostrarTitle(Seccion)\n";      $html .= "  {\n";      $html .= "    xShow(Seccion);\n";      $html .= "  }\n";      $html .= "  function OcultarTitle(Seccion)\n";      $html .= "  {\n";      $html .= "    xHide(Seccion);\n";      $html .= "  }\n";      $html .= "  function Iniciar()\n";      $html .= "  {\n";      $html .= "    contenedor = 'Contenedor';\n";      $html .= "    titulo = 'titulo';\n";      $html .= "    ele = xGetElementById('Contenido');\n";      $html .= "    xResizeTo(ele,".$tmn.", 'auto');\n";        $html .= "    ele = xGetElementById(contenedor);\n";      $html .= "    xResizeTo(ele,".$tmn.", 'auto');\n";      $html .= "    xMoveTo(ele, xClientWidth()/4, xScrollTop()+20);\n";      $html .= "    ele = xGetElementById(titulo);\n";      $html .= "    xResizeTo(ele,".($tmn - 20).", 20);\n";      $html .= "    xMoveTo(ele, 0, 0);\n";      $html .= "    xEnableDrag(ele, myOnDragStart, myOnDrag, myOnDragEnd);\n";      $html .= "    ele = xGetElementById('cerrar');\n";      $html .= "    xResizeTo(ele,20, 20);\n";      $html .= "    xMoveTo(ele,".($tmn - 20).", 0);\n";      $html .= "  }\n";            $html .= "  function myOnDragStart(ele, mx, my)\n";      $html .= "  {\n";      $html .= "    window.status = '';\n";      $html .= "    if (ele.id == titulo) xZIndex(contenedor, hiZ++);\n";      $html .= "    else xZIndex(ele, hiZ++);\n";      $html .= "    ele.myTotalMX = 0;\n";      $html .= "    ele.myTotalMY = 0;\n";      $html .= "  }\n";      $html .= "  function myOnDrag(ele, mdx, mdy)\n";      $html .= "  {\n";      $html .= "    if (ele.id == titulo) {\n";      $html .= "      xMoveTo(contenedor, xLeft(contenedor) + mdx, xTop(contenedor) + mdy);\n";      $html .= "    }\n";      $html .= "    else {\n";      $html .= "      xMoveTo(ele, xLeft(ele) + mdx, xTop(ele) + mdy);\n";      $html .= "    }  \n";      $html .= "    ele.myTotalMX += mdx;\n";      $html .= "    ele.myTotalMY += mdy;\n";      $html .= "  }\n";      $html .= "  function myOnDragEnd(ele, mx, my)\n";      $html .= "  {\n";      $html .= "  }\n";      $html .= "</script>\n";      $html .= "<div id='Contenedor' class='d2Container' style=\"display:none;z-index:4\">\n";      $html .= "  <div id='titulo' class='draggable' style=\" text-transform: uppercase;text-align:center;\">".$Nombre."</div>\n";      $html .= "  <div id='cerrar' class='draggable'><a class=\"hcPaciente\" href=\"javascript:OcultarSpan()\" title=\"Cerrar\" style=\"font-size:9px;\">X</a></div><br><br>\n";      $html .= "  <div id='Contenido' class='d2Content'>\n";      $html .= "  </div>\n";      $html .= "</div>\n";      return $html;    }			   /**      * Funcion donde se crea la Forma del Contrato a llenar        * @param array $datos vector que contiene la informacion de Los Proveedores      * @param array $action vector que contiene los link de la aplicacion      * @param array $datos_empresa vector que contiene la informacion de Empresa que contrata al proveedor      * @param string $fecha contiene la informacion de la fecha actual.      * @return string $html retorna la cadena con el codigo html de la pagina    */ 		function FormaOrdenesCompra($action,$TerceroProveedor)		{	  $ctl = AutoCarga::factory("ClaseUtil");       	  $html  = $ctl->LimpiarCampos();      $html .= $ctl->RollOverFilas(); 	  $html .= $ctl->AcceptDate('/');	  $html .= $ctl->AcceptNum();      	  $html .= "<script>";	  $html .= "function Validar(formulario)";	  $html .= "{";	  $html .="		formulario.valor_descuento=parseInt(formulario.valor_descuento);";	  $html .="		formulario.valor_flete=parseInt(formulario.valor_flete);";					$html .="	if(formulario.numero_factura == '')";	$html .="		{";	$html .="		document.getElementById('error').innerHTML='Error... No Hay Registrada Una Factura!!';";	$html .="		return(false);";	$html .="		}";		$html .="	if(formulario.valor_descuento < 0)";	$html .="		{";	$html .="		document.getElementById('error').innerHTML='Error... No Es Posible Valores Negativos En El Descuento!!';";	$html .="		return(false);";	$html .="		}";    $html .="	if(formulario.valor_descuento >formulario.valor_total_factura)";	$html .="		{";	$html .="		document.getElementById('error').innerHTML='Error... Valor Del Descuento No Puede Ser Mayor al Total de La Factura!!';";	$html .="		return(false);";	$html .="		}";		$html .="	if(formulario.valor_flete < 0)";	$html .="		{";	$html .="		document.getElementById('error').innerHTML='Error... No Es Posible Valores Negativos En El Flete!!';";	$html .="		return(false);";	$html .="		}";		$html .="		xajax_Facturar(formulario,document.getElementById('orden_pedido_id').value);";		  $html .= "}";	  $html .= "</script>";	  	  $html .= ThemeAbrirTabla('FACTURACION DE RECEPCIONES PARCIALES - ORDENES DE COMPRA');	  //Empieza Tab	  $html .= "<center>";      $html .= "	<table width=\"98%\" align=\"center\">\n";			$html .= "		<tr>\n";			$html .= "			<td>\n";			$html .= "				<table width=\"100%\" align=\"center\">\n";			$html .= "					<tr>\n";			$html .= "						<td>\n";			$html .= "							<div class=\"tab-pane\" id=\"facturacion_proveedor\">\n";			$html .= "								<script>	tabPane = new WebFXTabPane( document.getElementById( \"facturacion_proveedor\" )); </script>\n";			$html .= "								<div class=\"tab-page\" id=\"ordenes_compra\">\n";			$html .= "									<h2 class=\"tab\">ORDENES DE COMPRA</h2>\n";            $html .= "									<script>	tabPane.addTabPage( document.getElementById(\"ordenes_compra\")); </script>\n";	  	        $html .= "<form name=\"productos\" action=\"".$action['buscar']."\" method=\"post\">\n";      $html .= "  <table width=\"60%\" align=\"center\">\n";      $html .= "    <tr>\n";      $html .= "      <td>\n";      $html .= "		      <table width=\"100%\">\n";      $html .= "            <tr>\n";      $html .= "              <td align=\"center\">\n";      $html .= "                <fieldset class=\"fieldset\" style=\"width:98%\">\n";      $html .= "                  <legend class=\"normal_10AN\">\n";      $html .= "                    <img src=\"".GetThemePath()."/images/informacion.png\">NOTA\n";      $html .= "                  </legend>\n";      $html .= "                  <center>\n";      $html .= "                    <label class=\"normal_10AN\">Busqueda de Ordenes de Compra De ".$TerceroProveedor[0]['nombre_tercero']."</label>\n";      $html .= "                  </center>\n";      $html .= "                </fieldset><br>\n"; 			      $html .= "              </td>\n";      $html .= "            </tr>\n";      $html .= "            <tr>\n";      $html .= "              <td class=\"normal_10AN\">FECHA INICIAL</td>\n";      $html .= "              <td>\n";      $html .= "                <input type=\"text\" name=\"buscador[fecha_inicio]\" id=\"fecha_inicio\" class=\"input-text\" onkeypress=\"return acceptDate(event)\" value=\"".$request['fecha_inicio']."\">\n";      $html .= "              </td>\n"; 	  $html .= "		          <td align=\"left\" class=\"label\" >".ReturnOpenCalendario('productos','fecha_inicio','/',1)."</td>\n";      $html .= "            </tr>\n";      $html .= "            <tr>\n";      $html .= "              <td class=\"normal_10AN\">FECHA FINAL</td>\n";      $html .= "              <td>\n";      $html .= "                <input type=\"text\" name=\"buscador[fecha_final]\" id=\"fecha_final\" class=\"input-text\" onkeypress=\"return acceptDate(event)\" value=\"".$request['fecha_final']."\">\n";      $html .= "              </td>\n"; 		$html .= "		          <td align=\"left\" class=\"label\" >".ReturnOpenCalendario('productos','fecha_final','/',1)."</td>\n";      $html .= "            </tr>\n";	  $html .= "			      <tr>\n";	  $html .= "				      <td class=\"label\" align=\"center\" colspan=\"3\">\n";	  $html .= "		          <input type=\"hidden\" id=\"orden_pedido_id\">";	  $html .= "					      <input type=\"button\" class=\"input-submit\" name=\"buscar\" value=\"Buscar\" onclick=\"xajax_BuscarOrdenDeCompra('".$_REQUEST['datos']['empresa']."','".$_REQUEST['codigo_proveedor_id']."',document.getElementById('fecha_inicio').value,document.getElementById('fecha_final').value);\">\n";   	  $html .= "					      <input type=\"button\" class=\"input-submit\" name=\"limpiar\" value=\"Limpiar Campos\" onClick=\"LimpiarCampos(document.productos)\">\n";      $html .= "				      </td>\n";	  $html .= "			      </tr>\n";	  $html .= "		      </table>\n";		//$html .= "	      </fieldset>\n";	   $html .= "	    </td>\n";	   $html .= "	  </tr>\n";	   $html .= "	</table>\n";	   $html .= "</form>\n";      	  $html .= "<div id=\"OrdenesCompra\"></div>";	  $html .= "								</div>\n";		//Apertura 2do Tab	$html .= "								<div class=\"tab-page\" id=\"recepciones_parcialesf\">\n";    $html .= "									<h2 class=\"tab\">FACTURACION DE RECEPCIONES PARCIALES</h2>\n";    $html .= "									<script>	tabPane.addTabPage( document.getElementById(\"recepciones_parcialesf\")); </script>\n";	//Cierre de 2do Tab y Cierre de TABS		$html .= "					<div id=\"RecepcionesParciales\"></div>";		$html .= "							</div>\n";	$html .= "						</td>\n";	$html .= "					</tr>\n";	$html .= "				</table>\n";	$html .= "			</td>\n";	$html .= "		</tr>\n";	$html .= "  </table>\n";						      $html .= "	<table width=\"90%\" align=\"center\">\n";	  $html .= "		<tr><td align=\"center\">\n";	  $html .= "			<form name=\"volver\" action=\"".$action['volver']."\" method=\"post\">\n";	  $html .= "				<input type=\"submit\" class=\"input-submit\" value=\"Volver\">\n";	  $html .= "			</form>\n";	  $html .= "		</td></tr>\n";	  $html .= "	</table>\n";      $html .= ThemeCerrarTabla();	  $html .= $this->CrearVentana(900,"RECEPCIONES PARCIALES");      return $html;	}		function ListarFacturasProveedor($action,$TerceroProveedor)		{	  $ctl = AutoCarga::factory("ClaseUtil");       	  $html  = $ctl->LimpiarCampos();      $html .= $ctl->RollOverFilas(); 	  $html .= $ctl->AcceptDate('/');	  $html .= $ctl->AcceptNum();      	  $html .= ThemeAbrirTabla('FACTURAS DEL PROVEEDOR');	  //Empieza Tab	  	        $html .= "<form name=\"productos\" action=\"".$action['buscar']."\" method=\"post\">\n";      $html .= "  <table width=\"60%\" align=\"center\">\n";      $html .= "    <tr>\n";      $html .= "      <td>\n";      $html .= "		      <table width=\"100%\">\n";      $html .= "            <tr>\n";      $html .= "              <td align=\"center\">\n";      $html .= "                <fieldset class=\"fieldset\" style=\"width:98%\">\n";      $html .= "                  <legend class=\"normal_10AN\">\n";      $html .= "                    <img src=\"".GetThemePath()."/images/informacion.png\">NOTA\n";      $html .= "                  </legend>\n";      $html .= "                  <center>\n";      $html .= "                    <label class=\"normal_10AN\">Busqueda de Ordenes de Compra De ".$TerceroProveedor[0]['nombre_tercero']."</label>\n";      $html .= "                  </center>\n";      $html .= "                </fieldset><br>\n"; 			      $html .= "              </td>\n";      $html .= "            </tr>\n";      $html .= "            <tr>\n";      $html .= "              <td class=\"normal_10AN\">FECHA INICIAL</td>\n";      $html .= "              <td>\n";      $html .= "                <input type=\"text\" name=\"buscador[fecha_inicio]\" id=\"fecha_inicio\" class=\"input-text\" onkeypress=\"return acceptDate(event)\" value=\"".$request['fecha_inicio']."\">\n";      $html .= "              </td>\n"; 	  $html .= "		          <td align=\"left\" class=\"label\" >".ReturnOpenCalendario('productos','fecha_inicio','/',1)."</td>\n";      $html .= "            </tr>\n";      $html .= "            <tr>\n";      $html .= "              <td class=\"normal_10AN\">FECHA FINAL</td>\n";      $html .= "              <td>\n";      $html .= "                <input type=\"text\" name=\"buscador[fecha_final]\" id=\"fecha_final\" class=\"input-text\" onkeypress=\"return acceptDate(event)\" value=\"".$request['fecha_final']."\">\n";      $html .= "              </td>\n"; 		$html .= "		          <td align=\"left\" class=\"label\" >".ReturnOpenCalendario('productos','fecha_final','/',1)."</td>\n";      $html .= "            </tr>\n";	  $html .= "			      <tr>\n";	  $html .= "				      <td class=\"label\" align=\"center\" colspan=\"3\">\n";	  $html .= "		          <input type=\"hidden\" id=\"orden_pedido_id\">";	  $html .= "					      <input type=\"button\" class=\"input-submit\" name=\"buscar\" value=\"Buscar\" onclick=\"xajax_ListarFacturasProveedor('".$_REQUEST['datos']['empresa']."','".$_REQUEST['codigo_proveedor_id']."',document.getElementById('fecha_inicio').value,document.getElementById('fecha_final').value);\">\n";   	  $html .= "					      <input type=\"button\" class=\"input-submit\" name=\"limpiar\" value=\"Limpiar Campos\" onClick=\"LimpiarCampos(document.productos)\">\n";      $html .= "				      </td>\n";	  $html .= "			      </tr>\n";	  $html .= "		      </table>\n";		//$html .= "	      </fieldset>\n";	   $html .= "	    </td>\n";	   $html .= "	  </tr>\n";	   $html .= "	</table>\n";	   $html .= "</form>\n";      	  $html .= "<div id=\"OrdenesCompra\"></div>";	 	  $html .= "	<table width=\"90%\" align=\"center\">\n";	  $html .= "		<tr><td align=\"center\">\n";	  $html .= "			<form name=\"volver\" action=\"".$action['volver']."\" method=\"post\">\n";	  $html .= "				<input type=\"submit\" class=\"input-submit\" value=\"Volver\">\n";	  $html .= "			</form>\n";	  $html .= "		</td></tr>\n";	  $html .= "	</table>\n";      $html .= ThemeCerrarTabla();	  $html .= $this->CrearVentana(900,"RECEPCIONES PARCIALES");      return $html;	}		function VerFacturaProveedor($action,$TerceroProveedor,$FacturaProveedorCabecera,$FacturaProveedorDetalle,$Empresa)		{	  $ctl = AutoCarga::factory("ClaseUtil");       	  $html  = $ctl->LimpiarCampos();      $html .= $ctl->RollOverFilas(); 	  $html .= $ctl->AcceptDate('/');	  $html .= $ctl->AcceptNum();      	  $html .= ThemeAbrirTabla('FACTURA DEL PROVEEDOR');	  //Empieza Tab	  $html .= "	<table align=\"center\" border=\"0\" width=\"100%\" class=\"modulo_table_list\">\n";        $html .= "		<tr >\n";	  $html .= "			<td align=\"center\" width=\"10%\" colspan=\"6\"><b>".$Empresa['razon_social']."</b></td>\n";	  $html .= "		</tr>\n";	  $html .= "		<tr >\n";	  $html .= "			<td align=\"center\" width=\"10%\" colspan=\"6\"><b>".$Empresa['tipo_id_tercero']."-".$Empresa['id']."</b></td>\n";	  $html .= "		</tr>\n";	  $html .= "		<tr >\n";	  $html .= "			<td align=\"center\" width=\"10%\" colspan=\"6\"><b>".$Empresa['direccion']."</b></td>\n";	  $html .= "		</tr>\n";	  $html .= "		<tr >\n";	  $html .= "			<td align=\"center\" width=\"10%\" colspan=\"6\"><b>".$Empresa['telefono']."</b></td>\n";	  $html .= "		</tr>\n";	        $html .= "		<tr >\n";	  $html .= "			<td width=\"10%\" class=\"formulacion_table_list\">#FACTURA</td>\n";	  $html .= "			<td width=\"20%\">".$_REQUEST['numero_factura']."</td>\n";	  $html .= "			<td width=\"10%\" class=\"formulacion_table_list\">FECHA</td>\n";	  $html .= "			<td width=\"20%\">".$FacturaProveedorCabecera[0]['fecha_registro']."</td>\n";	  $html .= "			<td width=\"10%\" class=\"formulacion_table_list\">USUARIO</td>\n";	  $html .= "			<td width=\"20%\">".$FacturaProveedorCabecera[0]['nombre']."</td>\n";	  $html .= "		</tr>\n";	  $html .= "  </table>\n";	  $html .= "  <br>";	  $html .= "	<table align=\"center\" border=\"0\" width=\"100%\" class=\"modulo_table_list\">\n";        $html .= "		<tr >\n";	  $html .= "			<td width=\"10%\" class=\"formulacion_table_list\">PROVEEDOR </td>\n";	  $html .= "			<td width=\"20%\">".$TerceroProveedor[0]['nombre_tercero']."</td>\n";	  $html .= "			<td width=\"10%\">".$TerceroProveedor[0]['tipo_id_tercero']."-".$TerceroProveedor[0]['tercero_id']."</td>\n";	  $html .= "			<td width=\"10%\" class=\"formulacion_table_list\">DIRECCION</td>\n";	  $html .= "			<td width=\"20%\">".$TerceroProveedor[0]['direccion']."</td>\n";	  $html .= "			<td width=\"10%\" class=\"formulacion_table_list\">Fecha Documento</td>\n";	  $html .= "			<td width=\"20%\">".$FacturaProveedorCabecera[0]['fecha_registro']."</td>\n";	  $html .= "		</tr>\n";	  $html .= "  </table>\n";    $html .= "  <br>";                	 $html .= "                <fieldset class=\"fieldset\" style=\"width:50%\">\n";                   $html .= "                  <legend class=\"normal_10AN\">\n";                   $html .= "                    <img src=\"".GetThemePath()."/images/informacion.png\">OBSERVACIONES\n";                	  $html .= "                  </legend><b>\n";                  	$html .= $FacturaProveedorCabecera[0]['observaciones'];                	  $html .= "                 </b> </fieldset>\n";	  $html .= "<br>";	  $html .= "<hr>";	  $html .= "<center>\n";	  $html .= "  <label class=\"label_error\">CRUCE DE RECEPCIONES POR ORDEN DE COMPRA</label>\n";	  $html .= "</center>\n";	  $html .= "<hr>";	  	  $html .= "	<table align=\"center\" border=\"0\" width=\"100%\" class=\"modulo_table_list\">\n";  	  //print_r($FacturaProveedorDetalle);	  $html .= "		<tr class=\"formulacion_table_list\">\n";	  $html .= "			<td width=\"7%\">Recepcion Parcial</td>\n";	  $html .= "			<td width=\"30%\">Producto</td>\n";	  $html .= "			<td width=\"10%\">Lote</td>\n";	  $html .= "			<td width=\"10%\">Fecha Vencimiento</td>\n";	  $html .= "			<td width=\"5%\">Cantidad</td>\n";	  //$html .= "			<td width=\"5%\">Valor Total</td>\n";	  $html .= "			<td width=\"5%\">%Iva</td>\n";	  $html .= "			<td width=\"7%\">Total</td>\n";	  $html .= "		</tr>\n";	  foreach($FacturaProveedorDetalle as $k=>$valor)	  {	  $html .= "		<tr >\n";	  $html .= "			<td >".$valor['recepcion_parcial_id']."</td>\n";	  $html .= "			<td >".$valor['codigo_producto']." ".$valor['descripcion']." ".$valor['presentacion']."-".$valor['clase']."</td>\n";	  $html .= "			<td >".$valor['lote']."</td>\n";	  $html .= "			<td >".$valor['fecha_vencimiento']."</td>\n";	  $html .= "			<td >".$valor['cantidad']."</td>\n";	 // $html .= "			<td >".number_format($valor['valor'])."</td>\n";	  $html .= "			<td >".$valor['porc_iva']."</td>\n";	      	  $SubTotal = $valor['valor'] * $valor['cantidad'];	  $SubTotalFactura=$SubTotalFactura+$SubTotal;	  $porc_iva = ($valor['porc_iva']/100)+1;	  $SubTotalSinIva = $SubTotalSinIva+($SubTotal/$porc_iva);    $IvaTotal = $IvaTotal + ($SubTotal-($SubTotal/$porc_iva));	  	  	  $html .= "			<td >".number_format($SubTotalSinIva)."</td>\n";	  $html .= "		</tr>\n";	  }	  $html .= "  </table>\n";	  $html .= "	<hr>";	  $html .= "	<table align=\"rigth\" border=\"0\" width=\"100%\" class=\"modulo_table_list\">\n";  	  $Total = $SubTotalFactura+$IvaTotal;	  $ValorRTE= $SubTotalSinIva*($FacturaProveedorCabecera[0]['porc_rtf']/100);    $ValorICA= $SubTotalSinIva*($FacturaProveedorCabecera[0]['porc_ica']/1000);	      $html .= "		<tr >\n";	  $html .= "			<td width=\"10%\"><b>Impuesto :</b>".number_format($IvaTotal)."</td>\n";	  $html .= "		</tr >\n";	  $html .= "		<tr >\n";	  $html .= "			<td width=\"30%\"><b>SubTotal :</b>".number_format($SubTotalFactura)."</td>\n";	  $html .= "		</tr >\n";	  $html .= "		<tr >\n";    $html .= "		<tr >\n";	  $html .= "			<td width=\"30%\"><b>Flete :</b>".number_format($FacturaProveedorCabecera[0]['valor_flete'])."</td>\n";	  $html .= "		</tr >\n";	  $html .= "		<tr >\n";	  $html .= "			<td width=\"10%\"><b>Descuento :</b>".number_format($FacturaProveedorCabecera[0]['valor_descuento'])."</td>\n";	  $html .= "		</tr >\n";	  $html .= "		<tr >\n";	  $html .= "			<td width=\"5%\"><b>Rete. Fuente :</b>".number_format($ValorRTE)."</td>\n";	  $html .= "		</tr >\n";    $html .= "		<tr >\n";	  $html .= "			<td width=\"5%\"><b>ICA :</b>".number_format($ValorICA)."</td>\n";	  $html .= "		</tr >\n";	  $html .= "		<tr >\n";	  $html .= "			<td width=\"5%\"><b>Valor Total :".number_format((($SubTotalFactura-$FacturaProveedorCabecera[0]['valor_descuento'])-$ValorRTE)-$ValorICA)."</b></td>\n";	  $html .= "		</tr>\n";	  //print_r($FacturaProveedorCabecera);	  $html .= "  </table>\n";	  	  	  $html .= "	<table width=\"90%\" align=\"center\">\n";	  $html .= "		<tr><td align=\"center\">\n";	  $html .= "			<form name=\"volver\" action=\"".$action['volver']."\" method=\"post\">\n";	  $html .= "				<input type=\"submit\" class=\"input-submit\" value=\"Volver\">\n";	  $html .= "			</form>\n";	  $html .= "		</td></tr>\n";	  $html .= "	</table>\n";      $html .= ThemeCerrarTabla();	  $html .= $this->CrearVentana(900,"RECEPCIONES PARCIALES");      return $html;	}    			}?>