<?php  /**  * @package IPSOFT-SIIS  * @version $Id: BuscadorDiagnosticosSQL.class.php,v 1.1 2008/12/12 22:22:55 hugo Exp $  * @copyright (C) 2005 IPSOFT - SA (www.ipsoft-sa.com)  * @author Hugo F  Manrique  */  /**  * Clase: BuscadorDiagnosticosSQL  * Clase encargada del manejo de base de datos para hacer las consultas y las  * actualizaciones que sean necesarias  *  * @package IPSOFT-SIIS  * @version $Revision: 1.1 $  * @copyright (C) 2005 IPSOFT - SA (www.ipsoft-sa.com)  * @author Hugo F  Manrique  */  IncludeClass("ConexionBD");  class BuscadorDiagnosticosSQL extends ConexionBD  {    /**    * Constructor de la clase    */    function BuscadorDiagnosticosSQL(){}    /**    * Funcion donde se obtienen los diagnosticos    *    * @param array $buscador Arreglo de datos con los filtros de la busqueda    * @param int $off Offset de la busqueda    *    * @return mixed    */    function ObtenerDiagnosticos($buscador, $off)    {          $sql .= "SELECT diagnostico_id, ";       $sql .= "       diagnostico_nombre ";       $sql .= "FROM   diagnosticos ";      $sql .= "WHERE TRUE ";            if($buscador['codigo'])        $sql .= "AND    diagnostico_id = '".$buscador['codigo']."' ";              if($buscador['descripcion'])        $sql .= "AND    diagnostico_nombre ILIKE '%".$buscador['descripcion']."%' ";                              $sqlCont = "SELECT COUNT(*) FROM(".$sql.") AS A ";              $this->ProcesarSqlConteo($sqlCont, $off,null);              $sql .= "LIMIT ".$this->limit." OFFSET ".$this->offset." ";              if(!$rst = $this->ConexionBaseDatos($sql)) return false;              $datos = array();      while(!$rst->EOF)      {        $datos[] = $rst->GetRowAssoc($ToUpper = false);        $rst->MoveNext();      }      $rst->Close();              return $datos;     }  }?>